//  ========================================================================
/**
 * @copyright Copyright (C) 1999 Technical Pursuit Inc. (TPI) All Rights
 *     Reserved. Patents Pending, Technical Pursuit Inc. Licensed under the
 *     OSI-approved Reciprocal Public License (RPL) Version 1.5. See the RPL
 *     for your rights and responsibilities. Contact TPI to purchase optional
 *     privacy waivers if you must keep your TIBET-based source code private.
 */

;(function(a){if(a.TP!=null||a.APP!=null){if(!a.TP.boot||!a.TP.sys){top.console.error('TIBET TP variable already mapped. Exiting.');return;}if(!a.APP||!a.APP){top.console.error('TIBET APP variable already mapped. Exiting.');return;}}a.$$tibet=a;if(Object.defineProperty){Object.defineProperty(a,'TP',{value:{},writable:false});TP=a.TP;Object.defineProperty(TP,'boot',{value:{},writable:false});Object.defineProperty(TP,'sys',{value:{},writable:false});Object.defineProperty(a,'APP',{value:{},writable:false});APP=a.APP;}else{TP=a.TP||{};TP.sys=TP.sys||{};TP.boot=TP.boot||{};APP=a.APP||{};}TP.global=Function('return this')()||(42,eval)('this');if(!TP.sys.$nativeglobals){(function(){var a,b;a=function(b){return b?Object.getOwnPropertyNames(b).concat(a(Object.getPrototypeOf(b))):[];};b=function(a){return a.filter(function(b,c){return a.lastIndexOf(b)===c;});};TP.sys.$nativeglobals=b(a(TP.global).sort());}());}if(TP.sys.$globals==null){TP.sys.$globals=[];}TP.$$isNamespace=true;TP.$$name='TP';TP.getTypeNames=function(){return[];};TP.sys.$$isNamespace=true;TP.sys.$$name='TP.sys';TP.sys.getTypeNames=function(){return[];};TP.boot.$$isNamespace=true;TP.boot.$$name='TP.boot';TP.boot.getTypeNames=function(){return[];};APP.$$isNamespace=true;APP.$$name='APP';APP.getTypeNames=function(){return[];};TP.$DEBUG=false;TP.$VERBOSE=false;TP.$$DEBUG=false;TP.$$VERBOSE=false;TP.boot.$debug=true;TP.boot.$verbose=true;TP.boot.$$debug=true;TP.boot.$$verbose=true;TP.boot.$$logbufsize=null;TP.boot.$$loglevel=1;TP.boot.$$logpeak=0;TP.boot.$$logcss=null;TP.NOOP=function(){};TP.ANY='ANY';TP.FAILURE=-1;TP.NOT_FOUND=-1;TP.BAD_INDEX=-1;TP.NO_SIZE=-1;TP.NO_RESULT=Number.NEGATIVE_INFINITY;TP.TRACE=0;TP.INFO=1;TP.WARN=2;TP.ERROR=3;TP.SEVERE=4;TP.FATAL=5;TP.SYSTEM=6;TP.BOOT_LOG='Boot';TP.LOG_ENTRY_DATE=0;TP.LOG_ENTRY_NAME=1;TP.LOG_ENTRY_LEVEL=2;TP.LOG_ENTRY_PAYLOAD=3;TP.LOG_ENTRY_CONTEXT=4;TP.LOG_ENTRY_DELTA=5;TP.LOG_ENTRY_STACK_NAMES=4;TP.LOG_ENTRY_STACK_ARGS=5;TP.DOM=1;TP.TEXT=2;TP.XHR=3;TP.WRAP=4;TP.BEST=5;TP.UP='UP';TP.DOWN='DOWN';TP.MOZ_READ=1;TP.MOZ_WRITE=8;TP.MOZ_APPEND=16;TP.MOZ_FILE_RDONLY=1;TP.MOZ_FILE_WRONLY=2;TP.MOZ_FILE_RDWR=4;TP.MOZ_FILE_CREATE=8;TP.MOZ_FILE_APPEND=16;TP.MOZ_FILE_TRUNCATE=32;TP.MOZ_FILE_SYNC=64;TP.MOZ_FILE_EXCL=128;TP.HTTP_DELETE='DELETE';TP.HTTP_GET='GET';TP.HTTP_HEAD='HEAD';TP.HTTP_OPTIONS='OPTIONS';TP.HTTP_POST='POST';TP.HTTP_PUT='PUT';TP.HTTP_TRACE='TRACE';TP.boot.BOOLEAN_REGEX=/^true$|^false$/;TP.boot.NUMBER_REGEX=/^\d*$/;TP.boot.OBJECT_REGEX=/^\{.*\}$/;TP.boot.REGEX_REGEX=/^\/.*\/$/;TP.boot.$$PROP_KEY_REGEX=/\./;TP.boot.$$KV_REGEX=/=/;TP.boot.$$USER_AGENT_REGEX=/^firefox|^safari|^chrome|^ie|^gecko|^webkit|^trident/;TP.FILE_PATH_REGEX=/\.([^\/]*)$/;TP.HAS_PATH_OFFSET_REGEX=/\/\.\./;TP.REMOVE_PATH_OFFSET_REGEX=/(^|\/)[^\/]*\/\.\./;TP.HAS_PATH_NOOP_REGEX=/\/\./;TP.REMOVE_PATH_NOOP_REGEX=/\/\./;TP.HAS_MARKUP_REGEX=/<\//;TP.BAD_WINDOW_ID_REGEX=/[:\/]/;TP.WINDOW_PREFIX_REGEX=/^window_[0-9]/;TP.SCREEN_PREFIX_REGEX=/^screen_[0-9]/;TP.TIBET_URI_SPLITTER=/tibet:([^\/]*?)\/([^\/]*?)\/([^\/]*)(\/([^#]*)(.*))*/;TP.TIBET_VERSION_SPLITTER=/(\d*)\.(\d*)\.(\d*)/;TP.boot.$bootversion='20140203';TP.boot.$$approot=null;TP.boot.$$libroot=null;TP.boot.$$uriroot=null;TP.boot.$$uiHead;TP.boot.$$uiImage;TP.boot.$$uiInput;TP.boot.$$uiLog;TP.boot.$$uiPath;TP.boot.$$uiProgress;TP.$$uaInfo={};TP.boot.$$head=document.getElementsByTagName('head')[0];TP.boot.$$msgBuffer=null;TP.boot.$$msgTemplate=null;TP.boot.$$scriptTemplate=document.createElement('script');TP.boot.$$scriptTemplate.setAttribute('type','text/javascript');TP.boot.$$basedir=[];TP.boot.$$bootdir=null;TP.boot.$$bootfile=null;TP.boot.$$packagecfg=[];TP.boot.$$packagexml=[];TP.boot.$$rootpath=null;TP.boot.$$package=null;TP.boot.$$script=null;TP.boot.$$version=null;TP.boot.$$percent=null;TP.boot.$$totalwork=0;TP.boot.$$workload=null;TP.boot.$$fullPaths={};TP.boot.$$packages={};TP.boot.$$scripts={};TP.boot.$$bootindex=null;TP.boot.$$bootnodes=null;TP.boot.$$bootconfig=null;TP.boot.$$bootxml=null;TP.boot.$$importAsync=function(){TP.boot.$importComponents(false);};TP.boot.$loadNode=null;TP.boot.$loadPath=null;TP.boot.$$loadpaths=[];TP.boot.$$propertyQueries={};TP.boot.$$styles={};TP.boot.$$styles.browser={'bold':['<b>','</b>'],'italic':['<i>','</i>'],'underline':['<u>','</u>'],'inverse':['<span style="background-color:black;color:white;">','</span>'],'strikethrough':['<del>','</del>'],'white':['<span style="color:white;">','</span>'],'grey':['<span style="color:#aaa;">','</span>'],'black':['<span style="color:black;">','</span>'],'blue':['<span style="color:blue;">','</span>'],'cyan':['<span style="color:cyan;">','</span>'],'green':['<span style="color:green;">','</span>'],'magenta':['<span style="color:magenta;">','</span>'],'red':['<span style="color:red;">','</span>'],'yellow':['<span style="color:yellow;">','</span>'],'whiteBG':['<span style="background-color:white;">','</span>'],'greyBG':['<span style="background-color:#aaa;">','</span>'],'blackBG':['<span style="background-color:black;">','</span>'],'blueBG':['<span style="background-color:blue;">','</span>'],'cyanBG':['<span style="background-color:cyan;">','</span>'],'greenBG':['<span style="background-color:green;">','</span>'],'magentaBG':['<span style="background-color:magenta;">','</span>'],'redBG':['<span style="background-color:red;">','</span>'],'yellowBG':['<span style="background-color:yellow;">','</span>']};TP.boot.$$styles.console=function(){var a,b;b={};for(a in TP.boot.$$styles.browser){if(TP.boot.$$styles.browser.hasOwnProperty(a)){b[a]=['',''];}}return b;}();TP.boot.$$styles.terminal={'bold':['\x1B[1m','\x1B[22m'],'italic':['\x1B[3m','\x1B[23m'],'underline':['\x1B[4m','\x1B[24m'],'inverse':['\x1B[7m','\x1B[27m'],'strikethrough':['\x1B[9m','\x1B[29m'],'white':['\x1B[37m','\x1B[39m'],'grey':['\x1B[90m','\x1B[39m'],'black':['\x1B[30m','\x1B[39m'],'blue':['\x1B[34m','\x1B[39m'],'cyan':['\x1B[36m','\x1B[39m'],'green':['\x1B[32m','\x1B[39m'],'magenta':['\x1B[35m','\x1B[39m'],'red':['\x1B[31m','\x1B[39m'],'yellow':['\x1B[33m','\x1B[39m'],'whiteBG':['\x1B[47m','\x1B[49m'],'greyBG':['\x1B[49;5;8m','\x1B[49m'],'blackBG':['\x1B[40m','\x1B[49m'],'blueBG':['\x1B[44m','\x1B[49m'],'cyanBG':['\x1B[46m','\x1B[49m'],'greenBG':['\x1B[42m','\x1B[49m'],'magentaBG':['\x1B[45m','\x1B[49m'],'redBG':['\x1B[41m','\x1B[49m'],'yellowBG':['\x1B[43m','\x1B[49m']};TP.boot.$$argsDone=false;TP.boot.$$errors=0;TP.boot.$$bottlenecks=0;TP.boot.$$warnings=0;TP.boot.$$stop=null;TP.boot.$$stage=null;TP.boot.$$stages={prelaunch:{order:0,log:'Prelaunch',head:'Pre-Launch',sub:'Verifying environment...',image:'~lib_img/boot/tpi_logo.png'},configuring:{order:1,log:'Configure',head:'Configure',sub:'Reading configuration...',image:'~lib_img/boot/tpi_logo.png'},expanding:{order:2,log:'Expanding',head:'Expanding',sub:'Processing boot manifest...',image:'~lib_img/boot/tpi_logo.png'},importing:{order:3,log:'Importing',head:'Importing',sub:'Importing manifest assets...',image:'~lib_img/boot/tpi_logo.png'},import_phase_one:{order:4,log:'Import Phase One',head:'Import Phase One',sub:'Importing phase-one (static/library) components...',image:'~lib_img/boot/tibet_logo.png'},import_paused:{order:5,log:'Import Pause',head:'Import Paused',sub:'Waiting to start phase-two import...',image:'~lib_img/boot/playpause.png'},import_phase_two:{order:6,log:'Import Phase Two',head:'Import Phase Two',sub:'Importing phase-two (dynamic/application) components...',image:'~lib_img/boot/tpi_logo.png'},import_complete:{order:7,log:'Import Complete',head:'Import Complete',sub:'Components loaded.',image:'~lib_img/boot/tpi_logo.png'},paused:{order:8,log:'Paused',head:'Paused',sub:'Proceed when ready.',image:'~lib_img/boot/playpause.png'},activating:{order:9,log:'Activating',head:'Activating',sub:'Activating application...',image:'~lib_img/boot/tpi_logo.png',fatal:true},initializing:{order:10,log:'Initialization',head:'Initializing',sub:'Initializing loaded components...',image:'~lib_img/boot/tpi_logo.png',fatal:true},rendering:{order:11,log:'Rendering',head:'Rendering',sub:'Rendering application UI...',image:'~lib_img/boot/tpi_logo.png',fatal:true},liftoff:{order:12,log:'Started',head:'Started',sub:'Application running.',image:'~lib_img/boot/tpi_logo.png',hook:function(){TP.boot.$displayStatus('Application running: '+(TP.boot.$getStageTime('started','prelaunch')-TP.boot.$getStageTime('paused'))+'ms.');if(!TP.sys.cfg('boot.tdc')){TP.boot.hideUIBoot();}}},stopped:{order:13,log:'Stopped',head:'Stopped',sub:'Boot halted.',image:'~lib_img/boot/alert.png',hook:function(){TP.boot.$displayStatus('Boot halted after: '+(TP.boot.$getStageTime('started','prelaunch')-TP.boot.$getStageTime('paused'))+'ms.');}}};TP.boot.$$stageorder=[];(function(){var a;for(a in TP.boot.$$stages){if(TP.boot.$$stages.hasOwnProperty(a)){TP.boot.$$stageorder.push(a);}}TP.boot.$$stageorder=TP.boot.$$stageorder.sort(function(a,b){if(TP.boot.$$stages[a].order<TP.boot.$$stages[b].order){return-1;}else{return 1;}});}());TP.SCHEMES=['http','file','tibet','https','chrome-extension'];TP.boot.$uriSchemes={'tibet':'tibet','urn':'urn','http':'http','https':'https','file':'file','xmpp':'xmpp','about':'about','mailto':'mailto','tel':'tel','news':'news','nntp':'nntp','ftp':'ftp','ws':'ws','wss':'wss','aaa':'aaa','aaas':'aaas','acap':'acap','cap':'cap','cid':'cid','crid':'crid','data':'data','dav':'dav','dict':'dict','dns':'dns','fax':'fax','go':'go','gopher':'gopher','h323':'h323','icap':'icap','im':'im','imap':'imap','info':'info','ipp':'ipp','iris':'iris','iris.beep':'iris.beep','iris.xpc':'iris.xpc','iris.xpcs':'iris.xpcs','iris.lws':'iris.lws','ldap':'ldap','lsid':'lsid','mid':'mid','modem':'modem','msrp':'msrp','msrps':'msrps','mtqp':'mtqp','mupdate':'mupdate','nfs':'nfs','opaquelocktoken':'opaquelocktoken','pop':'pop','pres':'pres','prospero':'prospero','rtsp':'rtsp','service':'service','shttp':'shttp','sip':'sip','sips':'sips','snmp':'snmp','soap.beep':'soap.beep','soap.beeps':'soap.beeps','tag':'tag','telnet':'telnet','tftp':'tftp','thismessage':'thismessage','tip':'tip','tv':'tv','vemmi':'vemmi','wais':'wais','xmlrpc.beep':'xmlrpc.beep','z39.50r':'z39.50r','z39.50s':'z39.50s'};TP.boot.$isArgumentArray=function(a){return a!==null&&a!==undefined&&Object.prototype.toString.call(a)==='[object Arguments]';};TP.boot.$isElement=function(a){return TP.boot.$isValid(a)&&a.nodeType===1;};TP.boot.$isEmpty=function(a){return a===null||a===undefined||a.length===0;};TP.boot.$isNumber=function(a){return typeof a==='number'&&!isNaN(a);};TP.boot.$isValid=function(a){return a!==null&&a!==undefined;};TP.boot.$notEmpty=function(a){return a!==null&&a!==undefined&&a.length!==undefined&&a.length!==0;};TP.boot.$notValid=function(a){return a===null||a===undefined;};TP.sys.defineGlobal=function(a,c,d){var b;if(TP.boot.$notValid(a)||a===''){return;}TP.sys.$globals.push(a);b=typeof TP.global[a]==='undefined';if(b===true){if(Object.defineProperty){Object.defineProperty(TP.global,a,TP.PROPERTY_DEFAULTS);}}if(b===true||d===true){TP.global[a]=c;}return TP.global[a];};TP.sys.initialized=false;TP.sys.hasInitialized=function(a){if(a!==undefined){this.initialized=a;}return this.initialized;};TP.sys.kernel=false;TP.sys.hasKernel=function(a){if(a!==undefined){this.kernel=a;}return this.kernel;};TP.sys.loaded=false;TP.sys.hasLoaded=function(a){if(a!==undefined){this.loaded=a;}return this.loaded;};TP.sys.started=false;TP.sys.hasStarted=function(a){if(a!==undefined){this.started=a;}return this.started;};TP.boot.shouldStop=function(a){if(TP.boot.$notEmpty(a)){TP.boot.$$stop=a;}return TP.boot.$isValid(TP.boot.$$stop);};TP.boot.$$getprop=function(b,k,e,f){var l,j,g,c,h,i,a,d;if(b==null){return e;}if(!k){if(!f){if(e!==undefined){return e;}return b;}else{c=[];if(typeof b.getKeys==='function'){h=b.getKeys();i=h.length;for(a=0;a<i;a++){if(h[a].indexOf(f+'.')===0){c.push(h[a]);}}}else{for(a in b){if(b.hasOwnProperty(a)){if(a.indexOf(f+'.')===0){c.push(a);}}}}if(c.length>0){d={};d.at=function(a){return this[a];};d.atPut=function(a,b){this[a]=b;};i=c.length;for(a=0;a<i;a++){d.atPut(c[a],b.at(c[a]));}return d;}else{return e;}}}else if(TP.boot.$$PROP_KEY_REGEX.test(k)===false){l=f||'tmp';g=l+'.'+g;}else{g=k;}j=b.at(g);if(j===undefined){return e;}return j;};TP.boot.$$setprop=function(d,a,e,f,h,i){var b,g,c;if(d==null||a==null){return;}if(TP.boot.$$PROP_KEY_REGEX.test(a)===false){b=f?f+'.'+a:'tmp.'+a;}else{b=a;}if(TP.sys.overrides.hasOwnProperty(b)){if(i!==true){return;}else if(TP.boot.$argsDone===true){TP.boot.$stdout('Forcing reset of \''+b+'\' override to '+e,TP.TRACE);}}g=d.at(b);if(e==='false'){c=false;}else if(e==='true'){c=true;}else{c=e;}if(g!==c){d.atPut(b,c);if(h!==false&&TP.sys.hasStarted()&&typeof window.$signal==='function'){window.$signal(TP.sys,a+'Change',arguments,a);}}return d.at(b);};TP.sys.configuration={};if(Object.defineProperty){Object.defineProperty(TP.sys.configuration,'at',{value:function(a){return this[a];},enumerable:false});Object.defineProperty(TP.sys.configuration,'atPut',{value:function(a,b){this[a]=b;},enumerable:false});}else{TP.sys.configuration.at=function(a){return this[a];};TP.sys.configuration.atPut=function(a,b){this[a]=b;};}TP.sys.overrides={};TP.sys.getcfg=function(a,c){var b;if(!a){return TP.sys.configuration;}if(a.indexOf('.')===-1){b=TP.boot.$$getprop(TP.sys.configuration,null,c,a);}else{b=TP.boot.$$getprop(TP.sys.configuration,a,c);}if(b===undefined){return c;}return b;};TP.sys.cfg=TP.sys.getcfg;TP.sys.setcfg=function(a,b,c,d){return TP.boot.$$setprop(TP.sys.configuration,a,b,'cfg',c,d);};TP.sys.environment={};if(Object.defineProperty){Object.defineProperty(TP.sys.environment,'at',{value:function(a){return this[a];},enumerable:false});Object.defineProperty(TP.sys.environment,'atPut',{value:function(a,b){this[a]=b;},enumerable:false});}else{TP.sys.environment.at=function(a){return this[a];};TP.sys.environment.atPut=function(a,b){this[a]=b;};}TP.boot.$getenv=function(a,b){if(!a){return TP.sys.environment;}return TP.boot.$$getprop(TP.sys.environment,a,b);};TP.sys.env=TP.boot.$getenv;TP.boot.$$setenv=function(a,b){return TP.boot.$$setprop(TP.sys.environment,a,b,'env');};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=TP;}exports.TP=TP;exports.APP=APP;}else{a.TP=TP;a.APP=APP;}}(this));
TP.sys.setcfg('debug.cache',false);TP.sys.setcfg('debug.css',false);TP.sys.setcfg('debug.http',false);TP.sys.setcfg('debug.node',false);TP.sys.setcfg('debug.path',true);TP.sys.setcfg('tibet.debug',true);TP.sys.setcfg('tibet.verbose',true);TP.sys.setcfg('project.ident',null);TP.sys.setcfg('project.name',null);TP.sys.setcfg('project.version',null);TP.sys.setcfg('project.rootpage',null);TP.sys.setcfg('boot.phaseone',true);TP.sys.setcfg('boot.phasetwo',false);TP.sys.setcfg('boot.uselogin',false);TP.sys.setcfg('boot.parallel',true);TP.sys.setcfg('boot.nobootstrap',false);TP.sys.setcfg('boot.nourlargs',false);TP.sys.setcfg('boot.defer',true);TP.sys.setcfg('boot.delta_threshold',50);TP.sys.setcfg('boot.error_max',20);TP.sys.setcfg('boot.fatalistic',false);TP.sys.setcfg('boot.pause',false);TP.sys.setcfg('boot.pause_on_error',false);TP.sys.setcfg('boot.stop_onerror',false);TP.sys.setcfg('boot.tdc',false);TP.sys.setcfg('boot.twophase',true);TP.sys.setcfg('log.buffersize',5);TP.sys.setcfg('log.level',TP.WARN);TP.sys.setcfg('log.reporter','bootui');TP.sys.setcfg('boot.libcomp','script');TP.sys.setcfg('boot.tibetdir','node_modules');TP.sys.setcfg('boot.tibetinf','TIBET-INF');TP.sys.setcfg('boot.tibetlib','tibet');TP.sys.setcfg('boot.tibetinit','tibet_init');TP.sys.setcfg('boot.initoffset','../../..');TP.sys.setcfg('boot.bootstrap','tibet.json');TP.sys.setcfg('boot.profile',null);TP.sys.setcfg('boot.package',null);TP.sys.setcfg('boot.config',null);TP.sys.setcfg('boot.assets',null);TP.sys.setcfg('boot.unminified',false);TP.sys.setcfg('tibet.uiroot','UIROOT');TP.sys.setcfg('tibet.uicanvas','UIROOT');TP.sys.setcfg('tibet.uiscreens','UISCREENS');TP.sys.setcfg('tibet.uiscreenprefix','SCREEN_');TP.sys.setcfg('boot.uiboot','UIBOOT');TP.sys.setcfg('boot.uiimage','BOOT-IMAGE');TP.sys.setcfg('boot.uihead','BOOT-HEAD');TP.sys.setcfg('boot.uisubhead','BOOT-SUBHEAD');TP.sys.setcfg('boot.uiconsole','BOOT-CONSOLE');TP.sys.setcfg('boot.uilog','BOOT-LOG');TP.sys.setcfg('boot.uiprogress','BOOT-PROGRESS');TP.sys.setcfg('boot.uipercent','BOOT-PERCENT');TP.sys.setcfg('boot.uicommand','BOOT-COMMAND');TP.sys.setcfg('boot.uiinput','BOOT-INPUT');TP.sys.setcfg('boot.uisection','================================================================================');TP.sys.setcfg('boot.uisubsection','--------------------------------------------------------------------------------');TP.sys.setcfg('boot.uichunked','~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~');TP.sys.setcfg('log.tracecolor','grey');TP.sys.setcfg('log.infocolor','white');TP.sys.setcfg('log.warncolor','yellow');TP.sys.setcfg('log.errorcolor','magenta');TP.sys.setcfg('log.severecolor','red');TP.sys.setcfg('log.fatalcolor','red');TP.sys.setcfg('log.systemcolor','cyan');TP.sys.setcfg('log.timecolor','grey');TP.sys.setcfg('log.deltacolor','grey');TP.sys.setcfg('log.slowcolor','yellow');TP.sys.setcfg('log.debugcolor','green');TP.sys.setcfg('log.verbosecolor','grey');if(typeof navigator==='undefined'){TP.sys.setcfg('boot.context','nodejs');TP.sys.setcfg('log.colormode','terminal');}else if(/PhantomJS/.test(navigator.userAgent)){TP.sys.setcfg('boot.context','phantomjs');TP.sys.setcfg('log.colormode','terminal');}else{TP.sys.setcfg('boot.context','browser');TP.sys.setcfg('log.colormode','console');}TP.sys.setcfg('tibet.blankpage','~lib_xhtml/tp_blank.xhtml');TP.sys.setcfg('tibet.iframepage','~lib_xhtml/tp_launch_stub.xhtml');if(typeof window!=='undefined'){if(!window.name){window.name='window_0';}TP.sys.setcfg('tibet.uibuffer',window.name);}else{TP.sys.setcfg('tibet.uibuffer',null);}TP.sys.setcfg('tibet.jsonp_frame','JSONP');TP.sys.setcfg('boot.cachemode','versioned');TP.sys.setcfg('boot.localcache',true);TP.sys.setcfg('tibet.offline',false);TP.sys.setcfg('tibet.simple_cors_only',false);TP.sys.setcfg('import.chunks',false);TP.sys.setcfg('import.manifests',false);TP.sys.setcfg('import.packages',false);TP.sys.setcfg('import.source','local');TP.sys.setcfg('import.usingdom',true);TP.sys.setcfg('import.check_404','false');TP.sys.setcfg('import.metadata',false);TP.sys.setcfg('pack.extension','_c');TP.sys.setcfg('tibet.hostlang','http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd');TP.sys.setcfg('tibet.keyboard',null);TP.sys.setcfg('tibet.locale',null);TP.sys.setcfg('path.lib_version_file','http://0.0.0.0:1234/latest.js');TP.sys.setcfg('boot.moz_xpcom',false);TP.sys.setcfg('path.app','~app_root');TP.sys.setcfg('path.lib','~lib_root');TP.sys.setcfg('path.tibet','~lib_root');TP.sys.setcfg('path.app_inf','~app/'+TP.sys.cfg('boot.tibetinf'));TP.sys.setcfg('path.lib_inf','~lib/'+TP.sys.cfg('boot.tibetinf'));TP.sys.setcfg('path.app_bin','~app/bin');TP.sys.setcfg('path.lib_bin','~lib/bin');TP.sys.setcfg('path.app_build','~app/build');TP.sys.setcfg('path.lib_build','~lib_lib/src');TP.sys.setcfg('path.app_cfg','~app_inf/cfg');TP.sys.setcfg('path.lib_cfg','~lib_lib/cfg');TP.sys.setcfg('path.app_cmd','~app_inf/cmd');TP.sys.setcfg('path.lib_cmd','~lib_lib/cmd');TP.sys.setcfg('path.app_css','~app/css');TP.sys.setcfg('path.lib_css','~lib_lib/css');TP.sys.setcfg('path.app_dat','~app_inf/dat');TP.sys.setcfg('path.lib_dat','~lib_lib/dat');TP.sys.setcfg('path.app_deps','~app/deps');TP.sys.setcfg('path.lib_deps','~lib/deps');TP.sys.setcfg('path.app_html','~app/html');TP.sys.setcfg('path.lib_html','~lib_lib/html');TP.sys.setcfg('path.app_xhtml','~app/xhtml');TP.sys.setcfg('path.lib_xhtml','~lib_lib/xhtml');TP.sys.setcfg('path.app_img','~app/img');TP.sys.setcfg('path.lib_img','~lib_lib/img');TP.sys.setcfg('path.app_lib','~app/lib');TP.sys.setcfg('path.lib_lib','~lib/lib');TP.sys.setcfg('path.app_npm','~app/node_modules');TP.sys.setcfg('path.lib_npm','~lib/node_modules');TP.sys.setcfg('path.app_src','~app/src');TP.sys.setcfg('path.lib_src','~lib/src');TP.sys.setcfg('path.app_tsh','~app_inf/tsh');TP.sys.setcfg('path.lib_tsh','~lib_lib/tsh');TP.sys.setcfg('path.app_tst','~app/test');TP.sys.setcfg('path.lib_tst','~lib/test');TP.sys.setcfg('path.app_xml','~app_inf/xml');TP.sys.setcfg('path.lib_xml','~lib_lib/xml');TP.sys.setcfg('path.app_xsl','~app_inf/xsl');TP.sys.setcfg('path.lib_xsl','~lib_lib/xsl');TP.sys.setcfg('path.app_xs','~app_inf/xs');TP.sys.setcfg('path.lib_xs','~lib_lib/xs');TP.sys.setcfg('path.app_boot','~lib/src/tibet/boot');TP.sys.setcfg('path.app_cache','~app_tmp/cache');TP.sys.setcfg('path.app_change','~app_src/changes');TP.sys.setcfg('path.app_log','~app_inf/log');TP.sys.setcfg('path.app_tmp','~app_inf/tmp');TP.sys.setcfg('path.app_xmlbase','~app_html');TP.sys.setcfg('path.tibet_src','~lib_src/tibet');TP.sys.setcfg('path.tdc_root','~lib_src/tibet/tools/tdc');TP.sys.setcfg('path.tdc_src','~tdc_root/src');TP.sys.setcfg('path.ide_root','~lib_src/tibet/tools/sherpa');TP.sys.setcfg('path.ide_src','~ide_root/src');TP.sys.setcfg('path.npm_dir','node_modules');TP.sys.setcfg('path.npm_file','package.json');TP.sys.setcfg('api.lint_keys',false);TP.sys.setcfg('break.change',false);TP.sys.setcfg('break.dnu',false);TP.sys.setcfg('break.format',false);TP.sys.setcfg('break.formatter',false);TP.sys.setcfg('break.gobi',false);TP.sys.setcfg('break.infer',false);TP.sys.setcfg('break.invoke',false);TP.sys.setcfg('break.main',false);TP.sys.setcfg('break.metadata',false);TP.sys.setcfg('break.query',false);TP.sys.setcfg('break.stdout',false);TP.sys.setcfg('break.rendering',false);TP.sys.setcfg('break.require',false);TP.sys.setcfg('break.unbound',false);TP.sys.setcfg('break.validate',false);TP.sys.setcfg('break.xpath',false);TP.sys.setcfg('break.awaken_content',false);TP.sys.setcfg('break.awaken_dom',false);TP.sys.setcfg('break.awaken_binds',false);TP.sys.setcfg('break.awaken_info',false);TP.sys.setcfg('break.awaken_events',false);TP.sys.setcfg('break.awaken_style',false);TP.sys.setcfg('break.bind_base',false);TP.sys.setcfg('break.bind_change',false);TP.sys.setcfg('break.bind_stdin',false);TP.sys.setcfg('break.bind_refresh',false);TP.sys.setcfg('break.bind_stderr',false);TP.sys.setcfg('break.bind_stdout',false);TP.sys.setcfg('break.content_cache',false);TP.sys.setcfg('break.content_finalize',false);TP.sys.setcfg('break.content_process',false);TP.sys.setcfg('break.content_substitute',false);TP.sys.setcfg('break.content_templating',false);TP.sys.setcfg('break.content_transform',false);TP.sys.setcfg('break.html_content',false);TP.sys.setcfg('break.css_processing',false);TP.sys.setcfg('break.device_observe',false);TP.sys.setcfg('break.device_invoke',false);TP.sys.setcfg('break.device_redirect',false);TP.sys.setcfg('break.device_signal',false);TP.sys.setcfg('break.document_loaded',false);TP.sys.setcfg('break.document_unloaded',false);TP.sys.setcfg('break.duplicate_attribute',false);TP.sys.setcfg('break.duplicate_constant',false);TP.sys.setcfg('break.http_timeout',false);TP.sys.setcfg('break.http_wrapup',false);TP.sys.setcfg('break.websocket_timeout',false);TP.sys.setcfg('break.websocket_wrapup',false);TP.sys.setcfg('break.locale_localize',false);TP.sys.setcfg('break.locale_parse',false);TP.sys.setcfg('break.node_construct',false);TP.sys.setcfg('break.node_detachment',false);TP.sys.setcfg('break.node_discarded',false);TP.sys.setcfg('break.node_bypath',false);TP.sys.setcfg('break.node_xslt',false);TP.sys.setcfg('break.query_css',false);TP.sys.setcfg('break.request_wrapup',false);TP.sys.setcfg('break.response_content',false);TP.sys.setcfg('break.signal',false);TP.sys.setcfg('break.signal_arm',false);TP.sys.setcfg('break.signal_dispatch',false);TP.sys.setcfg('break.signal_exception',false);TP.sys.setcfg('break.signal_handler',false);TP.sys.setcfg('break.signal_register',false);TP.sys.setcfg('break.signal_notify',false);TP.sys.setcfg('break.signal_domfiring',false);TP.sys.setcfg('break.tdc_stdin',false);TP.sys.setcfg('break.tdc_stderr',false);TP.sys.setcfg('break.tdc_stdout',false);TP.sys.setcfg('break.shell_execute',false);TP.sys.setcfg('break.tsh_action',false);TP.sys.setcfg('break.tsh_adder',false);TP.sys.setcfg('break.tsh_alias',false);TP.sys.setcfg('break.tsh_cmd',false);TP.sys.setcfg('break.tsh_compile',false);TP.sys.setcfg('break.tsh_desugar',false);TP.sys.setcfg('break.tsh_execute',false);TP.sys.setcfg('break.tsh_filter',false);TP.sys.setcfg('break.tsh_format',false);TP.sys.setcfg('break.tsh_getter',false);TP.sys.setcfg('break.tsh_history',false);TP.sys.setcfg('break.tsh_interpolate',false);TP.sys.setcfg('break.tsh_pp',false);TP.sys.setcfg('break.tsh_setter',false);TP.sys.setcfg('break.tsh_substitutions',false);TP.sys.setcfg('break.tsh_transform',false);TP.sys.setcfg('break.tsh_uri',false);TP.sys.setcfg('break.tsh_xmlify',false);TP.sys.setcfg('break.tsh_phase_exec',false);TP.sys.setcfg('break.tsh_tag_exec',false);TP.sys.setcfg('break.tsh_pipe_adjust',false);TP.sys.setcfg('break.tsh_pipe_connect',false);TP.sys.setcfg('break.uri_cache',false);TP.sys.setcfg('break.uri_catalog',false);TP.sys.setcfg('break.uri_content',false);TP.sys.setcfg('break.uri_construct',false);TP.sys.setcfg('break.uri_entry',false);TP.sys.setcfg('break.uri_execute',false);TP.sys.setcfg('break.uri_filter',false);TP.sys.setcfg('break.uri_fragment',false);TP.sys.setcfg('break.uri_headers',false);TP.sys.setcfg('break.uri_load',false);TP.sys.setcfg('break.uri_map',false);TP.sys.setcfg('break.uri_mime',false);TP.sys.setcfg('break.uri_nuke',false);TP.sys.setcfg('break.uri_pack',false);TP.sys.setcfg('break.uri_parse',false);TP.sys.setcfg('break.uri_process',false);TP.sys.setcfg('break.uri_profile',false);TP.sys.setcfg('break.uri_rewrite',false);TP.sys.setcfg('break.uri_resolve',false);TP.sys.setcfg('break.uri_resource',false);TP.sys.setcfg('break.uri_route',false);TP.sys.setcfg('break.uri_save',false);TP.sys.setcfg('break.uri_transform',false);TP.sys.setcfg('break.uri_virtual',false);TP.sys.setcfg('break.window_location',false);TP.sys.setcfg('break.xctrls_request',false);TP.sys.setcfg('break.xctrls_response',false);TP.sys.setcfg('break.xctrls_replace',false);TP.sys.setcfg('content.replace_max',30);TP.sys.setcfg('content.traversal_max',2500);TP.sys.setcfg('content.use_caches',true);TP.sys.setcfg('content.use_checkpoints',false);TP.sys.setcfg('css.process_styles',false);TP.sys.setcfg('debug.capture_errors',true);TP.sys.setcfg('debug.register_loggers',false);TP.sys.setcfg('debug.report_parse_errors',false);TP.sys.setcfg('debug.throw_evaluations',false);TP.sys.setcfg('debug.throw_exceptions',false);TP.sys.setcfg('debug.throw_handlers',false);TP.sys.setcfg('debug.trap_recursion',false);TP.sys.setcfg('debug.use_debugger',false);TP.sys.setcfg('http.timeout',15000);TP.sys.setcfg('http.use_webdav',true);TP.sys.setcfg('websocket.timeout',15000);TP.sys.setcfg('fork.delay',10);TP.sys.setcfg('fork.interval',5000);TP.sys.setcfg('fork.requeue_delay',10);TP.sys.setcfg('job.delay',0);TP.sys.setcfg('job.interval',10);TP.sys.setcfg('job.interval_max',1000*60*10);TP.sys.setcfg('job.heartbeat_interval',10);TP.sys.setcfg('job.heartbeat_threshold',100);TP.sys.setcfg('job.track_stats',false);TP.sys.setcfg('jsonp.delay',1000);TP.sys.setcfg('log.bootcfg',false);TP.sys.setcfg('log.bootenv',false);TP.sys.setcfg('log.default_format','tsh:pp');TP.sys.setcfg('log.level',1);TP.sys.setcfg('log.size_max',1000);TP.sys.setcfg('log.activities',true);TP.sys.setcfg('log.awaken_content',false);TP.sys.setcfg('log.bind_binding',false);TP.sys.setcfg('log.bind_refresh',false);TP.sys.setcfg('log.code_changes',false);TP.sys.setcfg('log.console_signals',false);TP.sys.setcfg('log.console_threshold',TP.ERROR);TP.sys.setcfg('log.content_transform',false);TP.sys.setcfg('log.css_processing',false);TP.sys.setcfg('log.dom_focus_signals',false);TP.sys.setcfg('log.dom_loaded_signals',false);TP.sys.setcfg('log.errors',true);TP.sys.setcfg('log.inferences',false);TP.sys.setcfg('log.io',false);TP.sys.setcfg('log.jobs',false);TP.sys.setcfg('log.keys',false);TP.sys.setcfg('log.links',false);TP.sys.setcfg('log.load_signals',false);TP.sys.setcfg('log.node_detachment',true);TP.sys.setcfg('log.node_discarded',true);TP.sys.setcfg('log.null_namespaces',false);TP.sys.setcfg('log.privilege_requests',false);TP.sys.setcfg('log.raise',true);TP.sys.setcfg('log.request_signals',false);TP.sys.setcfg('log.scans',false);TP.sys.setcfg('log.security',true);TP.sys.setcfg('log.signals',false);TP.sys.setcfg('log.signal_stack',false);TP.sys.setcfg('log.stack',false);TP.sys.setcfg('log.stack_arguments',false);TP.sys.setcfg('log.stack_file_info',false);TP.sys.setcfg('log.tsh_desugar',false);TP.sys.setcfg('log.tsh_xmlify',false);TP.sys.setcfg('log.tsh_execute',false);TP.sys.setcfg('log.tsh_run',false);TP.sys.setcfg('log.tsh_tokenize',false);TP.sys.setcfg('log.tsh_phases',false);TP.sys.setcfg('log.tsh_phase_nodes',false);TP.sys.setcfg('log.tsh_phase_skips',false);TP.sys.setcfg('log.tsh_signals',false);TP.sys.setcfg('log.user_io_signals',false);TP.sys.setcfg('log.xpaths',false);TP.sys.setcfg('mouse.drag_distance',3);TP.sys.setcfg('mouse.drag_delay',100);TP.sys.setcfg('mouse.hover_delay',300);TP.sys.setcfg('mouse.click_delay',0);TP.sys.setcfg('mouse.hover_repeat',100);TP.sys.setcfg('keyboard.shortcut_cancel_delay',500);TP.sys.setcfg('os.exec_async',true);TP.sys.setcfg('os.exec_delay',1000);TP.sys.setcfg('os.exec_interval',300);TP.sys.setcfg('tibet.activity_file','~app_log/activity.xml');TP.sys.setcfg('tibet.keyring_file','~lib_dat/keyrings.xml');TP.sys.setcfg('tibet.listener_file','~lib_dat/listeners.xml');TP.sys.setcfg('tibet.string_file','~lib_dat/strings.xml');TP.sys.setcfg('tibet.uri_file','~lib_dat/uris.xml');TP.sys.setcfg('tibet.vcards','~lib_dat/vcards.xml');TP.sys.setcfg('tdc.default_format','tsh:pp');TP.sys.setcfg('tdc.default_template','stdio_bubble');TP.sys.setcfg('tdc.expanded_cells',3);TP.sys.setcfg('tdc.highlight','border');TP.sys.setcfg('tdc.max_command',70);TP.sys.setcfg('tdc.max_status',40);TP.sys.setcfg('tdc.max_notice',120);TP.sys.setcfg('tdc.silent',false);TP.sys.setcfg('tdc.toggle_on','TP.sig.DOM_Alt_Up_Up');TP.sys.setcfg('tdc.toggle_off','TP.sig.DOM_Alt_Down_Up');TP.sys.setcfg('tdc.type_collections',true);TP.sys.setcfg('tdc.bubble_fade_time',2000);TP.sys.setcfg('sherpa.num_screens',1);TP.sys.setcfg('sherpa.default_format','sherpa:pp');TP.sys.setcfg('sherpa.silent',false);TP.sys.setcfg('sherpa.edit_mark_time',750);TP.sys.setcfg('sherpa.console_prompt','sherpaPrompt');TP.sys.setcfg('tds.cli_uri','/tds/cli');TP.sys.setcfg('tds.dav_root','~app_src');TP.sys.setcfg('tds.dav_uri','/tds/webdav');TP.sys.setcfg('tds.patch_root','~app_src');TP.sys.setcfg('tds.patch_uri','/tds/patch');TP.sys.setcfg('tds.port',1407);TP.sys.setcfg('tds.secret','change this in your tibet.json file');TP.sys.setcfg('tds.404','NotFound');TP.sys.setcfg('tds.500','ServerError');TP.sys.setcfg('tds.watch_event','fileChanged');TP.sys.setcfg('tds.watch_root','~app_src');TP.sys.setcfg('tds.watch_uri','/tds/watcher');TP.sys.setcfg('tsh.default_format','tsh:pp');TP.sys.setcfg('tsh.lint_step_max',10000);TP.sys.setcfg('tsh.lint_series_max',600000);TP.sys.setcfg('tsh.sleep_default',3000);TP.sys.setcfg('tsh.sleep_max',3000);TP.sys.setcfg('tsh.split_commands',false);TP.sys.setcfg('tsh.test_step_max',15000);TP.sys.setcfg('tsh.test_series_max',600000);TP.sys.setcfg('tsh.trace_commands',false);TP.sys.setcfg('signal.duplicate_interests',false);TP.sys.setcfg('signal.ignore_via_flag',false);TP.sys.setcfg('signal.queue_load_signals',false);TP.sys.setcfg('signal.dom_focus_signals',true);TP.sys.setcfg('signal.dom_loaded',true);TP.sys.setcfg('signal.log_change',false);TP.sys.setcfg('signal.track_stats',false);TP.sys.setcfg('security.request_privileges',false);TP.sys.setcfg('stack.backtrace_max',30);TP.sys.setcfg('stack.descent_max',10);TP.sys.setcfg('stack.recursion_max',30);TP.sys.setcfg('tibet.plugins',false);TP.sys.setcfg('boot.rootcomp','tibetdir');TP.sys.setcfg('tibet.unique_types',true);TP.sys.setcfg('tibet.$$cache_children',true);TP.sys.setcfg('tibet.$$cache_cnames',true);TP.sys.setcfg('tibet.$$cache_parents',true);TP.sys.setcfg('tibet.$$cache_pnames',true);TP.sys.setcfg('tibet.$$construct_dnus',true);TP.sys.setcfg('tibet.$$invoke_inferences',true);TP.sys.setcfg('tibet.$$use_backstop',false);TP.sys.setcfg('tibet.$$use_inferencing',true);TP.sys.setcfg('tibet.uirootframed',false);TP.sys.setcfg('tibet.uirootmulti',false);TP.sys.setcfg('tibet.apptag',null);TP.sys.setcfg('tibet.sherpa',false);TP.sys.setcfg('tibet.indexpage','~/index.html');TP.sys.setcfg('tibet.loginpage','~app_html/login.html');TP.sys.setcfg('array.contains_loop_max',50);TP.sys.setcfg('perform.instrument_max',100);TP.sys.setcfg('signal.stats_max',1000);TP.sys.setcfg('uri.handler','TP.core.URIHandler');TP.sys.setcfg('uri.rewriter','TP.core.URIRewriter');TP.sys.setcfg('uri.router','TP.core.URIRouter');TP.sys.setcfg('xpath.parser_path','~lib_deps/xpath-tpi.js');TP.sys.setcfg('xslt.boilerplate_path','~lib_src/tsh/xsl/tsh_template_template.xsl');
;(function(a){TP=a.TP||{};TP.sys=TP.sys||{};TP.boot=TP.boot||{};APP=a.APP||{};TP.boot.$$theme={trace:TP.sys.cfg('log.tracecolor'),info:TP.sys.cfg('log.infocolor'),warn:TP.sys.cfg('log.warncolor'),error:TP.sys.cfg('log.errorcolor'),fatal:TP.sys.cfg('log.fatalcolor'),severe:TP.sys.cfg('log.severecolor'),system:TP.sys.cfg('log.systemcolor'),time:TP.sys.cfg('log.timecolor'),delta:TP.sys.cfg('log.deltacolor'),slow:TP.sys.cfg('log.slowcolor'),debug:TP.sys.cfg('log.debugcolor'),verbose:TP.sys.cfg('log.verbosecolor')};if(TP.sys.$features==null){TP.sys.$features={};TP.sys.$featureTests={};}TP.sys.hasFeature=function(b,d){var a,c;if(TP.boot.$isValid(a=TP.sys.$features[b])&&d!==true){return a;}if(typeof(c=TP.sys.$featureTests[b])==='function'){a=c();}else if(b.slice(0,4)==='dom-'){a=document.implementation.hasFeature(b.slice(4),'2.0');}else{a=false;}TP.sys.$features[b]=a;return a;};TP.sys.addFeatureTest=function(a,b,c){TP.sys.$featureTests[a]=b;if(c){return TP.boot.hasFeature(a);}};TP.sys.hasFeatureTest=function(a){return typeof TP.sys.$featureTests[a]==='function';};TP.sys.addFeatureTest('gecko',function(){return TP.boot.isUA('gecko');});TP.sys.addFeatureTest('firefox',function(){return TP.boot.isUA('firefox');});TP.sys.addFeatureTest('trident',function(){return TP.boot.isUA('trident');});TP.sys.addFeatureTest('ie',function(){return TP.boot.isUA('ie');});TP.sys.addFeatureTest('webkit',function(){return TP.boot.isUA('webkit');});TP.sys.addFeatureTest('safari',function(){return TP.boot.isUA('safari');});TP.sys.addFeatureTest('chrome',function(){return TP.boot.isUA('chrome');});TP.sys.addFeatureTest('opera',function(){return TP.boot.isUA('opera');});TP.sys.hasPackage=function(a,c){var b;b=c||'base';if(TP.boot.$$packages[a+'#'+'full']===true){return true;}return TP.boot.$$packages[a+'#'+b]===true;};TP.boot.$alert=alert;TP.boot.$prompt=prompt;TP.boot.$confirm=confirm;TP.boot.$notify=TP.boot.$alert;TP.STDERR_ALERT=function(a,b,c){TP.STDERR_LOG(a,b,c);TP.boot.$alert(a);return;};TP.STDERR_BREAK=function(a,b,c){TP.STDERR_LOG(a,b,c);debugger;return;};TP.STDERR_LOG=function(c,d,g){var a,b,e,f;switch(arguments.length){case 1:break;case 2:if(TP.boot.$isNumber(d)){b=d;}else{a=d;}break;default:a=d;b=g;break;}if(TP.boot.$notValid(b)){if(typeof c==='string'){b=TP.ERROR;}else{b=TP.SEVERE;}}e=c;if(TP.boot.$isValid(a)){if(TP.boot.$isArgumentArray(a)){f=a;}else if(a instanceof Error){e=TP.boot.$ec(a,c);}else if(TP.boot.$notValid(a.message)){e=TP.boot.$annotate(a,c);}}TP.boot.log(e,b,f);return;};TP.STDERR_NOTIFY=function(a,b,c){TP.STDERR_LOG(a,b,c);TP.boot.$notify(a);return;};TP.STDERR_NULL=function(a,b,c){return;};TP.STDIN_CONFIRM=function(b){var a;a=confirm(b==null?'?':b);if(TP.boot.$notValid(a)||a===''){return null;}else{return a;}};TP.STDIN_PROMPT=function(b,c){var a;a=prompt(b==null?'?':b,c==null?'':c);if(a==null||a===''){return null;}else{return a;}};TP.STDOUT_ALERT=function(a,b,c){TP.STDOUT_LOG(a,b,c);TP.boot.$alert(a);return;};TP.STDOUT_LOG=function(e,c,g){var a,b,d,f;switch(arguments.length){case 1:break;case 2:if(TP.boot.$isNumber(c)){b=c;}else{a=c;}break;default:a=c;b=g;break;}if(TP.boot.$notValid(b)){b=TP.INFO;}d=e;if(TP.boot.$isValid(a)){if(TP.boot.$isArgumentArray(a)){f=a;}else{d=TP.boot.$annotate(a,e);}}TP.boot.log(d,b,f);return;};TP.STDOUT_NOTIFY=function(a,b,c){TP.STDOUT_LOG(a,b,c);TP.boot.$notify(a);return;};TP.boot.$stderr=TP.STDERR_LOG;TP.boot.$stdin=TP.STDIN_PROMPT;TP.boot.$stdout=TP.STDOUT_LOG;TP.sys.offerror=window.onerror;window.onerror=function(d,f,g,h,b){var c,e,a;try{c=TP.boot.$$onerrorURL;e=c==null?f:c;a=d||'Error';a+=' in file: '+e+' line: '+g+' column: '+h;if(b){if(TP.getStackInfo){a+='\nSTACK:\n'+TP.getStackInfo(b).join('\n');}else{a+='\nSTACK:\n'+b.stack;}}TP.boot.$stderr(a,TP.FATAL);}catch(b){top.console.error('Error logging onerror: '+b.message);top.console.error(a||d);}$STATUS=TP.FAILURE;return false;};TP.$agent=null;TP.$platform='other';TP.$language=null;TP.$browser=null;TP.$browserUI=null;TP.$browserSuffix=null;TP.$browserIdent=null;TP.$browserMajor=null;TP.$browserMinor=null;TP.$browserBuild=null;TP.$browserPatch=null;TP.$browserUIIdent=null;TP.$browserUIMajor=null;TP.$browserUIMinor=null;TP.$browserUIBuild=null;TP.$browserUIPatch=null;TP.$msxml=null;TP.$versions=null;TP.$major=null;TP.$minor=null;TP.$$assignBrowser=function(b){var a;a=b.split('.');TP.$browserIdent=b;TP.$browserMajor=a[0]==null?0:a[0];TP.$browserMinor=a[1]==null?0:a[1];TP.$browserBuild=a[2]==null?0:a[2];TP.$browserPatch=a[3]==null?0:a[3];};TP.$$assignBrowserUI=function(b){var c,a;c=b.replace('+','');a=c.split('.');TP.$browserUIIdent=b;TP.$browserUIMajor=a[0]==null?0:a[0];TP.$browserUIMinor=a[1]==null?0:a[1];TP.$browserUIBuild=a[2]==null?0:a[2];TP.$browserUIPatch=a[3]==null?0:a[3];};TP.$browser=navigator.userAgent;TP.$agent=navigator.userAgent.toLowerCase();TP.$versions=navigator.appVersion.split('.');TP.$major=parseInt(TP.$versions[0],10);if(TP.$versions.length>1){TP.$minor=parseInt(TP.$versions[1],10);}else{TP.$minor=0;}delete TP.$versions;if(TP.$agent.indexOf('windows nt')!==-1){if(TP.$agent.indexOf('nt 5.0')!==-1){TP.$platform='win2k';}else if(TP.$agent.indexOf('nt 5.1')!==-1){TP.$platform='winxp';}else if(TP.$agent.indexOf('nt 5.2')!==-1){TP.$platform='winxps';}else if(TP.$agent.indexOf('nt 6.0'!==-1)){TP.$platform='vista';}else{TP.$platform='winnt';}}else if(TP.$agent.indexOf('win')!==-1){TP.$platform='win';}else if(TP.$agent.indexOf('mac')!==-1){TP.$platform='mac';if(TP.$agent.indexOf('68k')!==-1||TP.$agent.indexOf('68000')!==-1){TP.$platform='mac68k';}else if(TP.$agent.indexOf('ppc')!==-1||TP.$agent.indexOf('powerpc')!==-1){TP.$platform='macppc';}if(TP.$agent.indexOf(' os x')!==-1){TP.$platform='macosx';}}else if(TP.$agent.indexOf('sunos')!==-1||TP.$agent.indexOf('irix')!==-1||TP.$agent.indexOf('hp-ux')!==-1||TP.$agent.indexOf('aix')!==-1||TP.$agent.indexOf('inux')!==-1||TP.$agent.indexOf('ultrix')!==-1||TP.$agent.indexOf('unix_system_v')!==-1||TP.$agent.indexOf('reliantunix')!==-1||TP.$agent.indexOf('sinix')!==-1||TP.$agent.indexOf('freebsd')!==-1||TP.$agent.indexOf('bsd')!==-1){TP.$platform='*nix';}if(navigator.userLanguage!=null){TP.$language=navigator.userLanguage;}else{TP.$language=navigator.language;}TP.$$match=null;if(TP.$agent.indexOf('chrome/')!==-1){TP.$browser='chrome';TP.$browserUI='webkit';TP.$browserSuffix='Webkit';TP.$$match=TP.$agent.match(/chrome\/([^ ]*?) /);if(TP.$$match!=null){TP.$$assignBrowser(TP.$$match[1]);}TP.$$match=TP.$agent.match(/applewebkit\/([^ ]*?) /);if(TP.$$match!=null){TP.$$assignBrowserUI(TP.$$match[1]);}TP.$language=TP.$language.replace('_','-');}else if(TP.$agent.indexOf('safari/')!==-1||TP.$agent.indexOf('mobile/')!==-1){if(TP.$agent.indexOf('arora')!==-1||TP.$agent.indexOf('epiphany')!==-1||TP.$agent.indexOf('midori')!==-1||TP.$agent.indexOf('omniweb')!==-1||TP.$agent.indexOf('shiira')!==-1){TP.$browser='wk-clone';}else{TP.$browser='safari';TP.$browserUI='webkit';TP.$browserSuffix='Webkit';TP.$$match=TP.$agent.match(/version\/([^ ]*?)($| )/);if(TP.$$match!=null){TP.$$assignBrowser(TP.$$match[1]);}TP.$$match=TP.$agent.match(/applewebkit\/([^ ]*?)($| )/);if(TP.$$match!=null){TP.$$assignBrowserUI(TP.$$match[1]);}}}else if(TP.$agent.indexOf('firefox/')!==-1||TP.$agent.indexOf('minefield/')!==-1||TP.$agent.indexOf('mozilladeveloperpreview/'!==-1)){if(TP.$agent.indexOf('camino')!==-1||TP.$agent.indexOf('epiphany')!==-1||TP.$agent.indexOf('flock')!==-1||TP.$agent.indexOf('navigator')!==-1||TP.$agent.indexOf('swiftfox')!==-1){TP.$browser='ff-clone';}else{TP.$browser='firefox';TP.$browserUI='gecko';TP.$browserSuffix='Gecko';if(TP.$agent.indexOf('minefield')!==-1){TP.$$match=TP.$agent.match(/minefield\/([^ ]*?)($| )/);}else{TP.$$match=TP.$agent.match(/firefox\/([^ ]*?)($| )/);}if(TP.$$match!=null){TP.$$assignBrowser(TP.$$match[1]);}TP.$$match=TP.$agent.match(/rv:(.*?)\)/);if(TP.$$match!=null){TP.$$assignBrowserUI(TP.$$match[1]);}}}else if(TP.$agent.indexOf('msie')!==-1){if(TP.global.ActiveXObject!=null){TP.$browser='ie';TP.$browserUI='trident';TP.$browserSuffix='IE';TP.$$match=TP.$agent.match(/msie (.*?);/);if(TP.$$match!=null){TP.$$assignBrowser(TP.$$match[1]);}if(TP.$browserMajor===7){TP.$$assignBrowserUI('5.0.0.0');}else if(TP.$browserMajor===8){TP.$$assignBrowserUI('6.0.0.0');}}else{TP.$browser='spoof';}}TP.boot.getBrowser=function(){return TP.$browser;};TP.boot.getBrowserUI=function(){return TP.$browserUI;};TP.boot.isMac=function(){return TP.$platform.indexOf('mac')===0;};TP.boot.isNix=function(){return TP.$platform.indexOf('*nix')===0;};TP.boot.isWin=function(){return TP.$platform.indexOf('win')===0||TP.$platform.indexOf('vista')===0;};TP.boot.isUA=function(m,n){var g,l,k,f,j,h,i,e,a,c,b,d;g=m.toLowerCase();if(arguments.length===1){if((l=TP.$$uaInfo[g])!=null){return l;}if(TP.$browser!==g&&TP.$browserUI!==g){TP.$$uaInfo[g]=false;return false;}}if(TP.$browser===g){f='$browserMajor';j='$browserMinor';h='$browserBuild';i='$browserPatch';}else if(TP.$browserUI===g){f='$browserUIMajor';j='$browserUIMinor';h='$browserUIBuild';i='$browserUIPatch';}else{return false;}switch(arguments.length){case 1:TP.$$uaInfo[g]=true;return true;case 2:return TP[f]===arguments[1];case 3:e=arguments[1];k=parseInt(arguments[2],10);if(isNaN(k)){d=arguments[2];}else{a=arguments[2];}break;case 4:e=arguments[1];a=arguments[2];k=parseInt(arguments[3],10);if(isNaN(k)){d=arguments[3];}else{c=arguments[3];}break;case 5:e=arguments[1];a=arguments[2];c=arguments[3];k=parseInt(arguments[4],10);if(isNaN(k)){d=arguments[4];}else{b=arguments[4];}break;case 6:e=arguments[1];a=arguments[2];c=arguments[3];b=arguments[4];d=arguments[5];break;default:break;}d=d!=null?d.toUpperCase():null;if(d===TP.UP){if(TP[f]<e){return false;}else if(TP[f]>e){return true;}if(a==null||TP[j]>a){return true;}else if(TP[j]<a){return false;}if(c==null||TP[h]>c){return true;}else if(TP[h]<c){return false;}if(b==null||TP[i]>b){return true;}else if(TP[i]<b){return false;}}else if(d===TP.DOWN){if(TP[f]>e){return false;}else if(TP[f]<e){return true;}if(a==null||TP[j]<a){return true;}else if(TP[j]>a){return false;}if(c==null||TP[h]<c){return true;}else if(TP[h]>c){return false;}if(b==null||TP[i]<b){return true;}else if(b!=null&&TP[i]>b){return false;}}else{if(e!==TP[f]){return false;}if(a!=null&&a!==TP[j]){return false;}if(c!=null&&c!==TP[h]){return false;}if(b!=null&&b!==TP[i]){return false;}}return true;};if(TP.boot.isUA('IE')){(function(){var a;try{a=new ActiveXObject('Msxml2.DOMDocument.6.0');TP.$msxml=6;}catch(b){try{a=new ActiveXObject('Msxml2.DOMDocument.5.0');TP.$msxml=5;}catch(b){try{a=new ActiveXObject('Msxml2.DOMDocument.4.0');TP.$msxml=4;}catch(b){try{a=new ActiveXObject('Msxml2.DOMDocument.3.0');TP.$msxml=3;}catch(b){try{a=new ActiveXObject('Msxml2.DOMDocument.2.0');TP.$msxml=2;}catch(a){}}}}}}());}TP.boot.isMSXML=function(a,b){if(b===TP.UP){return TP.$msxml>=a;}else if(b===TP.DOWN){return TP.$msxml<=a;}else{return TP.$msxml===a;}};TP.boot.isObsolete=function(){if(typeof Object.keys!=='function'||typeof Object.defineProperty!=='function'){return true;}return false;};TP.boot.isSupported=function(){if(window.WebSocket&&window.Worker){return true;}return false;};TP.sys.$httpBased=window.location.protocol.indexOf('file')!==0;TP.sys.$scheme=window.location.protocol.slice(0,-1);TP.sys.$pathname=decodeURI(window.location.pathname);if(TP.sys.$httpBased){TP.sys.$host=window.location.hostname;TP.sys.$port=window.location.port===''||window.location.port==null?80:window.location.port;}else{TP.sys.$host='';TP.sys.$port='';}TP.sys.isHTTPBased=function(){return TP.sys.$httpBased;};TP.sys.getLaunchRoot=function(){var a,c,b;if(TP.boot.$isValid(TP.sys.$launchRoot)){return TP.sys.$launchRoot;}if(TP.sys.isHTTPBased()){a=TP.sys.getScheme()+'://'+TP.sys.getHost();if(TP.boot.$isValid(c=TP.sys.getPort())&&c.toString()!=='80'){a+=':'+c;}}else if(TP.boot.isWin()){b=decodeURI(window.location.toString());b=b.split(/[#?]/)[0];a=b.slice(0,b.lastIndexOf(':')+1);}else{a='file://';}TP.sys.$launchRoot=a;return a;};TP.sys.getHost=function(){return TP.sys.$host;};TP.sys.getPathname=function(){return TP.sys.$pathname;};TP.sys.getPort=function(){return TP.sys.$port;};TP.sys.getScheme=function(){return TP.sys.$scheme;};TP.boot.$httpCall=function(b,d,e,f){var c,a,g;if(b==null){return TP.boot.$httpError('InvalidURL: '+b);}if(d==null){return TP.boot.$httpError('InvalidCallType: '+d);}if(TP.boot.isUA('GECKO')&&b.indexOf(TP.sys.getLaunchRoot())!==0){try{if(TP.sys.cfg('log.privilege_requests')){TP.boot.$stdout('Privilege request at TP.boot.$httpCall',TP.WARN);}netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserRead');}catch(a){return TP.boot.$httpError('PrivilegeException. url: '+b,TP.boot.$ec(a));}}try{a=TP.boot.$httpCreate();if(TP.boot.isUA('GECKO')&&TP.boot.$uriResultType(b)!==TP.DOM){a.overrideMimeType('text/plain');}}catch(a){return TP.boot.$httpError('RequestObjectError.  url: '+b,TP.boot.$ec(a));}try{a.open(d,b,false);}catch(a){return TP.boot.$httpError('RequestOpenError. url: '+b,TP.boot.$ec(a));}try{a.setRequestHeader('Pragma','no-cache');a.setRequestHeader('Cache-control','no-cache');a.setRequestHeader('Cache-control','no-store');a.setRequestHeader('X-Requested-With','XMLHttpRequest');if(e!=null){g=e.length;for(c=0;c<g;c=c+2){a.setRequestHeader(e[c],e[c+1]);}}}catch(a){return TP.boot.$httpError('HeaderConfigurationError. url: '+b,TP.boot.$ec(a));}try{if(TP.sys.cfg('debug.http')){TP.boot.$stdout('TP.boot.$httpCall() targetUrl: '+b,TP.TRACE);TP.boot.$stdout('TP.boot.$httpCall() callType: '+d,TP.TRACE);TP.boot.$stdout('TP.boot.$httpCall() callUri: '+(f!=null?f:'n/a'),TP.TRACE);}a.send(f);if(TP.sys.cfg('debug.http')){TP.boot.$stdout('TP.boot.$httpCall() status: '+a.status,TP.TRACE);TP.boot.$stdout('TP.boot.$httpCall() headers: '+a.getAllResponseHeaders(),TP.TRACE);if(TP.boot.$$verbose){TP.boot.$stdout('TP.boot.$httpCall() result: '+a.responseText,TP.TRACE);}}}catch(a){return TP.boot.$httpError('HTTPCallException: url: '+b,TP.boot.$ec(a));}return a;};TP.boot.$httpCreate=function(){var a,c,d,b;if(TP.boot.isUA('IE')){c=['Msxml2.XMLHTTP.6.0','Msxml2.XMLHTTP.3.0','Msxml2.XMLHTTP','Microsoft.XMLHTTP'];d=c.length;for(b=0;b<d;b++){try{a=new ActiveXObject(c[b]);break;}catch(a){}}}else{a=new XMLHttpRequest();}if(a==null){TP.boot.shouldStop('HTTP request creation failure.');TP.boot.$stderr('RequestCreationError: could not create request object.',TP.FATAL);}return a;};TP.boot.$httpError=function(a,b){if(TP.sys.cfg('debug.http')){TP.boot.$stderr(a,b);}throw new Error(a);};TP.boot.$uriCollapsePath=function(c){var a,b;a=TP.boot.$uriExpandPath(c);if(TP.HAS_PATH_OFFSET_REGEX.test(a)===false){return decodeURI(a);}while(TP.HAS_PATH_OFFSET_REGEX.test(a)){b=a.replace(TP.REMOVE_PATH_OFFSET_REGEX,'');if(b===a){break;}a=b;}while(TP.HAS_PATH_NOOP_REGEX.test(a)){b=a.replace(TP.REMOVE_PATH_NOOP_REGEX,'');if(b===a){break;}a=b;}return decodeURI(a);};TP.boot.$uriExpandPath=function(b){var a,e,d,c;if((a=TP.boot.$$fullPaths[b])!=null){return a;}if(!b){return b;}if(b==='/'){return TP.sys.getLaunchRoot();}if(b.indexOf('/')===0){return TP.sys.getLaunchRoot()+b;}if(b.indexOf('~')!==0){return b;}a=b;if(a.indexOf('~/')===0||a==='~'){a=TP.boot.$uriJoinPaths(TP.boot.$getAppHead(),a.slice(2));}else if(a.indexOf('~app/')===0||a==='~app'){a=TP.boot.$uriJoinPaths(TP.boot.$getAppRoot(),a.slice(5));}else if(a.indexOf('~lib/')===0||a==='~lib'){a=TP.boot.$uriJoinPaths(TP.boot.$getLibRoot(),a.slice(5));}else if(a.indexOf('~tibet/')===0||a==='~tibet'){a=TP.boot.$uriJoinPaths(TP.boot.$getLibRoot(),a.slice(7));}else{e=a.match(/~([^\/]*)\/(.*)/);if(!e){e=a.match(/~([^\/]*)/);}if(e){d=e[1];c=TP.sys.cfg('path.'+d);if(typeof c==='string'){if(c.indexOf('/')===0){c=c.slice(1);}if(c.lastIndexOf('/')===c.length-1){c=c.slice(0,-1);}a=b.replace('~'+d,c);}else{if(d==='app_root'){a=b.replace('~'+d,TP.boot.$$approot);}else if(d==='lib_root'){a=b.replace('~'+d,TP.boot.$$libroot);}}}}if(a!==b&&a.indexOf('~')===0){a=TP.boot.$uriExpandPath(a);}a=TP.boot.$uriCollapsePath(a);TP.boot.$$fullPaths[b]=a;return a;};TP.boot.$uriInLocalFormat=function(b){var a;a=TP.boot.$uriExpandPath(b);if(a.indexOf('file:')!==0){return b;}a=TP.boot.$uriMinusFileScheme(a);if(!TP.boot.isWin()){return a;}if(a.charAt(1)!==':'){a=a.charAt(0)+':'+a.slice(1,a.length);}a=a.replace(/\//g,'\\\\');return a;};TP.boot.$uriInTIBETFormat=function(b){var a;if(!TP.boot.$$approot||!TP.boot.$$libroot){return b;}a=b.replace(TP.boot.$uriExpandPath('~app_cfg'),'~app_cfg');a=a.replace(TP.boot.$uriExpandPath('~lib_cfg'),'~lib_cfg');a=a.replace(TP.boot.$uriExpandPath('~app_src'),'~app_src');a=a.replace(TP.boot.$uriExpandPath('~lib_src'),'~lib_src');a=a.replace(TP.boot.$uriExpandPath('~app'),'~app');a=a.replace(TP.boot.$uriExpandPath('~lib'),'~lib');a=a.replace(TP.boot.$uriExpandPath('~tibet'),'~tibet');a=a.replace(TP.boot.$uriExpandPath('~'),'~');return a;};TP.boot.$uriIsAbsolute=function(a){if(a.indexOf('~')===0){return true;}if(a.indexOf('/')===0){return true;}if(/^[a-zA-Z]+:/.test(a)){return true;}return false;};TP.boot.$uriIsVirtual=function(a){return a.indexOf('~')===0;};TP.boot.$uriJoinPaths=function(d,c){var e,h,f,a,b,g;if(d==null||d===''){return c;}if(c==null||c===''){return d;}if(c.indexOf('~')===0){return c;}if(c.indexOf('/')===0){return TP.boot.$uriExpandPath(c);}if(c.indexOf(':')!==TP.NOT_FOUND){h=TP.SCHEMES.length;for(e=0;e<h;e++){if(c.indexOf(''+TP.SCHEMES[e]+':')===0){return c;}}}if(d.indexOf('about:blank')===0){a=d.slice('about:blank'.length);}else{a=d;}if(a.indexOf('~')===0){g=TP.boot.$uriExpandPath(a);if(g!==a){return TP.boot.$uriJoinPaths(g,c);}}b=c;if(b.indexOf('/Volumes')===0){if(a.indexOf(b)!==TP.NOT_FOUND){return a;}if(b.indexOf(a)!==TP.NOT_FOUND){return b;}if(a.indexOf(TP.boot.$uriPlusFileScheme(b))){return a;}if(b.indexOf(TP.boot.$uriPlusFileScheme(a))!==TP.NOT_FOUND){return b;}if(TP.boot.$uriPlusFileScheme(a).indexOf(b)!==TP.NOT_FOUND){return TP.boot.$uriPlusFileScheme(a);}if(TP.boot.$uriPlusFileScheme(b).indexOf(a)!==TP.NOT_FOUND){return TP.boot.$uriPlusFileScheme(b);}return TP.boot.$uriPlusFileScheme(b);}if(b.indexOf('./')===0){b=b.slice(1);}if(a.charAt(a.length-1)==='/'){if(a.lastIndexOf('//')===a.length-2){a=a.slice(0,a.length-2);}else{a=a.slice(0,a.length-1);}}while(b.indexOf('../')===0){b=b.slice(3,b.length);a=a.slice(0,a.lastIndexOf('/'));}if(b.charAt(0)!=='/'){f=a+'/'+b;}else{f=a+b;}return f;};TP.boot.$uriMinusFileScheme=function(b){var a;if(!b){TP.boot.$stderr('InvalidURI');return;}if(b.toLowerCase().indexOf('file:')!==0){return b;}a=b.slice('file://'.length);if(TP.boot.isWin()&&/^\/\w:/.test(a)){a=a.slice(1);}return a;};TP.boot.$uriPlusFileScheme=function(a){var c,b;if(!a){TP.boot.$stderr('InvalidURI');return;}if(a.toLowerCase().indexOf('file:')===0){return a;}c='file://';if(TP.boot.isWin()&&/^\w:/.test(a)){c=c+'/';}b=c+a;if(/file:\/\/\/\//.test(b)){b=b.replace(/file:\/\//,'file:');}return b;};TP.boot.$uriRelativeToPath=function(g,j,k){var i,b,a,n,e,c,h,f,d,m,l;if(!g){return;}if(!j){return g;}if(g===j){return'.';}b=TP.boot.$uriExpandPath(g);a=TP.boot.$uriExpandPath(j);if(b.length>1&&b.lastIndexOf('/')===b.length-1){b=b.slice(0,-1);}if(k===true){if((n=a.lastIndexOf('/'))!==TP.NOT_FOUND){if(a.lastIndexOf('/')===a.length-1){a=a.slice(0,-1);a=a.slice(0,a.lastIndexOf('/'));}else{a=a.slice(0,a.lastIndexOf('/'));}}else{if(TP.FILE_PATH_REGEX.test(g)){return'.'+b.slice(b.lastIndexOf('/'));}else{return'.';}}}else if(k===false){if(a.lastIndexOf('/')===a.length-1){a=a.slice(0,-1);}}else{if(a.lastIndexOf('/')===a.length-1){i=false;a=a.slice(0,-1);}else{if(TP.FILE_PATH_REGEX.test(a)){i=true;a=a.slice(0,a.lastIndexOf('/'));}else{i=false;}}}if(!b){return;}if(!a){return b;}if(b===a){return'.';}if(a.indexOf(b)!==TP.NOT_FOUND){c=a.replace(b,'');if(c.indexOf('/')===0){c=c.slice(1);}c=c.split('/');m=c.length;for(d=0;d<m;d++){c[d]='..';}return c.join('/');}if((c=b.replace(a,'.'))!==b){if(c.indexOf('./')===0){return c;}}if(b.indexOf('.')===0){if(i===true){if(b.indexOf('./')===0){return'../'+b.slice(2);}else{return'../'+b;}}return b;}if((f=a.indexOf(b))!==TP.NOT_FOUND){l=a.slice(f).replace(b,'');h=l.split('/').length;e='';for(d=0;d<h;d++){e=e+'../';}return e+b;}h=0;f=a.lastIndexOf('/');while(f!==TP.NOT_FOUND){a=a.slice(0,f);if((c=b.replace(a,'..'))!==b){if(c.indexOf('../')===0){e='';for(d=0;d<h;d++){e=e+'../';}return e+c;}}h++;f=a.lastIndexOf('/');}return b;};TP.boot.$uriWithRoot=function(a,d){var b,c;if(!a){return;}b=a.toLowerCase();if(b.indexOf('http:')===0||b.indexOf('file:')===0||b.indexOf('https:')===0){return a;}if(TP.boot.$notValid(d)){c=TP.sys.getAppHead();}else{c=d;}return TP.boot.$uriJoinPaths(c,a);};TP.boot.$uriLocation=function(a){if(!a){TP.boot.$stderr('InvalidURI');return null;}if(a.toLowerCase().indexOf('file')===0){return TP.boot.$uriLocationFile(a);}else{return TP.boot.$uriLocationHttp(a);}};TP.boot.$uriLocationFile=function(a){return a;};TP.boot.$uriLocationHttp=function(b){var a;try{a=TP.boot.$httpCall(b,TP.HTTP_HEAD);if(a.status===200){return b;}else if(a.status>=300&&a.status<=307){return a.getResponseHeader('Location');}else{TP.boot.$stderr('NotFound: '+b);}}catch(a){TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(a));}return null;};TP.boot.$uriLastModified=function(b){var a;if(!b){TP.boot.$stderr('InvalidURL: '+b);return null;}a=TP.boot.$uriWithRoot(b);if(a.toLowerCase().indexOf('file')===0){if(TP.boot.isUA('IE')){return TP.boot.$uriLastModifiedIEFile(a);}else if(TP.boot.isUA('GECKO')){return TP.boot.$uriLastModifiedMozFile(a);}else if(TP.boot.isUA('WEBKIT')){return new Date();}}else{return TP.boot.$uriLastModifiedHttp(a);}return null;};TP.boot.$uriLastModifiedIEFile=function(d){var a,b,c;a=TP.boot.$uriMinusFileScheme(TP.boot.$uriInLocalFormat(d));a=unescape(a);try{b=new ActiveXObject('Scripting.FileSystemObject');if(b.FileExists(a)){c=b.GetFile(a);return new Date(c.DateLastModified);}else{TP.boot.$stderr('NotFound: '+a);}}catch(b){TP.boot.$stderr('AccessException: '+a,TP.boot.$ec(b));}return null;};TP.boot.$uriLastModifiedMozFile=function(b){var c,d,e,f,a,g,h;c=TP.boot.$httpCreate();if(TP.boot.isUA('GECKO')&&TP.boot.$uriResultType(b)!==TP.DOM){c.overrideMimeType('text/plain');}try{c.open(TP.HTTP_GET,b.slice(0,b.lastIndexOf('/')),false);c.send(null);}catch(a){return null;}d=c.responseText;if(d==null){return null;}d=d.replace('\n','','g').replace('> <','><','g');e=b.slice(b.lastIndexOf('/')+1);f=new RegExp('>'+e.replace('.','\\.')+'<\\/a><\\/td>(.*?)<\\/tr>');a=d.match(f);if(!a){return null;}g=a[1];a=g.split('</td><td>');h=new Date(a[1]+' '+a[2].slice(0,-5));return h;};TP.boot.$uriLastModifiedHttp=function(b){var a,c;try{a=TP.boot.$httpCall(b,TP.HTTP_HEAD);if(a.status===200){c=a.getResponseHeader('Last-Modified');return new Date(c);}else if(a.status>=300&&a.status<=307){return TP.boot.$uriLastModifiedMozHttp(a.getResponseHeader('Location'));}else{TP.boot.$stderr('NotFound: '+b);}}catch(a){TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(a));}return null;};TP.boot.$uriCurrent=function(a,b){var c,d;if(a==null){return false;}if(b==null){return true;}try{c=TP.boot.$uriLastModified(a);}catch(a){return false;}try{d=TP.boot.$uriLastModified(b);return c>=d;}catch(a){return true;}TP.boot.$stderr('UnsupportedFeature: TP.boot.$uriCurrent()');return false;};TP.boot.$uriExists=function(a){if(!a){return false;}if(a.toLowerCase().indexOf('file')===0){return TP.boot.$uriExistsFile(a);}else{return TP.boot.$uriExistsHttp(a);}};TP.boot.$uriExistsFile=function(b){var a;a=TP.boot.$httpCreate();if(TP.boot.isUA('GECKO')&&TP.boot.$uriResultType(b)!==TP.DOM){a.overrideMimeType('text/plain');}try{a.open(TP.HTTP_GET,b,false);a.send(null);}catch(c){if(TP.boot.isUA('IE')){if(/cannot locate/.test(c.message)){return false;}if(/System error: -2146697211/.test(c.message)&&(a.status===2||a.status===3)){return false;}}else if(TP.boot.isUA('GECKO')){if(/Access to restricted URI denied/.test(c.message)){TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(c));}return false;}else{return false;}}if(TP.boot.isUA('WEBKIT')){if(a.status===404){return false;}if(TP.boot.isWin()&&a.status===-1100){return false;}if(TP.boot.isMac()&&(a.status===-1100||a.status===400)){return false;}if(TP.boot.isWin()&&a.status===1789378560){return false;}if(a.status===0&&a.responseText===''){return false;}}return true;};TP.boot.$uriExistsHttp=function(b){var a;try{a=TP.boot.$httpCall(b,TP.HTTP_HEAD);if(a.status===200){return true;}else if(a.status>=300&&a.status<=307){return true;}else if(a.status===0){if(/^chrome-extension/.test(b)&&a.response!=null){return true;}}}catch(a){if(b&&b.indexOf(TP.sys.cfg('boot.tibetinf'))!==TP.NOT_FOUND){return true;}TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(a));return false;}return false;};TP.boot.$uriLoad=function(a,b,h,f,g){var d,c,e;if(a==null){TP.boot.$stderr('InvalidURI');return null;}b=TP.boot.$uriResultType(a,b);TP.boot.$loadCached=false;if(TP.sys.cfg('boot.localcache')&&f===true){d=TP.boot.$uriInTIBETFormat(a);switch(TP.sys.cfg('import.source')){case'marked':case'local':TP.$BOOT_STORAGE.get(a,function(a){if(TP.boot.$isValid(a)){c=TP.boot.$uriResult(a,b);TP.boot.$loadCached=true;}});if(TP.boot.$loadCached){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Loaded '+d+' from cache.',TP.TRACE);}return c;}break;case'modified':if(/^http/.test(a)){TP.$BOOT_STORAGE.get(a+'_lastmodified',function(a){if(TP.boot.$isValid(a)){e=a;}});if(e){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Found '+d+' date '+e,TP.TRACE);}return TP.boot.$uriLoadCommonHttp(a,b,e,f,g);}else{if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('No modified date for '+d,TP.TRACE);}}}break;default:break;}}if(a.toLowerCase().indexOf('file')===0){if(TP.boot.isUA('IE')){c=TP.boot.$uriLoadIEFile(a,b);}else if(TP.sys.cfg('boot.moz_xpcom')){c=TP.boot.$uriLoadMozFile(a,b);}else{c=TP.boot.$uriLoadCommonFile(a,b);}}else{c=TP.boot.$uriLoadCommonHttp(a,b,null,TP.sys.cfg('boot.localcache')&&f===true,g);}return c;};TP.boot.$uriLoadCommonFile=function(c,a){var b;a=TP.boot.$uriResultType(c,a);b=TP.boot.$httpCreate();if(TP.boot.isUA('GECKO')&&a!==TP.DOM){b.overrideMimeType('text/plain');}try{b.open(TP.HTTP_GET,c,false);b.send(null);}catch(b){if(TP.boot.isUA('GECKO',1,9,0,TP.UP)){TP.boot.$stdout('Switching to XPCOM for file load operations',TP.boot.$ec(b),TP.WARN);TP.sys.setcfg('boot.moz_xpcom',true);return TP.boot.$uriLoadMozFile(c,a);}return null;}return TP.boot.$uriResult(b.responseText,a);};TP.boot.$uriLoadIEFile=function(d,b){var a,c;b=TP.boot.$uriResultType(d,b);if(b===TP.DOM){a=TP.boot.$documentCreate();a.load(d);if(a.xml==null||a.xml===''){return;}return a;}else{c=TP.boot.$httpCreate();try{c.open(TP.HTTP_GET,d,false);c.send(null);}catch(a){return null;}return TP.boot.$uriResult(c.responseText,b);}return null;};TP.boot.$uriLoadMozFile=function(a,e){var h,f,g,b,c,i,d,j;e=TP.boot.$uriResultType(a,e);try{if(TP.sys.cfg('log.privilege_requests')){TP.boot.$stdout('Privilege request at TP.boot.$uriLoadMozFile',TP.WARN);}netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');}catch(b){TP.boot.$stderr('PrivilegeException: '+a,TP.boot.$ec(b));return;}try{h=new Components.Constructor('@mozilla.org/file/local;1','nsILocalFile','initWithPath');f=Components.classes['@mozilla.org/network/io-service;1'].getService(Components.interfaces.nsIIOService);g=new Components.Constructor('@mozilla.org/scriptableinputstream;1','nsIScriptableInputStream');}catch(b){TP.boot.$stderr('FileComponentError: '+a,TP.boot.$ec(b));return;}c=TP.boot.$uriMinusFileScheme(TP.boot.$uriInLocalFormat(a));c=unescape(c);try{b=new h(c);if(b.exists()){i=f.newChannelFromURI(f.newFileURI(b));d=new g();d.init(i.open());j=d.read(b.fileSize);d.close();return TP.boot.$uriResult(j,e);}}catch(b){TP.boot.$stderr('AccessViolation: '+a,TP.boot.$ec(b));return;}return null;};TP.boot.$uriLoadCommonHttp=function(a,d,e,r,q){var c,g,b,o,j,k,l,m,n,h,i,f,p;d=TP.boot.$uriResultType(a,d);if(TP.boot.isUA('IE')&&d===TP.DOM&&!e){g=TP.boot.$documentCreate();g.load(a);if(g.xml==null||g.xml===''){return;}return g;}try{if(e){j=[];j.push('If-Modified-Since',e);b=TP.boot.$httpCall(a,TP.HTTP_GET,j);}else{b=TP.boot.$httpCall(a,TP.HTTP_GET);}c=TP.boot.$uriInTIBETFormat(a);if(b.status===200){if(e){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Loaded '+c+' from origin.',TP.TRACE);}k=b.getResponseHeader('Last-Modified');if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Refreshed '+c+' to '+k,TP.TRACE);}TP.$BOOT_STORAGE.set(a+'_lastmodified',k,TP.NOOP);}if(e||r){if(/\.js$/.test(c)!==true||c.indexOf(TP.sys.cfg('pack.extension')+'.js')!==TP.NOT_FOUND){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Storing '+c+' to cache.',TP.TRACE);}l=b.responseText;TP.$BOOT_STORAGE.set(a,l,TP.NOOP);if(q&&TP.sys.cfg('import.chunks')){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Checking '+c+' for chunks.',TP.TRACE);}m=l.split(TP.sys.cfg('boot.uichunked'));n=m.length;if(n>1){p=/\/\/\t(.*)/;for(h=0;h<n;h++){i=m[h];if(!p.test(i)){continue;}f=i.match(/\/\/\t(.*)/)[1];if(f&&f!=='inline source'){if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Storing '+TP.boot.$uriInTIBETFormat(f)+' to cache.',TP.TRACE);}TP.$BOOT_STORAGE.set(f,i,TP.NOOP);}}}}}}return TP.boot.$uriResult(b.responseText,d);}else if(b.status===304){TP.$BOOT_STORAGE.get(a,function(b){if(TP.boot.$isValid(b)){o=TP.boot.$uriResult(b,d);TP.boot.$loadCached=true;if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Loaded '+c+' from cache.',TP.TRACE);}}else{if(TP.sys.cfg('debug.cache')){TP.boot.$stdout('Missing '+c+' in cache.',TP.TRACE);}TP.$BOOT_STORAGE.set(a+'_lastmodified',null,TP.NOOP);TP.$BOOT_STORAGE.set(a,null,TP.NOOP);}});if(TP.boot.$loadCached){return o;}}else if(b.status===0){if(/^chrome-extension/.test(a)&&b.responseText!=null){return TP.boot.$uriResult(b.responseText,d);}}}catch(b){TP.boot.$stderr('AccessException: '+a,TP.boot.$ec(b));}return null;};TP.boot.$uriResult=function(a,c){var b;if(a==null){return null;}if(c===TP.TEXT){return a;}b=TP.boot.$documentFromString(a);if(TP.boot.$isValid(b)&&b.childNodes.length>0){return b;}if(c!==TP.DOM){return a;}return null;};TP.boot.$uriResultType=function(a,b){if(/\.js$|\.css$|\.html$|\.txt$|\.json$/.test(a)){return TP.TEXT;}if(/\.xml$|\.xhtml$|\.tsh$|\.xsl$|\.xsd$/.test(a)){return TP.DOM;}return b;};TP.boot.$uriSave=function(d,b,c){var a;if(d==null){TP.boot.$stderr('InvalidURI');return false;}a=TP.boot.$uriWithRoot(d);if(a.toLowerCase().indexOf('file')===0){if(TP.boot.isUA('GECKO')){return TP.boot.$uriSaveMozFile(a,b,c);}else if(TP.boot.isUA('IE')){return TP.boot.$uriSaveIEFile(a,b,c);}else if(TP.boot.isUA('WEBKIT')){return TP.boot.$uriSaveWebkitFile(a,b,c);}}else{return TP.boot.$uriSaveHttp(a,b,c);}return null;};TP.boot.$uriSaveIEFile=function(g,f,d){var a,e,b,c;a=TP.boot.$uriMinusFileScheme(TP.boot.$uriInLocalFormat(g));if(d==null){d='w';}a=unescape(a);try{b=new ActiveXObject('Scripting.FileSystemObject');if(d==='w'){if(!b.FileExists(a)){b.CreateTextFile(a);}e=b.GetFile(a);c=e.OpenAsTextStream(2);c.Write(f);c.Close();return true;}else if(d==='a'){if(b.FileExists(a)){e=b.GetFile(a);c=e.OpenAsTextStream(8);c.Write(f);c.Close();return true;}else{TP.boot.$stderr('NotFound: '+a);}}else{TP.boot.$stderr('InvalidFileMode: '+d);}}catch(b){TP.boot.$stderr('AccessException: '+a,TP.boot.$ec(b));}return false;};TP.boot.$uriSaveMozFile=function(g,d,c){var i,e,b,f,h,a;if(c==null){c='w';}try{if(TP.sys.cfg('log.privilege_requests')){TP.boot.$stdout('Privilege request at TP.boot.$uriSaveMozFile',TP.WARN);}netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');}catch(a){TP.boot.$stderr('PrivilegeException: '+g,TP.boot.$ec(a));return false;}try{i=new Components.Constructor('@mozilla.org/file/local;1','nsILocalFile','initWithPath');a=Components.classes['@mozilla.org/network/file-output-stream;1'].createInstance(Components.interfaces.nsIFileOutputStream);}catch(a){TP.boot.$stderr('FileComponentError: '+g,TP.boot.$ec(a));return false;}b=TP.boot.$uriMinusFileScheme(TP.boot.$uriInLocalFormat(g));b=unescape(b);try{h=420;e=new i(b);if(c==='w'){f=TP.MOZ_FILE_CREATE|TP.MOZ_FILE_TRUNCATE|TP.MOZ_FILE_WRONLY;a.init(e,f,h,null);a.write(d,d.length);a.flush();a.close();return true;}else if(c==='a'){f=TP.MOZ_FILE_APPEND|TP.MOZ_FILE_SYNC|TP.MOZ_FILE_RDWR;if(e.exists()){a.init(e,f,h,null);a.write(d,d.length);a.flush();a.close();return true;}else{TP.boot.$stderr('NotFound: '+b);}}else{TP.boot.$stderr('InvalidFileMode: '+c);}}catch(a){TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(a));}return false;};TP.boot.$uriSaveWebkitFile=function(a,b,c){TP.boot.$stderr('UnsupportedFeature: TP.boot.$uriSaveWebkitFile()');return false;};TP.boot.$uriSaveHttp=function(b,d,f){var c,e,a;try{c=TP.boot.$uriExpandPath(b);a=TP.boot.$httpCall(c,TP.HTTP_PUT,['Content-Type','text/plain'],d);if(a.status===200){return true;}else{TP.boot.$stderr('HTTPError: '+a.status+' url: '+e);}}catch(a){TP.boot.$stderr('AccessException: '+b,TP.boot.$ec(a));}return false;};TP.boot.$documentCreate=function(a){if(TP.boot.isUA('IE')){return TP.boot.$documentCreateIE(a);}else{return document.implementation.createDocument('','',null);}return null;};TP.boot.$documentCreateIE=function(c){var a,d,e,b;if(c!=null&&typeof c==='number'){switch(c){case 2:a=new ActiveXObject('Msxml2.DOMDocument');break;case 3:a=new ActiveXObject('Msxml2.DOMDocument.3.0');break;case 6:a=new ActiveXObject('Msxml2.DOMDocument.6.0');break;default:a=new ActiveXObject('Msxml2.DOMDocument.3.0');break;}}else{d=['Msxml2.DOMDocument.6.0','Msxml2.DOMDocument.3.0','Msxml2.DOMDocument'];e=d.length;for(b=0;b<e;b++){try{a=new ActiveXObject(d[b]);break;}catch(a){}}}a.resolveExternals=false;a.validateOnParse=false;a.async=false;a.setProperty('SelectionLanguage','XPath');a.setProperty('ProhibitDTD',false);return a;};TP.boot.$documentGetElementById=function(a,b){return a.evaluate('//*[@id="'+b+'"]',a,function(){return'http://www.w3.org/XML/1998/namespace';},XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;};TP.boot.$nodeAppendChild=function(a,b,e){var d,c;try{$STATUS=0;if(TP.boot.isUA('IE')){a.appendChild(b);c=b;}else{if(a.nodeType===Node.DOCUMENT_NODE){d=a;}else{d=a.ownerDocument;}if(d!==b.ownerDocument){c=d.importNode(b,true);}else{c=b;}a.appendChild(c);}}catch(a){}finally{if($STATUS!==0){if(e){throw new Error('DOMAppendException');}}}return c;};TP.boot.$nodeInsertBefore=function(a,b,e){var c,d;if(TP.boot.isUA('IE')){a.insertBefore(b,e);}else{if(a.nodeType===Node.DOCUMENT_NODE){c=a;}else{c=a.ownerDocument;}if(c!==b.ownerDocument){d=c.importNode(b,true);}else{d=b;}a.insertBefore(d,e);}return d;};TP.boot.$nodeReplaceChild=function(a,b,e){var c,d;if(TP.boot.isUA('IE')){a.replaceChild(b,e);}else{if(a.nodeType===Node.DOCUMENT_NODE){c=a;}else{c=a.ownerDocument;}if(c!==b.ownerDocument){d=c.importNode(b,true);}else{d=b;}a.replaceChild(d,e);}return d;};TP.boot.$documentFromString=function(a){if(TP.boot.isUA('IE')){return TP.boot.$documentFromStringIE(a);}else{return TP.boot.$documentFromStringCommon(a);}return;};if(TP.boot.isUA('GECKO')){TP.boot.$$xmlParseErrorMsgMatcher=/XML Parsing Error: ([^\n]+)\nLocation: [^\n]+\nLine Number (\d+), Column (\d+)/;}else if(TP.boot.isUA('WEBKIT')){TP.boot.$$xmlParseErrorMsgMatcher=/error on line (\d+) at column (\d+): ([^<]+)/;}TP.boot.$documentFromStringCommon=function(d){var b,a,c,e;b=new DOMParser();a=b.parseFromString(d,'application/xml');if(TP.boot.$isValid(c=a.getElementsByTagName('parsererror')[0])){e=TP.boot.$$xmlParseErrorMsgMatcher.exec(c.firstChild.nodeValue);return null;}return a;};TP.boot.$documentFromStringIE=function(e,b){var a,c,f,d;a=TP.boot.$documentCreate();d=b==null?false:b;a.setProperty('ProhibitDTD',d);c=a.loadXML(e);if(c===false){f=a.parseError;return null;}return a;};TP.boot.$nodeAsString=function(a){if(TP.boot.isUA('IE')){return TP.boot.$nodeAsStringIE(a);}else{return TP.boot.$nodeAsStringCommon(a);}return'';};TP.boot.$nodeAsStringCommon=function(a){var b;if(a==null){return'';}try{b=new XMLSerializer().serializeToString(a);return b;}catch(a){return'';}};TP.boot.$nodeAsStringIE=function(a){if(a!=null&&a.xml!=null){return a.xml;}return'';};TP.boot.$currentDocumentLocation=function(){var a,b;a=decodeURI(window.location.toString());a=a.split(/[#?]/)[0];b=a.lastIndexOf('/');if(b!==TP.NOT_FOUND){return a.slice(0,b);}else{return a;}};TP.sys.getWindowById=function(d,m){var b,k,i,c,j,l,h,e,g,f,a;if(!d){return;}a=m||window;switch(d){case'top':return a.top;case'uiroot':case'UIROOT':i=a.document.getElementById(d);if(TP.boot.$isValid(i)&&TP.boot.$isValid(i.contentWindow)){return i.contentWindow;}return;case'uicanvas':case'UICANVAS':if(typeof TP.sys.getUICanvas==='function'){return TP.sys.getUICanvas(true);}return;case'parent':return parent;case'opener':return a.opener;case'self':case'window':return a;default:break;}if(typeof d!=='string'){if(TP.boot.$isWindow(d)){return d;}return;}if(TP.SCREEN_PREFIX_REGEX.test(d)===true){if(TP.boot.$isWindow(c=TP.global[top.name+'.UIROOT.'+d])){return c;}}if(TP.WINDOW_PREFIX_REGEX.test(d)===true){if(TP.boot.$isWindow(c=TP.global[d])){return c;}}if(d.indexOf('tibet:')===0){if(TP.boot.$isValid(k=d.match(TP.TIBET_URI_SPLITTER))){if(k[4]!=null&&k[4]!==''){return;}b=k[3]||'uicanvas';if(b.toLowerCase()==='uicanvas'){if(typeof TP.sys.getUICanvas==='function'){return TP.sys.getUICanvas();}return;}if(b.toLowerCase()==='uiroot'){if(typeof TP.sys.getUIRoot==='function'){return TP.sys.getUIRoot();}return;}}else{return;}}else{b=d;}b=b.replace(/\//g,'.');if(TP.BAD_WINDOW_ID_REGEX.test(b)){return;}if(/\./.test(b)!==true){if(a.name===b){return a;}if(a.parent.name===b){return a.parent;}if(top.name===b){return top;}if(TP.boot.$isWindow(c=a[b])){return c;}if(TP.boot.$isWindow(c=a.parent[b])){return c;}if(TP.boot.$isWindow(c=a.top[b])){return c;}if(a.opener!=null){if(a.opener.name===b){return a.opener;}if(TP.boot.$isWindow(c=a.opener[b])){return c;}}if((c=a.document.getElementById(b))!=null){try{return c.contentWindow;}catch(a){}}return;}j=b.split('.');l=j.length;e=a;for(h=0;h<l;h++){g=e[j[h]];if(!TP.boot.$isWindow(g)){g=TP.sys.getWindowById(j[h],e);if(g){e=g;if(!TP.boot.$isWindow(e)){break;}}else{e=null;break;}}else{e=g;}}if(TP.boot.$isWindow(e)){return e;}f=a.opener;if(f!=null&&f!==a&&typeof TP.windowIsInstrumented==='function'){if(!TP.windowIsInstrumented(f)){f.TP.sys=TP.sys;}return f.TP.sys.getWindowById(d);}return;};TP.windowIsInstrumented=function(a){if(a==null){return window.$$instrumented===true;}if(typeof a.location==='undefined'){return false;}if(a.$$instrumented===true){return true;}return false;};TP.boot.$elementAddClass=function(a,b){var c;if(TP.boot.$notValid(a)){return;}if(TP.boot.$elementHasClass(a,b)){return a;}c=a.className;if(!c){a.className=b;}else{a.className=c+' '+b;}return a;};TP.boot.$elementHasClass=function(a,d){var b,c;if(TP.boot.$notValid(a)){return;}b=new RegExp('(^|\\s)'+d+'(\\s|$)');c=a.className;return b.test(c);};TP.boot.$elementReplaceClass=function(a,d,e){var c,f,b;if(TP.boot.$notValid(a)){return;}if(typeof d==='string'){c=new RegExp('(^|\\s)'+d+'(\\s|$)');}else{c=d;}f=a.className;if(!c.test(f)){return TP.boot.$elementAddClass(a,e);}b=f.split(' ');b=b.filter(function(a){return!c.test(a)&&a!==e;});b.push(e);a.className=b.join(' ');return a;};TP.boot.$elementSetInnerContent=function(a,b){if(a&&a.ownerDocument){a.innerHTML=b;}return;};TP.boot.$dump=function(a,i,d,k){var b,c,e,f,g,j,h,l;switch(typeof a){case'string':if(/<!DOCTYPE html><html/.test(a)){b=a.replace(/\n/g,'__NEWLINE__');b=b.replace(/<!DOCTYPE html><html(.*)?<\/html>/g,'<html>...</html>');b=b.replace(/'__NEWLINE__'/g,'\n');}else{b=a;}if(d===true){return TP.boot.$htmlEscape(b);}else{return b;}break;case'function':case'number':case'boolean':return a;default:if(a===null){return'null';}if(a===undefined){return'undefined';}if(a instanceof Date){return a.toISOString();}if(a instanceof RegExp){return a.toString();}if(TP.boot.$isValid(a.nodeType)){return TP.boot.$htmlEscape(TP.boot.$nodeAsString(a));}break;}if(k&&k>0){try{return''+a;}catch(b){return Object.prototype.toString.call(a);}}h=' => ';if(d===true){h=TP.boot.$htmlEscape(h);}e=[];if(a instanceof Array){f=a.length;for(c=0;c<f;c++){e.push(TP.boot.$dump(a[c],i,d,1));}}else{try{g=Object.keys(a);}catch(b){return Object.prototype.toString.call(a);}g.sort();f=g.length;for(c=0;c<f;c++){j=g[c];l=a[j];b=TP.boot.$dump(l,i,d,1);e.push(j+h+b);}}return e.join(i||'\n');};TP.boot.$htmlEscape=function(b){var a;a=b.replace(/[<>'"]/g,function(a){switch(a){case'<':return'&lt;';case'>':return'&gt;';case'\'':return'&apos;';case'"':return'&quot;';default:break;}});a=a.replace(/&(?!([a-zA-Z]+|#[0-9]+);)/g,'&amp;');return a;};TP.boot.$join=function(d){var b,c,a;b='';c=arguments.length;for(a=0;a<c;a++){if(TP.boot.$isValid(arguments[a])){b+=arguments[a];}}return b;};TP.boot.$lpad=function(c,d,e){var a,b;a=''+c;b=e||' ';while(a.length<d){a=b+a;}return a;};TP.boot.$quoted=function(a){return'\''+a.replace(/'/g,'\\\'')+'\'';};TP.boot.$rpad=function(c,d,e){var a,b;a=''+c;b=e||' ';while(a.length<d){a=a+b;}return a;};TP.boot.$str=function(a,b){if(a!==null){if(a===undefined){return'undefined';}try{if(typeof a.message==='string'){return a.message;}else{return TP.boot.$dump(a,b||', ');}}catch(a){return'';}}return'null';};TP.boot.$trim=function(c){var a,d,b;if(c==null){return;}a=c.toString();a=a.replace(/^\s\s*/,'');d=/\s/;b=a.length;while(d.test(a.charAt(--b))){}return a.slice(0,b+1);};TP.boot.Annotation=function(b,a){if(b==null||a==null||a===''){throw new Error('InvalidParameter');}this.object=b;this.message=a;};TP.boot.Annotation.prototype.as=function(c,d){var a,b;if(TP.boot.$notValid(a=TP.sys.require(c))){return c.transform(this,d);}if(TP.canInvoke(a,'from')){switch(arguments.length){case 1:return a.from(this);case 2:return a.from(this,d);default:b=TP.args(arguments);b.atPut(0,this);return a.from.apply(a,b);}}};TP.boot.Annotation.prototype.getTypeName=function(){return'TP.boot.Annotation';};TP.boot.Annotation.prototype.getSupertypes=function(){return[Object];};TP.boot.Annotation.prototype.asDumpString=function(){return TP.boot.$join('TP.boot.Annotation :: ',TP.boot.$str(this.object),',',TP.boot.$str(this.message));};TP.boot.Annotation.prototype.asHTMLString=function(){return TP.boot.$join('<span class="TP_boot_Annotation">','<span data-name="object">',TP.htmlstr(this.object),'</span>','<span data-name="message">',TP.htmlstr(this.message),'</span>','</span>');};TP.boot.Annotation.prototype.asJSONSource=function(){return'{"type":"TP.boot.Annotation",'+'"data":{"object":'+TP.boot.$str(this.object).quoted('"')+','+'"message":'+TP.boot.$str(this.message).quoted('"')+'}}';};TP.boot.Annotation.prototype.asPrettyString=function(){return'<dl class="pretty TP_boot_Annotation">'+'<dt>Type name</dt>'+'<dd class="pretty typename">'+'TP.boot.Annotation'+'</dd>'+'<dt class="pretty key">object</dt>'+'<dd class="pretty value">'+TP.boot.$str(this.object)+'</dd>'+'<dt class="pretty key">message</dt>'+'<dd class="pretty value">'+TP.boot.$str(this.message)+'</dd>'+'</dl>';};TP.boot.Annotation.prototype.asSource=function(){return TP.boot.$join('TP.boot.$annotate(\'',TP.boot.$str(this.object),'\',\'',TP.boot.$str(this.message),'\')');};TP.boot.Annotation.prototype.asXMLString=function(){return TP.boot.$join('<instance type="TP.boot.Annotation"',' object="',TP.boot.$str(this.object),'"',' message="',TP.boot.$str(this.message),'"/>');};TP.boot.Annotation.prototype.toString=function(){return TP.boot.$join(TP.boot.$str(this.message),' [',TP.boot.$str(this.object),']');};TP.boot.$annotate=function(a,b){if(a instanceof TP.boot.Annotation){return a;}if(TP.boot.$notValid(a)){TP.boot.$stderr('InvalidAnnotation: no object to annotate.');return;}return new TP.boot.Annotation(a,b||a.message||'');};TP.boot.$ec=function(a,b){return TP.boot.$annotate(a,b);};TP.boot.$flushLog=function(a){TP.boot.$flushUIBuffer(a);if(a===true){TP.boot.$scrollUIBuffer();}};TP.boot.$scrollLog=function(){TP.boot.$scrollUIBuffer();};TP.boot.$clearLog=function(){TP.boot.$clearUIBuffer();};TP.boot.$$logReporter=function(g,q,l,m){var e,b,i,j,a,f,h,d,c,o,k,p,n;if(!g){return;}e=g[TP.LOG_ENTRY_LEVEL];if(e>TP.boot.$$logpeak&&e<TP.SYSTEM){TP.boot.$$logpeak=e;}if(!TP.boot.Log.canLogLevel(e)){return;}j=g[TP.LOG_ENTRY_DATE];a=g[TP.LOG_ENTRY_PAYLOAD];f=g[TP.LOG_ENTRY_CONTEXT];i=TP.boot.$isValid(m)?m:true;b=TP.boot.$isValid(l)?l:'\n';if(a instanceof TP.boot.Annotation){c=b+TP.boot.$dump(a.message,b,i)+b+b+TP.boot.$dump(a.object,b,i)+b;}else if(typeof a!=='string'){if(TP.sys.hasKernel()){if(TP.isKindOf(a,TP.sig.Exception)){c=TP.dump(a);k=a.getError();if(k&&k.stack){c+='\n'+k.stack;}}else{c=TP.dump(a);}}c=c||b+b+TP.boot.$dump(a,b,i)+b;}else{c=i?TP.boot.$htmlEscape(a):a;}o=TP.boot.Log.isErrorLevel(e);if(o&&f&&f.callee){if(typeof f.callee.getName==='function'){c+=' @ '+f.callee.getName();}else if(TP.boot.$isValid(f.callee.displayName)){c+=' @ '+f.callee.displayName;}}j=(''+j.getTime()).slice(-6);d='';h=TP.boot.Log.getStringForLevel(e)||'';h=h.toLowerCase();if(TP.boot.$$loglevel===TP.TRACE){d=g[TP.LOG_ENTRY_DELTA];n=TP.sys.cfg('boot.delta_threshold');if(d>n){TP.boot.$$bottlenecks+=1;d=TP.boot.$style('[+'+d+'] ','slow');}else{d=TP.boot.$style('[+'+d+'] ','delta');}}p=TP.boot.$style(j,'time')+' '+d+'- '+TP.boot.$style(h+' '+c,h);return p;};TP.boot.$consoleReporter=function(b,d){var a,c;if(b&&b.usedConsole){return;}TP.sys.setcfg('log.colormode','console');a=TP.boot.$$logReporter(b,d,'\n',false);if(TP.boot.$notValid(a)){return;}c=b[TP.LOG_ENTRY_LEVEL];switch(c){case TP.TRACE:top.console.log(a);break;case TP.INFO:top.console.log(a);break;case TP.WARN:top.console.warn(a);break;case TP.ERROR:top.console.error(a);break;case TP.SEVERE:top.console.error(a);break;case TP.FATAL:top.console.error(a);break;case TP.SYSTEM:top.console.log(a);break;default:top.console.log(a);break;}b.usedConsole=true;};TP.boot.$bootuiReporter=function(d,f){var b,a,c,e;if(!TP.boot.$consoleConfigured){b=TP.boot.$getBootLogElement();if(!TP.boot.$isElement(b)){return;}b.innerHTML='';TP.boot.$consoleConfigured=true;}TP.sys.setcfg('log.colormode','browser');a=TP.boot.$$logReporter(d,f,'<br/>',true);if(TP.boot.$notValid(a)){return;}c='log-'+TP.boot.Log.getStringForLevel(TP.boot.$$logpeak).toLowerCase();if(TP.boot.$$logcss!==c){TP.boot.$$logcss=c;TP.boot.$elementReplaceClass(TP.boot.$getProgressBarElement(),/log-/,TP.boot.$$logcss);}e=d[TP.LOG_ENTRY_LEVEL];switch(e){case TP.TRACE:TP.boot.$displayMessage(a);break;case TP.INFO:TP.boot.$displayMessage(a);break;case TP.WARN:TP.boot.$displayMessage(a);break;case TP.ERROR:TP.boot.$displayMessage(a,true);break;case TP.SEVERE:TP.boot.$displayMessage(a,true);break;case TP.FATAL:TP.boot.$displayMessage(a,true);break;case TP.SYSTEM:TP.boot.$displayMessage(a,true);break;default:TP.boot.$displayMessage(a);break;}try{if(TP.boot.shouldStop()){b=TP.boot.$getBootLogElement();if(TP.boot.$isElement(b)){TP.boot.$elementAddClass(b.parentElement,'done');}}}catch(a){}};TP.boot.$phantomReporter=function(b,d){var a,c;if(b&&b.usedConsole){return;}TP.sys.setcfg('log.colormode','console');a=TP.boot.$$logReporter(b,d,'\n',false);if(TP.boot.$notValid(a)){return;}c=b[TP.LOG_ENTRY_LEVEL];switch(c){case TP.TRACE:top.console.log(a);break;case TP.INFO:top.console.log(a);break;case TP.WARN:top.console.warn(a);break;case TP.ERROR:top.console.error(a);break;case TP.SEVERE:top.console.error(a);break;case TP.FATAL:top.console.error(a);break;case TP.SYSTEM:break;default:top.console.log(a);break;}b.usedConsole=true;};TP.boot.$TAPReporter=function(a,b){};TP.boot.$silentReporter=function(a,b){return;};TP.boot.$style=function(c,e){var g,f,h,b,a,d;g=TP.boot.$$colormode=TP.boot.$$colormode||TP.sys.cfg('log.colormode');f=TP.boot.$$styles[g];try{if(TP.boot.$$PROP_KEY_REGEX.test(e)){d='';h=e.split('.');h.forEach(function(e){b=TP.boot.$$theme[e];if(TP.boot.$notValid(b)){return;}a=f[b];if(TP.boot.$notValid(a)){return;}d=a[0]+(d||c)+a[1];});}else{b=TP.boot.$$theme[e];if(TP.boot.$notValid(b)){return c;}a=f[b];if(TP.boot.$notValid(a)){return c;}d=a[0]+c+a[1];}}catch(a){return c;}return d;};TP.boot.Log=function(){this.messages=[];this.index=0;return this;};TP.boot.Log.canLogLevel=function(a){var b;b=TP.boot.$isValid(a)?a:TP.WARN;return TP.boot.$$loglevel<=b;};TP.boot.Log.getStringForLevel=function(a){switch(a){case TP.TRACE:return'TRACE';case TP.INFO:return'INFO';case TP.WARN:return'WARN';case TP.ERROR:return'ERROR';case TP.SEVERE:return'SEVERE';case TP.FATAL:return'FATAL';case TP.SYSTEM:return'SYSTEM';default:return'SYSTEM';}};TP.boot.Log.isErrorLevel=function(a){if(TP.boot.$notValid(a)){return false;}return a>=TP.ERROR&&a<TP.SYSTEM;};TP.boot.Log.isFatalCondition=function(a,c){var b;if(!TP.boot.Log.isErrorLevel(a)){return false;}if(a===TP.FATAL){TP.boot.$$stop='fatal error detected.';return true;}if(TP.boot.$notValid(a)){return false;}if(TP.boot.$$errors>TP.sys.cfg('boot.error_max')){TP.boot.$$stop='boot.error_max exceeded.';return true;}b=TP.boot.$getStageInfo(c);if(TP.boot.$isValid(b)&&b.fatal){if(TP.sys.cfg('boot.fatalistic')){TP.boot.$$stop='error in fatalistic stage.';return true;}}return false;};TP.boot.Log.prototype.asDumpString=function(){return TP.boot.$join('TP.boot.Log :: ',this.asString());};TP.boot.Log.prototype.asHTMLString=function(){return TP.boot.$join('<span class="TP_boot_Log">','<span data-name="messages">',TP.htmlstr(this.messages),'</span>','</span>');};TP.boot.Log.prototype.asJSONSource=function(){return'{"type":"TP.boot.Log",'+'"data":{"messages":'+TP.boot.$str(this.messages).quoted('"')+'}}';};TP.boot.Log.prototype.asPrettyString=function(){return'<dl class="pretty TP_boot_Log">'+'<dt>Type name</dt>'+'<dd class="pretty typename">'+'TP.boot.Log'+'</dd>'+'<dt class="pretty key">messages</dt>'+'<dd class="pretty value">'+TP.boot.$str(this.messages)+'</dd>'+'</dl>';};TP.boot.Log.prototype.asXMLString=function(){return TP.boot.$join('<instance type="TP.boot.Log">','<messages>',TP.xmlstr(this.messages),'</messages>','</instance>');};TP.boot.Log.prototype.flush=function(){while(this.index<this.messages.length){this.report(this.messages[this.index]);}};TP.boot.Log.prototype.getEntries=function(){return this.messages;};TP.boot.Log.prototype.getSize=function(){return this.messages.length;};TP.boot.Log.prototype.getTypeName=function(){return'TP.boot.Log';};TP.boot.Log.prototype.getSupertypes=function(){return[Object];};TP.boot.Log.prototype.last=function(){return this.messages[this.messages.length-1];};TP.boot.Log.prototype.log=function(f,g,a,h){var d,b,c,e;b=new Date();c=0;if(TP.boot.$$loglevel===TP.TRACE){if(this.messages.length>1){c=b.getTime()-this.messages[this.messages.length-1][0].getTime();}}d=[b,g,a,f,h,c];this.messages.push(d);if(TP.boot.Log.isErrorLevel(a)){TP.boot.$$errors+=1;}if(a===TP.WARN){TP.boot.$$warnings+=1;}if(TP.boot.Log.isFatalCondition(a)){this.flush();TP.boot.$flushLog(true);if(TP.boot.$isEmpty(TP.boot.$$stop)){TP.boot.$$stop='unspecified fatal condition';}e=TP.boot.$$stop;setTimeout(function(){try{TP.boot.$setStage('stopped','Boot terminated: '+e);}catch(a){}},0);}if(TP.boot.$hasReachedStage('expanding')){this.flush();}return this;};TP.boot.Log.prototype.report=function(a){var e,c,b,d;this.index=this.index+1;e=TP.sys.cfg('log.console_threshold');c=a[TP.LOG_ENTRY_LEVEL];if(TP.boot.Log.isErrorLevel(c)&&c>=e){TP.boot.$consoleReporter(a);}b=TP.sys.cfg('log.reporter');b='$'+b+'Reporter';d=TP.boot[b];if(TP.boot.$notValid(d)){TP.boot.$consoleReporter([new Date(),TP.BOOT_LOG,TP.WARN,'Boot log reporter \''+d+'\' not found.',arguments]);TP.boot.$consoleReporter(a);}try{TP.boot[b](a);}catch(c){if(window.location.protocol.indexOf('file')===0){if(/[sS]ecurity|[bB]locked/.test(c.message)){TP.boot.$consoleReporter(a);return;}}TP.boot.$$errors+=1;TP.boot.$consoleReporter([new Date(),TP.BOOT_LOG,TP.ERROR,'Error in reporter \''+b+'\': '+c.message,arguments]);TP.boot.$consoleReporter(a);}};TP.boot.Log.prototype.shift=function(){return this.messages.shift();};if(TP.sys.$bootlog==null){TP.sys.$bootlog=new TP.boot.Log();}TP.sys.getBootLog=function(){return TP.sys.$bootlog;};TP.boot.log=function(c,a,d){var b;b=a==null?TP.INFO:a;TP.sys.$bootlog.log(c,TP.BOOT_LOG,b,d||arguments);return;};TP.boot.$consoleConfigured=false;TP.boot.$getBootElement=function(e,a){var c,d,b;b=TP.boot[a];if(TP.boot.$isValid(b)){return TP.boot[a];}c=TP.sys.cfg('boot.uiboot');d=TP.sys.cfg('boot.'+e);b=TP.boot.$getUIElement(c,d);if(TP.boot.$notValid(b)){TP.boot[a]=TP.NOT_FOUND;return;}TP.boot[a]=b;return TP.boot[a];};TP.boot.$getBootHeadElement=function(){return TP.boot.$getBootElement('uihead','$$uiHead');};TP.boot.$getBootImageElement=function(){return TP.boot.$getBootElement('uiimage','$$uiImage');};TP.boot.$getBootInputElement=function(){return TP.boot.$getBootElement('uiinput','$$uiInput');};TP.boot.$getBootLogElement=function(){return TP.boot.$getBootElement('uilog','$$uiLog');};TP.boot.$getProgressBarElement=function(){return TP.boot.$getBootElement('uipercent','$$uiProgress');};TP.boot.$getBootSubheadElement=function(){return TP.boot.$getBootElement('uisubhead','$$uiSubhead');};TP.boot.$getUIElement=function(g){var b,a,c,f,e,d;e=document;b=[];c=arguments.length;for(a=0;a<c;a++){b=b.concat(arguments[a].split('.'));}c=b.length;for(a=0;a<c;a++){f=b[a];d=e.getElementById(f);if(!d){return;}if(a===c-1){return d;}if(d.contentWindow){e=d.contentWindow.document;}else{return;}}};TP.boot.getUIBoot=function(){var a;a=TP.sys.cfg('boot.uiboot');return TP.boot.$getUIElement(a);};TP.boot.getUIRoot=function(){var a;a=TP.sys.cfg('tibet.uiroot');return TP.boot.$getUIElement(a);};TP.boot.$releaseUIElements=function(){TP.boot.$$uiHead=null;TP.boot.$$uiImage=null;TP.boot.$$uiInput=null;TP.boot.$$uiLog=null;TP.boot.$$uiPath=null;TP.boot.$$uiProgress=null;return;};TP.boot.$computeLogBufferSize=function(c){var b,a;a=TP.boot.$$logbufsize;if(c!==true&&TP.boot.$isValid(a)){return a;}a=parseInt(TP.sys.cfg('log.buffersize'));a=isNaN(a)?1:a;b=TP.boot.$$loglevel;switch(b){case 0:a=a*2;break;case 1:case 2:case 3:case 4:a=Math.max(Math.floor(a/2),a);break;case 5:case 6:a=1;break;default:a=1;break;}TP.boot.$$logbufsize=a;return a;};TP.boot.$flushUIBuffer=function(d){var b,a,c;b=TP.boot.$getBootLogElement();if(!TP.boot.$isElement(b)){return;}a=TP.boot.$$msgBuffer;if(TP.boot.$notValid(a)){TP.boot.$$msgBuffer=a=b.ownerDocument.createDocumentFragment();}c=TP.boot.$$logbufsize||TP.boot.$computeLogBufferSize();if(a.childNodes.length>0&&(d===true||a.childNodes.length===c)){TP.boot.$nodeAppendChild(b,a);TP.boot.$$msgBuffer=a=b.ownerDocument.createDocumentFragment();}return a;};TP.boot.$clearUIBuffer=function(){var a;a=TP.boot.$getBootLogElement();if(!TP.boot.$isElement(a)){return;}a.innerHTML='';return;};TP.boot.$scrollUIBuffer=function(){var a;a=TP.boot.$getBootLogElement();if(!TP.boot.$isElement(a)){return;}a.parentElement.scrollTop=a.parentElement.scrollHeight;return;};TP.boot.$displayImage=function(b){var a;a=TP.boot.$getBootImageElement();if(!TP.boot.$isElement(a)){return;}a.src=b;};TP.boot.$displayMessage=function(e,f){var c,d,b,a;c=TP.boot.$getBootLogElement();if(!TP.boot.$isElement(c)){return;}if(!TP.boot.$isElement(TP.boot.$$msgTemplate)){a=TP.boot.$documentFromString('<div xmlns="http://www.w3.org/1999/xhtml"><div></div></div>');if(!a){console.log('Unable to create log message template.');}TP.boot.$$msgTemplate=a.firstChild.firstChild;}b=e||'';a=TP.boot.$$msgTemplate.cloneNode(true);try{a.insertAdjacentHTML('beforeEnd',b);}catch(c){a=TP.boot.$documentFromString('<div xmlns="http://www.w3.org/1999/xhtml"><div><pre>'+b+'</pre></div></div>');if(!a){a=TP.boot.$documentFromString('<div xmlns="http://www.w3.org/1999/xhtml"><div><pre>'+TP.boot.$htmlEscape(b)+'</pre></div></div>');if(!a){console.log('Unable to create log message element.');}else{a=a.firstChild.firstChild;}}else{a=a.firstChild.firstChild;}}if(a){d=TP.boot.$flushUIBuffer(TP.boot.shouldStop());TP.boot.$nodeAppendChild(d,a);}if(f){TP.boot.$flushUIBuffer(true);TP.boot.$scrollUIBuffer();}};TP.boot.$displayProgress=function(){var a,c,b,e,d;a=TP.boot.$getProgressBarElement();if(!TP.boot.$isElement(a)){return;}if(TP.sys.cfg('log.reporter')!=='bootui'){return;}e=TP.boot.$getStage();if(!TP.boot.$$bootnodes){return;}else{c=TP.boot.$$workload;d=TP.boot.$$bootindex;b=Math.round(d/c*100);}if(b===TP.boot.$$percent){return;}TP.boot.$$percent=b;TP.boot.$elementReplaceClass(a,/log-/,TP.boot.$$logcss);if(b===100){a.style.width='auto';a.style.right=0;}else{a.style.width=b.toFixed()+'%';}return;};TP.boot.$displayStage=function(b){var a;a=TP.boot.$getBootHeadElement();if(!TP.boot.$isElement(a)){return;}a.innerHTML=b;};TP.boot.$displayStatus=function(b){var a;a=TP.boot.$getBootSubheadElement();if(!TP.boot.$isElement(a)){return;}a.innerHTML=b;};TP.boot.hideUIBoot=function(){var a,b;b=TP.sys.cfg('boot.uiboot');if(b===TP.sys.cfg('tibet.uiroot')){return;}a=TP.boot.$getUIElement(b);if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='hidden';}else{a.style.visibility='hidden';}}};TP.boot.hideUIRoot=function(){var a,b;b=TP.sys.cfg('tibet.uiroot');a=TP.boot.$getUIElement(b);if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='hidden';}else{a.style.visibility='hidden';}}};TP.sys.showBootLog=function(b,c){var d,e,a,f;a='$'+(b||'console')+'Reporter';e=TP.boot[a];if(TP.boot.$notValid(e)){TP.boot.$consoleReporter([new Date(),TP.BOOT_LOG,TP.WARN,'Boot log reporter \''+b+'\' not found.',arguments]);return;}d=TP.boot.$isValid(c)?c:TP.TRACE;f=TP.sys.getBootLog().getEntries();f.forEach(function(b){if(b[TP.LOG_ENTRY_LEVEL]<d){return;}TP.boot[a](b);});return;};TP.boot.showUIBoot=function(){var a,b;b=TP.sys.cfg('boot.uiboot');a=TP.boot.$getUIElement(b);if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='visible';}else{a.style.visibility='visible';}}};TP.boot.showUIRoot=function(){var a,b;b=TP.sys.cfg('tibet.uiroot');a=TP.boot.$getUIElement(b);if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='visible';}else{a.style.visibility='visible';}}TP.boot.hideUIBoot();return;};TP.boot.$getBootStats=function(){return''+TP.boot.$$totalwork+' imports, '+TP.boot.$$errors+' errors, '+TP.boot.$$warnings+' warnings, '+TP.boot.$$bottlenecks+' bottlenecks.';};TP.boot.$getStage=function(){return TP.boot.$$stage;};TP.boot.$getStageInfo=function(b){var a;a=b||TP.boot.$$stage;return TP.boot.$$stages[a];};TP.boot.$hasReachedStage=function(c){var a,b;a=TP.boot.$$stageorder.indexOf(c);b=TP.boot.$$stageorder.indexOf(TP.boot.$$stage);return a<=b;};TP.boot.$setStage=function(b,h){var a,d,e,i,f,g,c;if(TP.boot.$$stage==='stopped'){return;}a=TP.boot.$getStageInfo(b);if(TP.boot.$notValid(a)){TP.boot.$stderr('Invalid boot stage: '+b);return;}if(TP.boot.$$stageorder.indexOf(b)<TP.boot.$$stageorder.indexOf(TP.boot.$$stage)){return;}d=TP.boot.$$stage;TP.boot.$$stage=b;if(b!=='prelaunch'){i=TP.boot.$getStageTime(d);if(d==='paused'){TP.boot.$stdout('',TP.SYSTEM);e='Paused for ';}else{e='Completed in ';}TP.boot.$stdout(e+i+'ms',TP.SYSTEM);}TP.boot.$stdout('',TP.SYSTEM);TP.boot.$stdout(TP.sys.cfg('boot.uisubsection'),TP.SYSTEM);TP.boot.$stdout(a.log,TP.SYSTEM);TP.boot.$stdout(TP.sys.cfg('boot.uisubsection'),TP.SYSTEM);TP.boot.$stdout('',TP.SYSTEM);a.entered=new Date();f=a.head;if(TP.boot.$notEmpty(f)){TP.boot.$displayStage(f);}g=a.sub;if(TP.boot.$notEmpty(g)){TP.boot.$displayStatus(g);}c=a.image;if(TP.boot.$notEmpty(c)){if(c.charAt(0)==='~'){c=TP.boot.$uriExpandPath(c);}TP.boot.$displayImage(c);}if(typeof a.hook==='function'){a.hook(b,h);}if(TP.boot.$$stage==='liftoff'){TP.boot.$stdout('Launched in '+(TP.boot.$getStageTime('started','prelaunch')-TP.boot.$getStageTime('paused'))+'ms with '+TP.boot.$getBootStats(),TP.SYSTEM);TP.boot.$stdout('',TP.SYSTEM);TP.boot.$stdout(TP.sys.cfg('boot.uisection'),TP.SYSTEM);}else if(TP.boot.$$stage==='stopped'){TP.boot.$stdout(h,TP.SYSTEM);TP.boot.$stdout('',TP.SYSTEM);TP.boot.$stdout('Stopped after '+(TP.boot.$getStageTime('stopped','prelaunch')-TP.boot.$getStageTime('paused'))+'ms with '+TP.boot.$getBootStats(),TP.SYSTEM);TP.boot.$stdout('',TP.SYSTEM);TP.boot.$stdout(TP.sys.cfg('boot.uisection'),TP.SYSTEM);}TP.boot.$flushLog(true);return TP.boot.$$stage;};TP.boot.$getNextStage=function(c){var b,a;b=c||TP.boot.$$stage;a=TP.boot.$$stageorder.indexOf(b);if(a===TP.NOT_FOUND||a+1===TP.boot.$$stageorder.length){return;}return TP.boot.$$stageorder[a+1];};TP.boot.$getPriorStage=function(c){var b,a;b=c||TP.boot.$$stage;a=TP.boot.$$stageorder.indexOf(b);if(a===TP.NOT_FOUND||a===0){return;}return TP.boot.$$stageorder[a-1];};TP.boot.$getStageTime=function(i,j){var c,h,e,b,d,a,f,g;c=i||TP.boot.$$stage;h=TP.boot.$getNextStage(c);b=TP.boot.$getStageInfo(h);if(TP.boot.$notValid(b)){return 0;}else if(TP.boot.$notValid(b.entered)){d=new Date();}else{d=b.entered;}e=j||c;a=TP.boot.$getStageInfo(e);if(TP.boot.$notValid(a)){return 0;}else if(TP.boot.$notValid(a.entered)){return 0;}else{f=a.entered;}g=Math.abs(d.getTime()-f.getTime());return g;};TP.boot.$getArgumentPrimitive=function(a){if(TP.boot.$notValid(a)){return a;}if(TP.boot.NUMBER_REGEX.test(a)){return 1*a;}else if(TP.boot.BOOLEAN_REGEX.test(a)){return a==='true';}else if(TP.boot.REGEX_REGEX.test(a)){return new RegExp(a.slice(1,-1));}else if(TP.boot.OBJECT_REGEX.test(a)){try{JSON.parse(a);}catch(b){return a;}}else{return a;}};TP.boot.getURLArguments=function(b){var a,d,c;if(!/#/.test(b)){return{};}a=b.slice(b.indexOf('#')+1);a=decodeURIComponent(a);c={};d=a.split('&');d.forEach(function(e){var b,d,a;b=e.split('=');d=b[0];a=b[1];if(b.length>1){if(a.length>1&&(/^".*"$/.test(a)||/^'.*'$/.test(a))){a=a.slice(1,-1);}}else{d=e;a=true;}c[d]=TP.boot.$getArgumentPrimitive(a);});return c;};TP.boot.getURLBookmark=function(b){var a;if(!/#/.test(b)){return;}a=b.slice(b.indexOf('#'));if(/&/.test(a)){a=a.slice(0,a.indexOf('&'));}return a;};TP.boot.$getAppHead=function(){var a,d,b,e,f,c;if(TP.boot.$$apphead!=null){return TP.boot.$$apphead;}a=decodeURI(window.location.toString());a=a.split(/[#?]/)[0];e=[TP.sys.cfg('boot.tibetdir'),TP.sys.cfg('boot.tibetinf')];len=e.length;for(i=0;i<len;i++){f='/'+e[i]+'/';if(a.indexOf(f)!==-1){TP.boot.$$apphead=a.slice(0,a.indexOf(f));return TP.boot.$$apphead;}}c=TP.sys.cfg('boot.libtest')||TP.sys.cfg('boot.tibetlib');if(a.indexOf('/'+c+'/')!==-1){TP.boot.$$apphead=a.slice(0,a.indexOf('/'+c+'/')+c.length+1);return TP.boot.$$apphead;}d=TP.sys.getcfg('path.head_offset');if(TP.boot.$notEmpty(d)){TP.boot.$$apphead=TP.boot.$uriCollapsePath(TP.boot.$uriJoinPaths(a,d));return TP.boot.$$apphead;}b=a.split('/');if(b[b.length-1].match(/\./)){b.length=b.length-1;}a=b.join('/');TP.boot.$$apphead=a;return a;};TP.boot.$getAppRoot=function(){var a;if(TP.boot.$$approot!=null){return TP.boot.$$approot;}a=TP.sys.cfg('path.app_root');if(TP.boot.$notEmpty(a)){return TP.boot.$setAppRoot(a);}return TP.boot.$setAppRoot(TP.boot.$getAppHead());};TP.boot.$getLibRoot=function(){var j,a,l,h,f,e,b,c,k,g,d,i;if(TP.boot.$$libroot!=null){return TP.boot.$$libroot;}a=TP.sys.cfg('path.lib_root');if(TP.boot.$notEmpty(a)){return TP.boot.$setLibRoot(a);}h=decodeURI(window.location.toString());a=h.split(/[#?]/)[0];c=a.split('/');if(c[c.length-1].match(/\./)){c.length=c.length-1;}a=c.join('/');j=TP.sys.cfg('boot.libcomp');switch(j){case'apphead':return TP.boot.$setLibRoot(TP.boot.$getAppHead());case'approot':return TP.boot.$setLibRoot(TP.boot.$getAppRoot());case'frozen':b=TP.boot.$uriJoinPaths(TP.boot.$uriJoinPaths(a,TP.sys.cfg('boot.tibetinf')),TP.sys.cfg('boot.tibetlib'));return TP.boot.$setLibRoot(b);case'indexed':f=TP.sys.cfg('boot.libtest')||TP.sys.cfg('boot.tibetlib');if(TP.boot.$notEmpty(f)){e=a.lastIndexOf(f);if(e!==-1){e+=f.length+1;b=a.slice(0,e);return TP.boot.$setLibRoot(b);}}break;case'location':return TP.boot.$setLibRoot(a);case'tibetdir':b=TP.boot.$uriJoinPaths(TP.boot.$uriJoinPaths(a,TP.sys.cfg('boot.tibetdir')),TP.sys.cfg('boot.tibetlib'));return TP.boot.$setLibRoot(b);case'script':void 0;default:g=Array.prototype.slice.call(document.getElementsByTagName('script'),0);i=g.length;for(d=0;d<i;d++){if(/tibet_init/.test(g[d].src)){b=g[d].src;break;}}if(TP.boot.$notEmpty(b)){return TP.boot.$setLibRoot(TP.boot.$uriCollapsePath(TP.boot.$uriJoinPaths(TP.boot.$uriJoinPaths(a,b),TP.sys.cfg('boot.initoffset'))));}break;}if(TP.boot.$isValid(TP.boot.$$libroot)){return TP.boot.$$libroot;}TP.boot.shouldStop('unable to compute lib_root');TP.boot.$stderr('TP.boot.$getLibRoot() unable to find/compute libroot.',TP.FATAL);};TP.boot.$getRootPath=function(){var a,b;if(TP.boot.$$rootpath!=null){return TP.boot.$$rootpath;}a=TP.boot.$getLibRoot();if(a!=null){TP.boot.$$rootpath=a;}b=TP.sys.cfg('debug.path');if(b&&TP.boot.$$debug){TP.boot.$stdout('TP.boot.$getRootPath() computed rootpath: '+TP.boot.$$rootpath,TP.TRACE);}return a;};TP.boot.$setAppRoot=function(c){var a,b;a=TP.boot.$uriExpandPath(c);a=decodeURI(a);TP.boot.$$approot=a;TP.sys.setcfg('path.app_root',a);b=TP.sys.cfg('debug.path');if(b&&TP.boot.$$debug){TP.boot.$stdout('TP.boot.$setAppRoot() defined approot: '+a,TP.TRACE);}return TP.boot.$$approot;};TP.boot.$setLibRoot=function(c){var a,b;a=TP.boot.$uriExpandPath(c);a=decodeURI(a);TP.boot.$$libroot=a;TP.sys.setcfg('path.lib_root',a);b=TP.sys.cfg('debug.path');if(b&&TP.boot.$$debug){TP.boot.$stdout('TP.boot.$setLibRoot() defined libroot: '+a,TP.TRACE);}return TP.boot.$$libroot;};TP.boot.$configurePackage=function(){var b,a,e,c,d,f,g;b=TP.sys.cfg('boot.profile');if(TP.boot.$isEmpty(b)){TP.boot.$stdout('Empty boot.profile. Checking for boot.package.',TP.TRACE);a=TP.sys.cfg('boot.package');if(TP.boot.$isEmpty(a)){TP.boot.$stdout('Empty boot.package. Defaulting to standard.xml.',TP.TRACE);a='standard.xml';}else{TP.boot.$stdout('Found boot.package. Using: '+a,TP.TRACE);}}else{TP.boot.$stdout('Found boot.profile. Using: '+b,TP.TRACE);}if(TP.boot.$notEmpty(b)){if(/#/.test(b)){c=b.split('#');a=c[0];e=TP.sys.cfg('boot.config');if(e!==c[1]){if(TP.boot.$notEmpty(e)){TP.boot.$stdout('Overriding boot.config ('+e+') with profile#config: '+c[1],TP.WARN);}TP.sys.setcfg('boot.config',c[1]);}}else{a=b;}}if(/\.xml$/.test(a)!==true){a+='.xml';}if(!TP.boot.$uriIsAbsolute(a)){a=TP.boot.$uriJoinPaths('~app_cfg',a);}if(a!==TP.sys.cfg('boot.package')&&TP.boot.$notEmpty(TP.sys.cfg('boot.package'))){TP.boot.$stdout('Overriding boot.package ('+TP.sys.cfg('boot.package')+') with profile#config: '+a,TP.WARN);}d=TP.boot.$uriExpandPath(a);TP.boot.$stdout('Loading package: '+d,TP.TRACE);f=TP.boot.$uriLoad(d,TP.DOM,'manifest',false);if(f){TP.boot.$$bootxml=f;TP.boot.$$bootfile=d;}else{g='Boot package \''+a+'\' not found in: '+d,TP.boot.$stderr(g,TP.FATAL);throw new Error(g);}return f;};TP.boot.$configureBootstrap=function(){var a,b,d,c;if(TP.sys.cfg('boot.nobootstrap')){return;}a=TP.boot.$uriJoinPaths('~app',TP.sys.cfg('boot.bootstrap'));c=TP.boot.$uriInTIBETFormat(a);a=TP.boot.$uriExpandPath(a);try{TP.boot.$stdout('Loading bootstrap: '+c,TP.TRACE);b=TP.boot.$uriLoad(a,TP.TEXT,'source');if(!b){TP.boot.$stderr('Failed to load: '+a,TP.FATAL);}d=JSON.parse(b);}catch(a){TP.boot.$stderr('Failed to load: '+c,TP.boot.$ec(a),TP.FATAL);return;}TP.boot.$configureOptions(d);return;};TP.boot.$configureEnvironment=function(){TP.boot.$$setenv('tibet.userAgent',navigator.userAgent);TP.boot.$$setenv('tibet.platform',TP.$platform);TP.boot.$$setenv('tibet.'+TP.$platform,TP.$platform);if(TP.$platform.indexOf('win')===0){TP.boot.$$setenv('tibet.win','win');}if(TP.$platform.indexOf('mac')===0){TP.boot.$$setenv('tibet.mac','mac');}if(TP.$platform.indexOf('*nix')===0){TP.boot.$$setenv('tibet.*nix','*nix');}TP.boot.$$setenv('tibet.browser',TP.$browser);TP.boot.$$setenv('tibet.browserIdent',TP.$browserIdent);TP.boot.$$setenv('tibet.browserMajor',TP.$browserMajor);TP.boot.$$setenv('tibet.browserMinor',TP.$browserMinor);TP.boot.$$setenv('tibet.browserBuild',TP.$browserBuild);TP.boot.$$setenv('tibet.browserPatch',TP.$browserPatch);TP.boot.$$setenv('tibet.browserUI',TP.$browserUI);TP.boot.$$setenv('tibet.browserUIIdent',TP.$browserUIIdent);TP.boot.$$setenv('tibet.browserUIMajor',TP.$browserUIMajor);TP.boot.$$setenv('tibet.browserUIMinor',TP.$browserUIMinor);TP.boot.$$setenv('tibet.browserUIBuild',TP.$browserUIBuild);TP.boot.$$setenv('tibet.browserUIPatch',TP.$browserUIPatch);TP.boot.$$setenv('tibet.msxml',TP.$msxml);TP.boot.$$setenv('tibet.xmllang',TP.$language.toLowerCase());TP.boot.$$setenv('tibet.'+TP.$language.toLowerCase(),TP.$language.toLowerCase());TP.sys.setcfg('tibet.offline',!TP.sys.isHTTPBased());return;};TP.boot.$configureLocalCache=function(d){var b,c,a;if(!TP.sys.cfg('boot.localcache')){return;}TP.boot.$setupDOMStorage();if(TP.boot.$notValid(TP.$BOOT_STORAGE)){if(d!==false){a='Unable to configure storage, disabling local cache.';if(TP.sys.isHTTPBased()){TP.boot.$stderr(a);}else{TP.boot.$stdout(a,TP.WARN);}}TP.sys.setcfg('boot.localcache',false);return;}switch(TP.sys.cfg('boot.cachemode')){case'versioned':TP.boot.$stdout('Configuring \'versioned\' local cache.',TP.TRACE);b=TP.sys.cfg('project.name');c=TP.sys.cfg('project.version');TP.$BOOT_STORAGE.get(b+'_cache_version',function(a){TP.boot.$configureVersionedCache(a,c);});break;case'synchronized':TP.boot.$stdout('Configuring \'synchronized\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','modified');break;case'manual':TP.boot.$stdout('Configuring \'manual\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','marked');break;case'stale':TP.boot.$stdout('Configuring \'stale\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','remote');TP.$BOOT_STORAGE.removeAll(TP.NOOP);break;case'fresh':TP.boot.$stdout('Configuring \'fresh\' local cache.',TP.TRACE);TP.sys.setcfg('import.manifests',true);TP.sys.setcfg('import.metadata',true);TP.sys.setcfg('import.source','local');break;default:TP.boot.$stderr('Invalid local cache mode: '+TP.sys.cfg('boot.cachemode'),TP.ERROR);TP.boot.$stdout('Disabling local cache.',TP.WARN);TP.sys.setcfg('boot.localcache',false);break;}return;};TP.boot.$configureVersionedCache=function(c,d){var a,b;if(TP.boot.shouldStop()){return;}if(!c){TP.boot.$stdout('No local cache version string found.',TP.TRACE);TP.boot.$stdout('Simulating \'empty\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','remote');return;}if(!d){TP.boot.$stdout('No target version string found.',TP.TRACE);TP.boot.$stdout('Simulating \'manual\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','marked');return;}if(c===d){TP.boot.$stdout('Cache and target versions match.',TP.TRACE);TP.boot.$stdout('Simulating \'fresh\' local cache.',TP.TRACE);TP.sys.setcfg('import.manifests',true);TP.sys.setcfg('import.metadata',true);TP.sys.setcfg('import.source','local');return;}if(!TP.TIBET_VERSION_SPLITTER.test(d)){TP.boot.$stderr('Unrecognized target version format: '+d);TP.boot.$stdout('Simulating \'stale\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','remote');return;}if(!TP.TIBET_VERSION_SPLITTER.test(c)){TP.boot.$stderr('Unrecognized cache version format: '+c);TP.boot.$stdout('Simulating \'stale\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','remote');return;}b=TP.TIBET_VERSION_SPLITTER.match(c);a=TP.TIBET_VERSION_SPLITTER.match(d);if(a[1]>b[1]){TP.boot.$stderr(TP.boot.$join('Major version change from ',b[1],' to ',a[1]));TP.boot.$stdout('Simulating \'stale\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','remote');return;}if(a[2]>b[2]){TP.boot.$stderr(TP.boot.$join('Minor version change from ',b[2],' to ',a[2]));TP.boot.$stdout('Simulating \'synchronized\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','modified');return;}if(a[3]>b[3]){TP.boot.$stderr(TP.boot.$join('Build version change from ',b[3],' to ',a[3]));TP.boot.$stdout('Simulating \'manual\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','marked');return;}if(a[4]>b[4]){TP.boot.$stderr(TP.boot.$join('Patch version change from ',b[4],' to ',a[4]));TP.boot.$stdout('Simulating \'fresh\' local cache.',TP.TRACE);TP.sys.setcfg('import.source','local');return;}return;};TP.boot.$configureOptions=function(a){Object.keys(a).forEach(function(c){var b;b=a[c];if(Object.prototype.toString.call(b)==='[object Object]'){Object.keys(b).forEach(function(a){var d;d=c+'.'+a;TP.sys.setcfg(d,b[a]);TP.boot.$stdout('$configureOption '+d+' = '+b[a],TP.TRACE);if(d==='path.app_root'){TP.boot.$stdout('Overriding path.app_root cache with: '+b[a],TP.TRACE);TP.boot.$$approot=TP.boot.$uriExpandPath(b[a]);}else if(d==='path.lib_root'){TP.boot.$stdout('Overriding path.lib_root cache with: '+b[a],TP.TRACE);TP.boot.$$libroot=TP.boot.$uriExpandPath(b[a]);}});}else{TP.sys.setcfg(c,b);}});};TP.boot.$$configureOverrides=function(a,d){var c,b;if(TP.boot.$notValid(a)){return;}c=Object.keys(a);b=TP.sys.overrides;if(TP.boot.$isValid(b)){c.forEach(function(d){var c=a[d];if(Object.prototype.toString.call(c)==='[object Object]'){Object.keys(c).forEach(function(a){var e=d+'.'+a;b[e]=c[a];});}else{b[d]=c;}});}c.forEach(function(c){var b=a[c];if(Object.prototype.toString.call(b)==='[object Object]'){Object.keys(b).forEach(function(a){var d=c+'.'+a;TP.boot.$stdout('Setting override for: '+d+' to: \''+b[a]+'\'',TP.TRACE);TP.sys.setcfg(d,b[a],false,true);});}else{TP.boot.$stdout('Setting override for: '+c+' to: \''+b+'\'',TP.TRACE);TP.sys.setcfg(c,b,false,true);}});TP.boot.$$argsDone=d;return;};TP.boot.$configureProject=function(){var b,a;b=TP.boot.$$bootxml;a=b.getElementsByTagName('package')[0];if(TP.boot.$isEmpty(a)){TP.sys.setcfg('project.name','default');TP.sys.setcfg('project.version','0.0.1');}else{TP.sys.setcfg('project.name',a.getAttribute('name'));TP.sys.setcfg('project.controller',a.getAttribute('controller'));TP.sys.setcfg('project.version',a.getAttribute('version')||'0.0.1');}if(TP.boot.$notValid(TP.sys.cfg('project.rootpage'))){TP.sys.setcfg('project.rootpage','~app_html/UIROOT.xhtml');}return;};TP.boot.$configureTarget=function(){var b,a;a=TP.sys.cfg('boot.config');if(TP.boot.$isEmpty(a)){b=TP.boot.$$bootxml;a=TP.boot.$getDefaultConfig(b);TP.sys.setcfg('boot.config',a);}TP.boot.$$bootconfig=a;return;};TP.boot.$updateDependentVars=function(){var a;a=TP.sys.cfg('log.level');if(a<TP.TRACE||a>TP.SYSTEM){TP.sys.setcfg('log.level',TP.WARN,false,true);TP.boot.$$loglevel=TP.WARN;TP.boot.$computeLogBufferSize();TP.boot.$stdout('Invalid log.level: '+a+'. Forcing to TP.WARN',TP.WARN);}else{TP.boot.$$loglevel=a;}TP.$DEBUG=TP.sys.cfg('tibet.$debug',false);TP.$VERBOSE=TP.sys.cfg('tibet.$verbose',false);TP.$$DEBUG=TP.sys.cfg('tibet.$$debug',false);TP.$$VERBOSE=TP.sys.cfg('tibet.$$verbose',false);TP.boot.$debug=TP.sys.cfg('boot.$debug',false);TP.boot.$verbose=TP.sys.cfg('boot.$verbose',false);TP.boot.$$debug=TP.sys.cfg('boot.$$debug',false);TP.boot.$$verbose=TP.sys.cfg('boot.$$verbose',false);TP.sys.setcfg('boot.phasetwo',TP.sys.cfg('boot.twophase')===false);TP.boot.$$theme={trace:TP.sys.cfg('log.tracecolor'),info:TP.sys.cfg('log.infocolor'),warn:TP.sys.cfg('log.warncolor'),error:TP.sys.cfg('log.errorcolor'),fatal:TP.sys.cfg('log.fatalcolor'),severe:TP.sys.cfg('log.severecolor'),system:TP.sys.cfg('log.systemcolor'),time:TP.sys.cfg('log.timecolor'),delta:TP.sys.cfg('log.deltacolor'),slow:TP.sys.cfg('log.slowcolor'),debug:TP.sys.cfg('log.debugcolor'),verbose:TP.sys.cfg('log.verbosecolor')};};TP.boot.$ifUnlessPassed=function(h){var c,b,d,a,e,f,g;f=h;if(f.nodeType===Node.ELEMENT_NODE){g=false;if((b=f.getAttribute('unless'))!=null){d=b.split(' ');for(c=0;c<d.length;c++){a=TP.boot.$trim(d[c]);if(TP.boot.$$KV_REGEX.test(a)){a=a.split('=');e=TP.boot.$getArgumentPrimitive(TP.boot.$trim(a[1]));a=TP.boot.$trim(a[0]);}else{e=true;}if(TP.boot.$$USER_AGENT_REGEX.test(a)){b=TP.boot.isUA.apply(this,a.split('.'));}else{b=TP.sys.cfg(a,TP.sys.env(a));}if(b===e){g=true;break;}}}if((b=f.getAttribute('if'))!=null){d=b.split(' ');for(c=0;c<d.length;c++){a=TP.boot.$trim(d[c]);if(TP.boot.$$KV_REGEX.test(a)){a=a.split('=');e=TP.boot.$getArgumentPrimitive(TP.boot.$trim(a[1]));a=TP.boot.$trim(a[0]);}else{e=true;}if(TP.boot.$$USER_AGENT_REGEX.test(a)){b=TP.boot.isUA.apply(this,a.split('.'));}else{b=TP.sys.cfg(a,TP.sys.env(a));}if(TP.boot.$notValid(b)||b!==e){g=true;break;}}}}return!g;};TP.boot.$getElementCount=function(c){var a,b;b=0;a=c[0];if(a.nodeType===Node.ELEMENT_NODE){b++;}while((a=a.nextSibling)!=null){if(a.nodeType===Node.ELEMENT_NODE){b++;}}return b;};TP.boot.$uniqueNodeList=function(e){var c,b,f,a,g,i,h,d;g=TP.sys.cfg('debug.node');b=[];if(e==null){if(g&&TP.boot.$$verbose){TP.boot.$stderr('TP.boot.$uniqueNodeList(): invalid node array.');}return b;}f=TP.boot.$$scripts;i=e.length;for(c=0;c<i;c++){a=e[c];if(a.nodeType===Node.ELEMENT_NODE){switch(a.tagName.toLowerCase()){case'script':if((d=a.getAttribute('src'))!=null){h=TP.boot.$uriExpandPath(d);if(f[h]==null){f[h]=d;b.push(a);}else{if(g&&TP.boot.$$verbose){TP.boot.$stdout(TP.boot.$join('TP.boot.$uniqueNodeList() ','removing duplicate: ',d),TP.TRACE);}}}else{b.push(a);}break;default:b.push(a);break;}}}return b;};TP.$BOOT_STORAGE=null;TP.$BOOT_STORAGE_TYPE=null;TP.$BOOT_STORAGE_NAME='$BOOT_STORAGE';TP.$BOOT_STORAGE_LOCALSTORAGE=1;TP.boot.$escapeStorageName=function(a){return a.replace(/_/g,'__').replace(/ /g,'_s');};TP.boot.$initializeLocalStorage=function(){var a,b;a=window.localStorage;if(TP.boot.$notValid(a)){return null;}b={internalStore:a,size:TP.boot.isUA('IE')?10*1024*1024:5*1024*1024,_formatKey:function(a){return TP.boot.$escapeStorageName(TP.$BOOT_STORAGE_NAME)+'_'+TP.boot.$escapeStorageName(a);},get:function(b,c){var a;a=this._formatKey(b);c(this.internalStore.getItem(a),b);return this.internalStore.getItem(a);},set:function(a,b,d){var c;c=this._formatKey(a);try{this.internalStore.setItem(c,b);}catch(a){if(/maximum size reached/.test(a.message)){TP.sys.setcfg('boot.localcache',false);}TP.boot.$stderr('Storage Error: '+a.message+'.',TP.boot.$ec(a));}d(b,a);},remove:function(b,d){var a,c;a=this._formatKey(b);c=this.internalStore.getItem(a);this.internalStore.removeItem(a);d(c,b);},removeAll:function(a){this.internalStore.clear();a();}};TP.$BOOT_STORAGE=b;TP.$BOOT_STORAGE_TYPE=TP.$BOOT_STORAGE_LOCALSTORAGE;return b;};TP.boot.$setupDOMStorage=function(){if(TP.boot.$isValid(TP.$BOOT_STORAGE)){return true;}return TP.boot.$isValid(TP.boot.$initializeLocalStorage());};TP.boot.$sourceImport=function(c,f,d,i,k){var b,e,g,j,a,h;if(c==null){if(d){TP.boot.$stderr('Invalid script source. No content for '+TP.boot.$uriInTIBETFormat(d));}else{TP.boot.$stderr('Invalid script source.');}return null;}b=TP.boot.$$scriptTemplate.cloneNode(true);TP.boot.$loadNode=b;TP.boot.$loadNode.setAttribute('load_package',TP.sys.cfg('load.package',''));TP.boot.$loadNode.setAttribute('load_config',TP.sys.cfg('load.config',''));g=TP.boot.$isValid(f)?f:document;j=TP.boot.$isValid(f)?g.getElementsByTagName('head')[0]:TP.boot.$$head;a=TP.boot.$isValid(d)?d:'inline';TP.boot.$$onerrorURL=a;try{if(TP.boot.isUA('IE')){b.text=c;}else{h=g.createTextNode(c);TP.boot.$nodeAppendChild(b,h);}b.setAttribute('source',a);e=TP.boot.$nodeAppendChild(j,b);}catch(a){}finally{if(!e||$STATUS!==0){TP.boot.$loadNode=null;if(k===true){if(a==='inline'){throw new Error('Import failed in: '+c);}else{throw new Error('Import failed for: '+a);}}else{if(a==='inline'){TP.boot.$stderr('Import failed in: '+c);}else{TP.boot.$stderr('Import failed for: '+a);}}return null;}TP.boot.$$onerrorURL=null;}if(typeof i==='function'){i(e,$STATUS!==0);}return e;};TP.boot.$uriImport=function(a,e,c,f){var d,b;if(a==null){TP.boot.$stderr('InvalidURI');return null;}b='Requested source URL not found: ';d=TP.boot.$uriLoad(a,TP.TEXT,'source',true,f);if(d==null){if(c===true){throw new Error(b+a+'.');}else if(c===false){TP.boot.$stdout(b+a+'.',TP.TRACE);}else{TP.boot.$stderr(b+a+'.');}return null;}return TP.boot.$sourceImport(d,null,a,e,c);};TP.boot.$importApplication=function(){TP.boot.$setStage('importing');TP.boot.$$importPhaseOne();return;};TP.boot.$$importComplete=function(){var a,b;a=TP.boot.$getStage();if(a==='import_phase_one'||a==='import_phase_two'){if(TP.sys.hasLoaded()!==true){if(TP.sys.cfg('boot.twophase')===true){if(TP.sys.cfg('boot.phasetwo')===true){TP.boot.$stdout('Phase-two component loading complete.');TP.sys.hasLoaded(true);TP.boot.$setStage('import_complete');return TP.boot.main();}else{TP.boot.$stdout('Phase-one component loading complete.');b=TP.sys.getWindowById(TP.sys.cfg('tibet.uiroot'));if(b){if(b.$$phasetwo===true||window.$$phasetwo===true){if(TP.boot.bootPhaseTwo){TP.boot.bootPhaseTwo();}else{TP.boot.initializeCanvas();TP.boot.$$importPhaseTwo();}return;}}else{}TP.boot.$setStage('import_paused');}}else{TP.boot.$setStage('import_complete');return TP.boot.main();}}else{TP.boot.$stdout('Loading add-on components complete.');TP.boot.$setStage('import_complete');}TP.boot.$stderr=TP.STDERR_NULL;}else{}return;};TP.boot.$importComponents=function(q){var j,i,l,e,k,a,m,c,b,d,p,o,f,h,g,n;TP.boot.$loadNode=null;TP.boot.$loadPath=null;TP.boot.$loadCached=null;if(TP.boot.shouldStop()){return;}if(TP.boot.$$bootnodes==null){if(TP.boot.$debug&&TP.boot.$verbose){TP.boot.shouldStop('invalid component list.');TP.boot.$stderr('TP.boot.$importComponents() '+'terminated: invalid component list.',TP.FATAL);}return;}a=TP.boot.$$bootnodes[TP.boot.$$bootindex];if(TP.boot.$$bootnodes.length===0||a==null){return TP.boot.$$importComplete();}d=q==null?TP.sys.cfg('tibet.sync'):q;TP.boot.$$loadsync=d;i=a.tagName.toLowerCase();f=a.getAttribute('load_package');if(f){f=TP.boot.$uriInTIBETFormat(f).replace('.xml','');}if(i==='script'){if((b=a.getAttribute('src'))!=null){if(TP.boot.$$scripts[b]){TP.boot.$$bootindex+=1;TP.boot.$displayProgress();if(d){TP.boot.$importComponents(d);}else{setTimeout(TP.boot.$$importAsync,0);}return;}else{TP.boot.$$scripts[b]=true;}TP.boot.$$script=b;h=TP.boot.$join(f,'::'+a.getAttribute('load_config'),' ',b.slice(b.lastIndexOf('/')+1));if(TP.sys.cfg('boot.defer')===true&&(a.getAttribute('defer')==='true'||a.getAttribute('load_deferred')==='true')){if(TP.boot.$verbose){TP.boot.$stdout('Deferring '+h,TP.TRACE);}else{TP.boot.$stdout('Deferring '+b,TP.TRACE);}TP.boot.$$bootindex+=1;TP.boot.$displayProgress();if(d){TP.boot.$importComponents(d);}else{setTimeout(TP.boot.$$importAsync,0);}return;}}else{TP.boot.$$script='inline';h=TP.boot.$join(f,'::',a.getAttribute('load_config'),' inline <',i,'> source');}TP.boot.$stdout('Loading '+(b?b:h),TP.TRACE);if(b){TP.boot.$loadPath=b;TP.boot.$$loadpaths.push(b);}else{TP.boot.$loadPath=null;}TP.sys.setcfg('load.package',a.getAttribute('load_package')||'');TP.sys.setcfg('load.config',a.getAttribute('load_config')||'');if((b=a.getAttribute('src'))!=null){if(TP.sys.cfg('import.usingdom')){c=TP.boot.$$scriptTemplate.cloneNode(true);c.setAttribute('load_package',a.getAttribute('load_package')||'');c.setAttribute('load_config',a.getAttribute('load_config')||'');TP.boot.$loadNode=c;m=function(a){TP.boot.$loadNode=null;TP.boot.$$bootindex+=1;TP.boot.$displayProgress();if(d){TP.boot.$importComponents(d);}else{setTimeout(TP.boot.$$importAsync,0);}};if(TP.boot.isUA('IE')){c.onreadystatechange=function(){if(c.readyState==='loaded'||c.readyState==='complete'){m();}};}else{c.onload=m;}if(TP.sys.cfg('import.check_404')){if(!TP.boot.$uriExists(TP.boot.$loadPath)){TP.boot.$stderr('404 (Not Found): '+TP.boot.$loadPath);return;}}c.setAttribute('src',TP.boot.$loadPath);TP.boot.$$head.appendChild(c);return;}n=true;if(TP.sys.cfg('import.source')==='marked'){if(a.getAttribute('refresh')!=='true'){n=false;}}g=TP.boot.$uriLoad(TP.boot.$loadPath,TP.TEXT,'source',n);}else{g='';p=a.childNodes.length;for(j=0;j<p;j++){l=a.childNodes[j];if(l.nodeType===Node.CDATA_SECTION_NODE){g+=l.nodeValue||'';g=TP.boot.$trim(g);}}}try{TP.boot.$sourceImport(g,null,TP.boot.$loadPath);}catch(a){}finally{TP.boot.$loadNode=null;}}else if(i==='tibet_image'){if(TP.sys.cfg('boot.import_images')){if((b=a.getAttribute('src'))!=null){h=TP.boot.$join(f,'::',a.getAttribute('load_config'),' ',b.slice(b.lastIndexOf('/')+1));TP.boot.$stdout('Preloading image '+h,TP.TRACE);o=new Image();o.src=b;}}}else if(i==='echo'){k=1*(a.getAttribute('level')||TP.INFO);if((e=a.getAttribute('message'))!=null){TP.boot.$stdout(e,k);}else{a.normalize();e='';if(a.firstChild!=null){e=a.firstChild.nodeValue||'';e=TP.boot.$trim(e);}TP.boot.$stdout(e,k);}}else{}TP.boot.$$script=null;TP.boot.$$bootindex+=1;TP.boot.$displayProgress();if(d){TP.boot.$importComponents(d);}else{setTimeout(TP.boot.$$importAsync,0);}return;};TP.boot.$$importPhase=function(){var b,c,a;b=TP.boot.$$bootfile;c=TP.sys.cfg('boot.config');a=TP.boot.$listPackageAssets(b,c);TP.boot.$stdout('Importing '+a.length+' components.',TP.SYSTEM);TP.boot.$$bootnodes=a;TP.boot.$$bootindex=0;TP.boot.$$workload=a.length;window.$$phasetwo=true;TP.boot.$importComponents();};TP.boot.$$importPhaseOne=function(){TP.boot.$setStage('import_phase_one');TP.sys.setcfg('boot.phaseone',true);TP.sys.setcfg('boot.phasetwo',TP.sys.cfg('boot.twophase')===false);TP.boot.$$importPhase();return;};TP.boot.$$importPhaseTwo=function(a){if(TP.sys.cfg('boot.twophase')!==true){return;}TP.boot.$setStage('import_phase_two');TP.sys.setcfg('boot.phaseone',false);TP.sys.setcfg('boot.phasetwo',true);TP.boot.$$importPhase();return;};TP.boot.$config=function(){TP.boot.$setStage('configuring');TP.boot.$configureBootstrap();TP.boot.$updateDependentVars();TP.boot.$configurePackage();TP.boot.$updateDependentVars();TP.boot.$configureLocalCache();TP.boot.$configureTarget();TP.boot.$configureProject();if(TP.sys.cfg('log.bootenv')){TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout('TIBET Environment Variables',TP.TRACE);TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout(TP.sys.environment,TP.TRACE);}if(TP.sys.cfg('log.bootcfg')){TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout('TIBET Configuration Variables',TP.TRACE);TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout(TP.sys.configuration,TP.TRACE);TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout('TIBET Configuration Overrides',TP.TRACE);TP.boot.$stdout(TP.sys.cfg('boot.uichunked'),TP.TRACE);TP.boot.$stdout(TP.sys.overrides,TP.TRACE);}return;};TP.boot.$expand=function(){var a,b;TP.boot.$setStage('expanding');a=TP.boot.$$bootfile;b=TP.sys.cfg('boot.config');TP.boot.$stdout('Expanding package#config: '+a+'#'+b,TP.TRACE);TP.boot.$expandPackage(a,b);return;};TP.boot.$$configs=[];TP.boot.$$packageStack=[];TP.boot.$$assets={};TP.boot.$$packages={};TP.boot.$$paths={};TP.boot.$$assets_list=null;TP.boot.$expandConfig=function(a){var b;b=Array.prototype.slice.call(a.childNodes,0);b.forEach(function(b){var h,d,e,g,m,f,c,i,n,l,j,k;if(b.nodeType===1){switch(b.tagName){case'config':h=b.getAttribute('ref');h=TP.boot.$expandReference(h);e=TP.boot.$documentGetElementById(a.ownerDocument,h);if(TP.boot.$notValid(e)){throw new Error('<config> not found: '+TP.boot.$getCurrentPackage()+'#'+h);}g=TP.boot.$getCurrentPackage()+'#'+h;if(TP.boot.$$configs.indexOf(g)!==-1){TP.boot.$stderr('Ignoring duplicate reference to: '+g);break;}TP.boot.$$configs.push(g);TP.boot.$expandConfig(e);break;case'echo':c=b.getAttribute('message');if(TP.boot.$isEmpty(c)){try{b.normalize();n=b.childNodes[0];c=n.data;}catch(a){throw new Error('Unable to find message: '+TP.boot.$nodeAsString(b));}}i=b.getAttribute('level');if(TP.boot.$notEmpty(i)){i=', '+i;}else{i='';}try{j='<script><![CDATA['+'TP.boot.$stdout(\''+c.replace(/'/g,'\'')+'\''+i+');'+']]></script>';k=TP.boot.$documentFromString(j);f=k.childNodes[0];c=b.getAttribute('if');if(TP.boot.$notEmpty(c)){f.setAttribute('if',c);}c=b.getAttribute('unless');if(TP.boot.$notEmpty(c)){f.setAttribute('unless',c);}b.parentNode.replaceChild(f,b);}catch(a){l=a.message;throw new Error('Error expanding: '+TP.boot.$nodeAsString(b)+l);}break;case'img':d=b.getAttribute('src');if(TP.boot.$notEmpty(d)&&d.indexOf('data:')!==0){d=TP.boot.$getFullPath(b,d);b.setAttribute('src',d);}break;case'package':d=b.getAttribute('src');d=TP.boot.$getFullPath(b,d);b.setAttribute('src',d);e=b.getAttribute('config');if(TP.boot.$notEmpty(e)){e=TP.boot.$expandReference(e);b.setAttribute('config',e);}g=d+'#'+e;if(TP.boot.$$configs.indexOf(g)!==-1){TP.boot.$stderr('Ignoring duplicate reference to: '+g);break;}TP.boot.$$configs.push(g);TP.boot.$expandPackage(d,e);break;case'property':m=b.getAttribute('name');c=b.getAttribute('value');if(TP.boot.$notEmpty(m)&&TP.boot.$notEmpty(c)){c=TP.boot.$getArgumentPrimitive(c);if(typeof c==='string'){c=TP.boot.$quoted(c);}try{j='<script><![CDATA['+'TP.sys.setcfg('+'\''+m+'\', '+c+');'+']]></script>';k=TP.boot.$documentFromString(j);f=k.childNodes[0];c=b.getAttribute('if');if(TP.boot.$notEmpty(c)){f.setAttribute('if',c);}c=b.getAttribute('unless');if(TP.boot.$notEmpty(c)){f.setAttribute('unless',c);}b.parentNode.replaceChild(f,b);}catch(a){l=a.message;throw new Error('Error expanding: '+TP.boot.$nodeAsString(b)+l);}}break;case'script':case'style':case'template':default:d=b.getAttribute('href');if(TP.boot.$notEmpty(d)){d=TP.boot.$getFullPath(b,d);b.setAttribute('href',d);}d=b.getAttribute('src');if(TP.boot.$notEmpty(d)){d=TP.boot.$getFullPath(b,d);b.setAttribute('src',d);}break;}}});};TP.boot.$expandPackage=function(f,g){var a,b,c,e,d,h;a=TP.boot.$isEmpty(f)?TP.sys.cfg('boot.package'):f;a=TP.boot.$expandPath(a);TP.boot.$pushPackage(a);try{b=TP.boot.$$packages[a];if(!b){b=TP.boot.$uriLoad(a,TP.DOM,'manifest',true);if(!b){throw new Error('Unable to read package: '+a);}TP.boot.$$packages[a]=b;}d=b.getElementsByTagName('package')[0];if(TP.boot.$notValid(d)){return;}if(TP.boot.$isEmpty(d.getAttribute('name'))){throw new Error('Missing name on package: '+TP.boot.$nodeAsString(d));}if(TP.boot.$isEmpty(g)){c=TP.boot.$getDefaultConfig(b);}else{c=g;}e=TP.boot.$documentGetElementById(b,c);if(!e){throw new Error('<config> not found: '+TP.boot.$getCurrentPackage()+'#'+c);}TP.boot.$expandConfig(e);}catch(b){h=b.message;throw new Error('Error expanding package: '+a+'. '+h);}finally{TP.boot.$popPackage();}return b;};TP.boot.$expandPath=function(b){var a,d,c;a=TP.boot.$$paths[b];if(a){return a;}if(b.indexOf('~')===0){if(b==='~'){return TP.boot.$getAppHead();}else if(b==='~app'||b==='~app_root'){return TP.boot.$getAppRoot();}else if(b==='~tibet'||b==='~lib'||b==='~lib_root'){return TP.boot.$getLibRoot();}else{d=b.split('/');c=d.shift();if(c==='~'){a=TP.boot.$getAppHead();}else if(c==='~app'||c==='~app_root'){a=TP.boot.$getAppRoot();}else if(c==='~tibet'||c==='~lib'||c==='~lib_root'){a=TP.boot.$getLibRoot();}else{a=TP.sys.cfg('path.'+c.slice(1));if(!a){throw new Error('Virtual path not found: '+c);}}d.unshift(a);a=d.join('/');}if(a.indexOf('~')===0){if(a===b){throw new Error('Virtual path is circular: '+a);}else{a=TP.boot.$expandPath(a);}}}else{a=b;}TP.boot.$$paths[b]=a;return a;};TP.boot.$expandReference=function(a){var b;if(a&&a.indexOf('{')===0){b=TP.sys.cfg(a.slice(1,-1));if(TP.boot.$isEmpty(b)){TP.boot.$stderr('Unresolved property reference: '+a);return a;}return b;}else{return a;}};TP.boot.$getCurrentPackage=function(){return TP.boot.$$packageStack[0];};TP.boot.$getDefaultConfig=function(b){var a;a=b.getElementsByTagName('package')[0];if(TP.boot.$notValid(a)){throw new Error('<package> tag missing.');}return a.getAttribute('default')||'base';};TP.boot.$getFullPath=function(d,a){var b,c;if(TP.boot.$isEmpty(a)){return;}if(TP.boot.$uriIsVirtual(a)){return TP.boot.$uriExpandPath(a);}if(TP.boot.$uriIsAbsolute(a)){return a;}b=d;while(b){c=b.getAttribute('basedir');if(TP.boot.$notEmpty(c)){return TP.boot.$uriExpandPath(TP.boot.$uriJoinPaths(c,a));}b=b.parentNode;}};TP.boot.$ifAssetPassed=function(c){var a,b;a=c.tagName;if(TP.boot.$isEmpty(TP.sys.cfg('boot.assets'))){return true;}if(a==='package'||a==='config'){return true;}if(TP.boot.$notValid(TP.boot.$$assets_list)){TP.boot.$$assets_list=TP.boot.$$assets.split(' ');}b=TP.boot.$$assets_list.indexOf(a)!==-1;return b;};TP.boot.$ifUnlessPassedLite=function(f){var b,a,c,d,e;e=false;a=f.getAttribute('unless');if(TP.boot.$notEmpty(a)){c=a.split(' ');for(b=0;b<c.length;b++){d=c[b].trim();a=TP.sys.cfg(d);if(a===true){e=true;break;}}}a=f.getAttribute('if');if(TP.boot.$notEmpty(a)){c=a.split(' ');for(b=0;b<c.length;b++){d=c[b].trim();a=TP.sys.cfg(d);if(TP.boot.$notValid(a)||a===false){e=true;break;}}}return!e;};TP.boot.$listConfigAssets=function(b,c){var d,a;if(TP.boot.$notValid(c)){TP.boot.$$assets={};}a=c||[];if(!TP.boot.$ifUnlessPassed(b)){return a;}d=Array.prototype.slice.call(b.childNodes,0);d.forEach(function(c){var f,d,e;if(c.nodeType===1){if(!TP.boot.$ifUnlessPassed(c)){return;}if(!TP.boot.$ifAssetPassed(c)){return;}switch(c.tagName){case'config':f=c.getAttribute('ref');e=TP.boot.$documentGetElementById(b.ownerDocument,f);if(TP.boot.$notValid(e)){throw new Error('<config> not found: '+f);}TP.boot.$listConfigAssets(e,a);break;case'echo':break;case'package':d=c.getAttribute('src');e=c.getAttribute('config');if(TP.boot.$isEmpty(d)){throw new Error('<package> missing src: '+TP.boot.$nodeAsString(c));}TP.boot.$listPackageAssets(d,e,a);break;case'property':c.setAttribute('load_package',TP.boot.$getCurrentPackage());c.setAttribute('load_config',b.getAttribute('id'));a.push(c);break;case'img':case'script':case'style':case'template':default:d=c.getAttribute('src')||c.getAttribute('href');if(TP.boot.$notEmpty(d)){if(TP.boot.$notValid(TP.boot.$$assets[d])){TP.boot.$$assets[d]=d;c.setAttribute('load_package',TP.boot.$getCurrentPackage());c.setAttribute('load_config',b.getAttribute('id'));a.push(c);}else{TP.boot.$stdout('Skipping duplicate asset: '+d,TP.WARN);}}else{c.setAttribute('load_package',TP.boot.$getCurrentPackage());c.setAttribute('load_config',b.getAttribute('id'));a.push(c);}break;}}});return a;};TP.boot.$listPackageAssets=function(b,g,h){var a,c,d,e,f;a=TP.boot.$isEmpty(b)?TP.sys.cfg('boot.package'):b;a=TP.boot.$expandPath(a);TP.boot.$pushPackage(a);try{d=TP.boot.$$packages[a];if(TP.boot.$notValid(d)){throw new Error('Can not list unexpanded package: '+b);}if(TP.boot.$isEmpty(g)){c=TP.boot.$getDefaultConfig(d);}else{c=g;}e=TP.boot.$documentGetElementById(d,c);if(TP.boot.$notValid(e)){throw new Error('<config> not found: '+a+'#'+c);}if(!h){TP.boot.$$assets={};}f=h||[];TP.boot.$listConfigAssets(e,f);}finally{TP.boot.$popPackage(b);}return f;};TP.boot.$popPackage=function(){return TP.boot.$$packageStack.shift();};TP.boot.$pushPackage=function(a){TP.boot.$$packageStack.unshift(a);};TP.boot.$import=function(){TP.boot.$setStage('importing');TP.boot.$$scripts={};TP.boot.$$importPhaseOne();return;};TP.boot.boot=function(){TP.boot.$config();TP.boot.$expand();TP.boot.$import();return;};TP.boot.launch=function(a){var b;TP.boot.$$launchOptions=a;TP.boot.$configureEnvironment();if(a){TP.boot.$$configureOverrides(a);TP.boot.$updateDependentVars();}TP.boot.$stdout(TP.sys.cfg('boot.uisection'),TP.SYSTEM);TP.boot.$stdout('TIBET Boot System (TBS) v'+TP.boot.$bootversion,TP.SYSTEM);TP.boot.$stdout(TP.sys.cfg('boot.uisection'),TP.SYSTEM);try{TP.boot.$setStage('prelaunch');}catch(a){if(window.location.protocol.indexOf('file')===0){if(TP.boot.isUA('chrome')){TP.boot.$stderr('File launch aborted. '+'On Chrome you need to start the browser with '+'the --allow-file-access-from-files flag.',TP.FATAL);}else if(TP.boot.isUA('firefox')){TP.boot.$stderr('File launch aborted. '+'On Firefox you must set the config flag '+'\'security.fileuri.strict_origin_policy\' to false,'+' via about:config, quit the browser and restart.',TP.FATAL);}else{TP.boot.$stderr('File launch aborted. Check browser security settings.',TP.FATAL);}return;}}if(TP.boot.isObsolete()){TP.boot.$stderr('Obsolete browser/platform: '+TP.$agent+'. Boot sequence terminated.',TP.FATAL);return;}if(TP.sys.cfg('boot.nourlargs')!==true){TP.boot.$$configureOverrides(TP.boot.getURLArguments(top.location.toString()),true);TP.boot.$updateDependentVars();}b=/\?L=false/.test(window.location.toString());TP.sys.setcfg('boot.uselogin',!b);if(window.$$tibet!==null&&window.$$tibet!==window){TP.boot.$stderr('Found existing TIBET image in '+(typeof window.$$tibet.getFullName==='function')?window.$$tibet.getFullName():window.$$tibet.name+'. Boot sequence terminated.',TP.FATAL);return;}if(!TP.boot.isSupported()){TP.boot.$stderr('Unsupported browser/platform: '+TP.$agent+'. You may experience problems.');}TP.boot.$uiRootConfig();};TP.boot.main=function(){var a;a=TP.boot.$getBootLogElement();if(TP.boot.$isElement(a)){a.parentElement.className='edge done';}if(TP.boot.shouldStop()){TP.boot.$flushLog(true);return;}if(TP.sys.cfg('boot.pause')){TP.boot.$setStage('paused');TP.boot.$displayStatus('Paused via boot.pause setting.');return;}if(TP.boot.$$logpeak>TP.WARN&&TP.sys.cfg('boot.pause_on_error')){TP.boot.$setStage('paused');TP.boot.$displayStatus('Paused via boot.pause_on_error w/boot errors.');return;}TP.boot.$activate();};TP.boot.$activate=function(){TP.boot.$setStage('activating');try{TP.windowInstallOnBeforeUnloadHook(window);TP.windowInstallOnlineOfflineHook(window);TP.windowInstallDocumentVisibilityHook(window);try{TP.sys.activate();}catch(a){TP.boot.$stderr('Error activating application.',TP.boot.$ec(a));}}catch(a){TP.boot.$stderr('Error activating application.',TP.boot.$ec(a));}return;};TP.boot.$stageAction=function(){switch(TP.boot.$getStage()){case'paused':TP.boot.$$restarttime=new Date();TP.boot.$stdout('Startup process reengaged by user.',TP.SYSTEM);TP.boot.$activate();break;case'import_paused':break;default:break;}};TP.boot.$uiRootConfig=function(){var b,a,f,c,g,h,d,e;b=TP.sys.cfg('tibet.uiroot')||'UIROOT';a=TP.boot.$getUIElement(b);if(TP.boot.$isValid(a)){TP.boot.$uiRootReady();return;}TP.boot.$stdout('Unable to locate '+b+', generating it.',TP.TRACE);f=document.body.children;c=f[f.length-1];g=/\.xhtml/.test(TP.sys.$pathname);if(g){d=document.createElement('span');c.parentNode.insertBefore(d,c);d.innerHTML='<iframe id="'+b+'">';h=TP.boot.$uriExpandPath(TP.sys.cfg('tibet.iframepage'));d.firstChild.setAttribute('src',h);d.firstChild.onload=function(){var c;a=document.getElementById(b);c=a.contentDocument;a.contentWindow=c.defaultView;window.frames[b]=c.defaultView;TP.boot.$uiRootReady();};}else{a=document.createElement('iframe');a.setAttribute('id',b);a.setAttribute('frameborder','0');c.parentNode.insertBefore(a,c);e=a.contentDocument;e.open('text/html','replace');e.write('<html><head></head><body></body></html>');e.close();TP.boot.$uiRootReady();}};TP.boot.$uiRootReady=function(){var c,b,d,e,a;c=TP.sys.cfg('tibet.uiroot')||'UIROOT';b=TP.sys.getWindowById(c);if(TP.boot.$notValid(b)){TP.boot.$stdout('Unable to locate uiroot, defaulting to current window.',TP.WARN);b=window;}d=TP.sys.cfg('boot.uselogin');if(d!==true){b.$$phasetwo=true;TP.boot.boot();}else{a=TP.sys.cfg('boot.loginpage');a=TP.boot.$uriExpandPath(a);e=TP.sys.cfg('boot.parallel');if(e===false){window.location.replace(a);}else{TP.boot.showUICanvas(a);TP.boot.boot();}}return;};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=TP;}exports.TP=TP;exports.APP=APP;}else{a.TP=TP;a.APP=APP;}}(this));
;(function(a){$$checked=null;$$tibet=null;window.offerror=window.onerror;window.onerror=function(b,d,e,f,c){var a;try{a=b||'Error';a+=' in file: '+d+' line: '+e+' column: '+f;if(c){a+='\nSTACK:\n'+c.stack;}if(window.location.protocol.indexOf('file')===0){if(window.onerror.failedlaunch){return;}window.onerror.failedlaunch=true;}else{top.console.error(a);}}catch(c){top.console.error('Error logging onerror: '+c.message);top.console.error(a||b);}return false;};$$getNextWindow=function(e,d){var a,b,c;a=e==null?window:e;if(a.parent!=null&&a.parent!==a){b=a.parent.frames;if(b.length>1){for(c=0;c<b.length;c++){try{if(b[c].$$checked!==d){return b[c];}}catch(a){}}}}try{if(a.parent!=null&&a.parent!==a&&a.parent.$$checked!==d){return a.parent;}}catch(a){}try{if(a.top!=null&&a.top!==a&&a.top.$$checked!==d){return a.top;}}catch(a){}try{if(a.opener!=null&&a.opener!==a&&a.opener.$$checked!==d){return a.opener;}}catch(a){}return;};$$findTIBET=function(c){var a,b;if(top.$$tibet!=null){window.$$tibet=top.$$tibet;return top.$$tibet;}else if(top.$$TIBET===true){window.$$tibet=top;return top;}if(window.$$tibet!=null){return window.$$tibet;}else if(window.$$TIBET===true){return window;}a=c==null?window:c;b=new Date().getTime();while(a!=null){try{a.$$checked=b;if(a.$$tibet!=null){window.$$tibet=a.$$tibet;return a.$$tibet;}else if(a.$$TIBET===true){window.$$tibet=a;return a;}}catch(a){}a=$$getNextWindow(a,b);}return;};if(self.TP==null){try{$$findTIBET();}catch(a){return;}if(window.$$tibet&&window.$$tibet!==window){window.TP=window.$$tibet.TP;}else{if(Object.defineProperty){Object.defineProperty(self,'TP',{value:{},writable:true});Object.defineProperty(TP,'boot',{value:{},writable:false});Object.defineProperty(TP,'sys',{value:{},writable:false});}else{TP=self.TP||{};TP.sys=TP.sys||{};TP.boot=TP.boot||{};}}}TP.$$tibetinf=TP.$$tibetinf||'/html';TP.$$bootpage=TP.$$bootpage||'index.html';TP.ANY=TP.ANY||'ANY';TP.boot.$isElement=function(a){return a!=null&&a.nodeType===Node.ELEMENT_NODE;};TP.boot.$isEmpty=function(a){return a==null||a===''||a.length===0;};TP.boot.$isEvent=function(a){return a!=null&&a.clientX!==undefined&&a.clientY!==undefined;};TP.boot.$isTrue=function(a){if(a===true){return true;}if(a===false){return false;}return typeof a==='boolean'&&a.valueOf()===true;};TP.boot.$isValid=function(a){return a!=null;};TP.boot.$isWindow=function(a){if(a!=null&&a.moveBy!==undefined){return true;}return false;};TP.boot.$notValid=function(a){return a==null;};if(!self.Window){Window=self.constructor;}TP.boot.$$isIE=function(){if(/Gecko|Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent)){return false;}return/MSIE/.test(navigator.userAgent);};TP.boot.$$isMoz=function(){return/rv:.+?Gecko/.test(navigator.userAgent);};TP.boot.$$isWebkit=function(){return/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent);};if(TP.boot.$notValid(TP.DOM_SIGNAL_TYPE_MAP)){TP.DOM_SIGNAL_TYPE_MAP={'abort':'TP.sig.DOMAbort','blur':'TP.sig.DOMBlur','change':'TP.sig.DOMChange','click':'TP.sig.DOMClick','copy':'TP.sig.DOMCopy','contextmenu':'TP.sig.DOMContextMenu','cut':'TP.sig.DOMCut','dblclick':'TP.sig.DOMDblClick','error':'TP.sig.DOMError','focus':'TP.sig.DOMFocus','keydown':'TP.sig.DOMKeyDown','keypress':'TP.sig.DOMKeyPress','keyup':'TP.sig.DOMKeyUp','load':'TP.sig.DOMLoad','mousedown':'TP.sig.DOMMouseDown','mouseenter':'TP.sig.DOMMouseEnter','mousehover':'TP.sig.DOMMouseHover','mouseleave':'TP.sig.DOMMouseLeave','mousemove':'TP.sig.DOMMouseMove','mouseout':'TP.sig.DOMMouseOut','mouseover':'TP.sig.DOMMouseOver','mouseup':'TP.sig.DOMMouseUp','dragdown':'TP.sig.DOMDragDown','draghover':'TP.sig.DOMDragHover','dragmove':'TP.sig.DOMDragMove','dragout':'TP.sig.DOMDragOut','dragover':'TP.sig.DOMDragOver','dragup':'TP.sig.DOMDragUp','move':'TP.sig.DOMMove','paste':'TP.sig.DOMPaste','reset':'TP.sig.DOMReset','resize':'TP.sig.DOMResize','submit':'TP.sig.DOMSubmit','unload':'TP.sig.DOMUnload'};if(TP.boot.$$isIE()||TP.boot.$$isWebkit()){TP.DOM_SIGNAL_TYPE_MAP.mousewheel='TP.sig.DOMMouseWheel';}else{TP.DOM_SIGNAL_TYPE_MAP.DOMMouseScroll='TP.sig.DOMMouseWheel';}TP.DOM_SIGNAL_TYPE_MAP.at=function(a){return this[a];};TP.DOM_SIGNAL_TYPE_MAP.atPut=function(a,b){this[a]=b;return this;};}if(window.onerror.failedlaunch!==true&&window!==top&&top.TP!=null&&top.TP.sys!=null&&top.TP.sys.hasLoaded()===true&&top.TP.isHTMLDocument(document)===true&&top.TP.core.Window.$$isDocumentWriting!==true&&window.frameElement!=null&&window.frameElement.hasAttribute('tibet_settinglocation')!==true){top.TP.windowResetLocation(window);}else{TP.boot.$formatCookieSource=function(a){var b;if(a==null){b='null';}else if(a.constructor===Date){b='"'+a.toString()+'"';}else if(a.constructor===String){b='"'+a+'"';}else{b=a.toString();}return b;};TP.boot.getCookie=function(d){var a,b,c,e;try{a=document.cookie;if(a===''){return;}}catch(a){return;}c=a.indexOf(d+'=');if(c===-1){return;}b=a.indexOf(';',c+d.length);if(b===-1){b=a.length;}e=decodeURI(a.slice(c+d.length+1,b));return e;};TP.boot.setCookie=function(b,c,d,e,f,g){var a;if(b==null||c==null){return false;}a=b+'='+encodeURI(c);a+=d==null?'':'; expires='+d.toGMTString();a+=g!==true?'':'; secure';a+=f==null?'':'; domain='+f;a+=e==null?'':'; path='+e;try{document.cookie=a;}catch(a){return false;}return true;};TP.boot.$byId=function(a){if(typeof a==='string'){return document.getElementById(a);}return a;};TP.boot.getWindowLocation=function(){if(TP.boot.$isElement(window.frameElement)){if(window.frameElement.hasAttribute('tibet_settinglocation')===true){return window.frameElement.getAttribute('tibet_settinglocation');}if(window.location.toString()===top.location.toString()&&window.parent!==window){return window.parent.location.toString();}}return window.location.toString();};TP.boot.hideContent=function(a){var b,c;c=$$findTIBET();if(TP.boot.$isValid(b=TP.boot.$byId(a||TP.boot.$$currentContentID,c))){b.style.display='none';if(TP.boot.$$currentContentID===a){TP.boot.$$currentContentID=null;}}};TP.boot.hideUICanvas=function(){var a;a=TP.sys.getWindowById(TP.sys.cfg('tibet.uicanvas'));if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='hidden';}}};TP.boot.hideUIRoot=function(){var a;a=TP.sys.getWindowById(TP.sys.cfg('tibet.uiroot'));if(TP.boot.$isValid(a)){if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='hidden';}}};TP.boot.launchApp=function(){window.location=TP.$$bootpage;return;};TP.boot.showBootLog=function(){var b,a;b=$$findTIBET();if(b){a=b.TP.sys;if(a&&typeof a.showBootLog==='function'){a.showBootLog();}}};TP.boot.showContent=function(a){var b,c;c=$$findTIBET();TP.boot.hideUICanvas();TP.boot.hideContent(TP.boot.$$currentContentID);if(TP.boot.$isValid(b=TP.boot.$byId(a,c))){b.style.display='block';TP.boot.$$currentContentID=a;}};TP.boot.showUICanvas=function(b){var a,c;TP.boot.hideContent();a=TP.sys.getWindowById(TP.sys.cfg('tibet.uicanvas'));if(TP.boot.$isValid(a)){if(TP.boot.$isValid(b)){c=TP.boot.$uriExpandPath(b);window.location.replace(c);}if(TP.boot.$isValid(a.frameElement)){a.frameElement.style.visibility='visible';}}return;};TP.boot.startGUI=function(){var a;a=$$findTIBET();if(a&&a.TP.sys&&a.main){a.main();}else{alert('Unable to find main().');}return;};TP.boot.$$setupMetadata=function(){var a;TP.NAME='$$name';TP.TNAME='$$typename';TP.RNAME='$$realname';TP.TYPE='$$type';TP.TYPEC='$$Type';TP.INSTC='$$Inst';TP.SUPER='$$supertype';TP.ANCESTORS='$$ancestors';TP.ANCESTOR_NAMES='$$anames';TP.SUBTYPE_NAMES='$$snames';TP.SUBTYPE_NAMES_DEEP='$$snames_deep';TP.SUBTYPES='$$subtypes';TP.SUBTYPES_DEEP='$$subtypes_deep';a=function(a,c,d,e,b,g,h,i,j,f){a[TP.TYPE]=c;a[TP.TYPEC]=d;a[TP.INSTC]=e;a[TP.TNAME]=b;a[TP.RNAME]=g;a[TP.NAME]=h;a[TP.SUPER]=i;a[TP.ANCESTORS]=j;a[TP.ANCESTOR_NAMES]=f;};a(Array,Array,Function,Function,'Array','Array','Array',Object,TP.ac(Object),TP.ac('Object'));a(Boolean,Boolean,Function,Function,'Boolean','Boolean','Boolean',Object,TP.ac(Object),TP.ac('Object'));a(Date,Date,Function,Function,'Date','Date','Date',Object,TP.ac(Object),TP.ac('Object'));a(Function,Function,Function,Function,'Function','Function','Function',Object,TP.ac(Object),TP.ac('Object'));a(Number,Number,Function,Function,'Number','Number','Number',Object,TP.ac(Object),TP.ac('Object'));a(Object,Object,Function,Function,'Object','Object','Object',null,TP.ac(),TP.ac());a(RegExp,RegExp,Function,Function,'RegExp','RegExp','RegExp',Object,TP.ac(Object),TP.ac('Object'));a(String,String,Function,Function,'String','String','String',Object,TP.ac(Object),TP.ac('Object'));Object[TP.SUBTYPES]=TP.ac(Array,Boolean,Date,Function,Number,RegExp,String);Object[TP.SUBTYPES_DEEP]=TP.ac(Array,Boolean,Date,Function,Number,RegExp,String);Object[TP.SUBTYPE_NAMES]=TP.ac('Array','Boolean','Date','Function','Number','RegExp','String');Object[TP.SUBTYPE_NAMES_DEEP]=TP.ac('Array','Boolean','Date','Function','Number','RegExp','String');a(Window,Window,Function,Function,'DOMWindow','DOMWindow','DOMWindow',Object,TP.ac(Object),TP.ac('Object'));Window.$$nonFunctionConstructorObjectName='DOMWindow';if(TP.boot.$$isWebkit()){a(XMLDocument,XMLDocument,Function,Function,'XMLDocument','XMLDocument','XMLDocument',Document,TP.ac(Document,Node,Object),TP.ac('Document','Node','Object'));a(XMLHttpRequest,XMLHttpRequest,Function,Function,'XMLHttpRequest','XMLHttpRequest','XMLHttpRequest',Object,TP.ac(Object),TP.ac('Object'));NaN.__proto__.$$nonFunctionConstructorConstructorName='Number';}if(TP.boot.$$isMoz()){a(CSS2Properties,CSS2Properties,Function,Function,'CSSStyleDeclaration','CSSStyleDeclaration','CSSStyleDeclaration',Object,TP.ac(Object),TP.ac('Object'));NaN.__proto__.$$nonFunctionConstructorConstructorName='Number';}};TP.boot.installPatches=function(a){if(TP.boot.$notValid(a.atob)){a.atob=function(l){var c,g,a,d,e,h,i,b,k,f,j;if(typeof l!=='string'){return TP.boot.$raise(this,'InvalidParameter',arguments);}c=[];for(a=0;a<26;a++){c.push(String.fromCharCode(65+a));}for(a=0;a<26;a++){c.push(String.fromCharCode(97+a));}for(a=0;a<10;a++){c.push(String.fromCharCode(48+a));}c.push('+');c.push('/');g=[];for(a=0;a<128;a++){g.push(-1);}for(a=0;a<64;a++){g[c[a].charCodeAt(0)]=a;}k=l.split('');j=0;f='';b=0;do{i=k[j++].charCodeAt(0);a=g[i];if(i>=0&&i<128&&a!==-1){if(b%4===0){d=a<<2;}else if(b%4===1){d=d|a>>4;e=(a&15)<<4;}else if(b%4===2){e=e|a>>2;h=(a&3)<<6;}else{h=h|a;}b++;if(b%4===0){f+=String.fromCharCode(d)+String.fromCharCode(e)+String.fromCharCode(h);}}}while(k[j]);if(b%4===3){f+=String.fromCharCode(d)+String.fromCharCode(e);}else if(b%4===2){f+=String.fromCharCode(d);}return f;};}if(TP.boot.$$isMoz()){a.Element.prototype.__defineGetter__('offsetParent',function(){return TP.elementGetOffsetParent(this);});a.Element.prototype.__defineGetter__('offsetTop',function(){return Math.round(this.getBoundingClientRect().top);});a.Element.prototype.__defineGetter__('offsetLeft',function(){return Math.round(this.getBoundingClientRect().left);});a.Element.prototype.__defineGetter__('offsetWidth',function(){return Math.round(this.getBoundingClientRect().width);});a.Element.prototype.__defineGetter__('offsetHeight',function(){return Math.round(this.getBoundingClientRect().height);});}if(TP.boot.$$isMoz()||TP.boot.$$isWebkit()){a.Event.prototype.__defineGetter__('offsetX',function(){var a,b,c,d;a=this.target;if(a&&a.nodeType!==Node.DOCUMENT_NODE){a=a.nodeType===Node.TEXT_NODE?a.parentNode:a;b=TP.elementGetComputedStyleObj(a);if(b.position==='absolute'||b.position==='relative'){c=this.layerX;}else{d=TP.elementGetOffsetFromContainer(a);c=this.layerX-d[0];if(a.offsetParent){b=TP.elementGetComputedStyleObj(a.offsetParent);c-=b.getPropertyCSSValue('border-left-width').getFloatValue(CSSPrimitiveValue.CSS_PX);}}return c;}return 0;});a.Event.prototype.__defineGetter__('offsetY',function(){var a,b,c,d;a=this.target;if(a&&a.nodeType!==Node.DOCUMENT_NODE){a=a.nodeType===Node.TEXT_NODE?a.parentNode:a;b=TP.elementGetComputedStyleObj(a);if(b.position==='absolute'||b.position==='relative'){c=this.layerY;}else{d=TP.elementGetOffsetFromContainer(a);c=this.layerY-d[1];if(a.offsetParent){b=TP.elementGetComputedStyleObj(a.offsetParent);c-=b.getPropertyCSSValue('border-top-width').getFloatValue(CSSPrimitiveValue.CSS_PX);}}return c;}return 0;});a.Event.prototype.__defineGetter__('resolvedTarget',function(){var a;if(TP.boot.$isValid(a=this._resolvedTarget)){return a;}if(!TP.boot.$isElement(a=TP.eventResolveTarget(this))){return null;}this._resolvedTarget=a;return a;});}else if(TP.boot.$$isIE()){Object.defineProperty(a.Event.prototype,'target',{get:function(){return this.srcElement;}});Object.defineProperty(a.Event.prototype,'currentTarget',{get:function(){return null;}});Object.defineProperty(a.Event.prototype,'relatedTarget',{get:function(){return this.fromElement||this.toElement||null;}});Object.defineProperty(a.Event.prototype,'metaKey',{get:function(){return false;}});Object.defineProperty(a.Event.prototype,'pageX',{get:function(){var a;a=this.srcElement.document;return this.clientX+a.documentElement.scrollLeft;}});Object.defineProperty(a.Event.prototype,'pageY',{get:function(){var a;a=this.srcElement.document;return this.clientY+a.documentElement.scrollTop;}});Object.defineProperty(a.Event.prototype,'resolvedTarget',{get:function(){var a;if(TP.boot.$isValid(a=this._resolvedTarget)){return a;}if(!TP.boot.$isElement(a=TP.eventResolveTarget(this))){return null;}this._resolvedTarget=a;return a;}});Object.defineProperty(a.Event.prototype,'view',{get:function(){return this.srcElement.document.parentWindow;}});Object.defineProperty(a.Event.prototype,'wheelDelta',{get:function(){if(this.type==='mousewheel'){return this.detail/120;}}});a.Event.prototype.stopPropagation=function(){this.cancelBubble=true;};a.Event.prototype.preventDefault=function(){if(this.type==='mouseover'){this.returnValue=true;}else{this.returnValue=false;}};}a.Event.prototype.at=function(a){return this[a];};a.Event.prototype.atPut=function(a,b){this[a]=b;return this;};a.Event.prototype.copy=function(){var c,d,b;c={target:this.target,$$target:this.$$target,currentTarget:this.currentTarget,relatedTarget:this.relatedTarget,$$relatedTarget:this.$$relatedTarget,type:this.type,$$type:this.$$type,timeStamp:this.timeStamp,$$timestamp:this.$$timestamp,clientX:this.clientX,$$clientX:this.$$clientX,clientY:this.clientY,$$clientY:this.$$clientY,$$clientPt:this.$$clientPt,offsetX:this.offsetX,$$offsetX:this.$$offsetX,offsetY:this.offsetY,$$offsetY:this.$$offsetY,$$offsetPt:this.$$offsetPt,view:this.view,$$view:this.$$view,pageX:this.pageX,$$pageX:this.$$pageX,pageY:this.pageY,$$pageY:this.$$pageY,$$pagePt:this.$$pagePt,resolvedTarget:this.resolvedTarget,$$_resolvedTarget:this.$$_resolvedTarget,screenX:this.screenX,$$screenX:this.$$screenX,screenY:this.screenY,$$screenY:this.$$screenY,$$screenPt:this.$$screenPt,$$transPt:this.$$transPt,$$keyCode:this.$$keyCode,altKey:this.altKey,$$altKey:this.$$altKey,ctrlKey:this.ctrlKey,$$ctrlKey:this.$$ctrlKey,shiftKey:this.shiftKey,$$shiftKey:this.$$shiftKey,metaKey:this.metaKey,button:this.button,$$button:this.$$button,wheelDelta:this.wheelDelta,$$wheelDelta:this.$$wheelDelta,charCode:this.charCode,which:this.which,cancelBubble:this.cancelBubble,returnValue:this.returnValue,$captured:this.$captured,$dragdistance:this.$dragdistance,$normalized:this.$normalized,$notSignaled:this.$notSignaled,$unicodeCharCode:this.$unicodeCharCode,$computedName:this.$computedName};d=a.Event.prototype;for(b in d){if(d.hasOwnProperty(b)){try{if(typeof this[b]==='function'){c[b]=this[b];}}catch(a){}}}return c;};if(TP.boot.$notValid(a.NamedNodeMap)){a.NamedNodeMap=a.MozNamedAttrMap;Object.defineProperty(a.MozNamedAttrMap,'$$name',{get:function(){return'NamedNodeMap';}});}if(a.TP&&a.TP.ac&&!Object.$$name){TP.boot.$$setupMetadata();}if(TP.boot.$$isIE()){a.Element.prototype.getKeys=function(){return TP.sys.$htmlelemkeys;};}else{a.HTMLElement.prototype.getKeys=function(){return TP.sys.$htmlelemkeys;};}if(TP.boot.$$isIE()){a.Document.prototype.getKeys=function(){return TP.sys.$htmldockeys;};}else{a.HTMLDocument.prototype.getKeys=function(){return TP.sys.$htmldockeys;};}a.Error.prototype.getKeys=function(){return TP.sys.$errorkeys;};a.Event.prototype.getKeys=function(){return TP.sys.$eventkeys;};a.NamedNodeMap.prototype.getKeys=function(){return TP.sys.$namednodemapkeys;};a.NodeList.prototype.getKeys=function(){return TP.sys.$nodelistkeys;};a.Window.prototype.getKeys=function(){return TP.sys.$windowkeys;};a.XMLHttpRequest.prototype.getKeys=function(){return TP.sys.$xhrkeys;};};TP.windowIsInstrumented=TP.windowIsInstrumented||function(b){var a;a=b!=null?b:window;return a.$$instrumented===true&&a.$$tibet!=null&&a.TP!=null;};TP.boot.$$computeDispatchOrigin=function(c,e,d){var a,b;if(typeof c==='string'&&c!==''){return c;}if(TP.boot.$isElement(c)){b=c;}else if(TP.boot.$isElement(e)){b=e;}else if(TP.boot.$isEvent(d)){if((b=d.srcElement)==null){b=d.target;}}if(b==null||b===''){return TP.ANY;}try{a=b.getAttribute('tibet:origin');if(a!=null&&a!==''){return a;}}catch(a){}if(TP.windowIsInstrumented(window)){a=TP.gid(b,true);if(a!=null&&a!==''){return a;}a=TP.elementGetAttribute(b,'id');if(a!=null&&a!==''){return a;}}return b;};TP.boot.$$displaySignalData=function(a,b,c,d,e){try{if(a==null||typeof a==='string'){window.status='origin: '+a+'::'+a+' signal: '+b;}else if(a!=null){window.status='origin: '+a+'::'+a.getAttribute('id')+' signal: '+b;}}catch(a){}return;};TP.boot.$$dispatch=function(k,i,e,a,f,j){var b,c,g,d,h;b=i;if(TP.boot.$isEmpty(b)&&TP.boot.$isEvent(a)){b=TP.DOM_SIGNAL_TYPE_MAP[a.type];}else{b=TP.DOM_SIGNAL_TYPE_MAP[i]||i;}if(j!==false){TP.boot.$$displaySignalData(k,b,e,a,f);}if(TP.boot.$isEvent(a)){if(TP.boot.$$isIE()){a.cancelBubble=true;}else{if(TP.boot.$$isWebkit()){a.stopPropagation();}}}c=TP.boot.$$computeDispatchOrigin(k,e,a);if(typeof c==='string'){h=c.charAt(0).toUpperCase()+c.slice(1);d='$handle'+h+b;if(typeof self[d]==='function'){try{g=self[d](h,b,e,a,f);}catch(a){}return g;}}d='$handle'+b;if(typeof self[d]==='function'){try{g=self[d](c,b,e,a,f);}catch(a){}return g;}if(j!==false){TP.boot.$$displaySignalData(c,b,e,a,f);}return;};if(TP.boot.$isValid(window.TP)&&TP.boot.$notValid(TP.dispatch)){TP.dispatch=TP.boot.$$dispatch;}TP.boot.$raise=function(a,b,d,c){return TP.boot.$$dispatch(a,b,null,c);};TP.boot.$$addUIHandler=function(d,b,c){var a,e;a=b;if(TP.boot.$$isIE()){if(b==='focus'){a='activate';}else if(b==='blur'){a='deactivate';}e=function(a){a.timeStamp=new Date().getTime();return c(a);};d.attachEvent('on'+a,e);}else{if(TP.boot.$$isMoz()&&b==='mousewheel'){a='DOMMouseScroll';}d.addEventListener(a,c,true);}TP.boot['$$'+a+'Handler']=c;return;};TP.boot.$$removeUIHandler=function(d,b){var c,a;a=b;if(TP.boot.$$isIE()){if(b==='focus'){a='activate';}else if(b==='blur'){a='deactivate';}}c=TP.boot['$$'+a+'Handler'];if(TP.boot.$notValid(c)){return;}if(TP.boot.$$isIE()){d.detachEvent('on'+a,c);}else{if(TP.boot.$$isMoz()&&b==='mousewheel'){a='DOMMouseScroll';}d.removeEventListener(a,c,true);}TP.boot['$$'+a+'Handler']=null;return;};TP.boot.$$addMutationSource=function(a){TP.core.MutationSignalSource.addObserverFor(a);};TP.boot.$$removeMutationSource=function(a){TP.core.MutationSignalSource.removeObserverFor(a);};TP.boot.$$captureStyle=function(){var b,a;if(TP.boot.$$isIE()){document.attachEvent('onreadystatechange',a=function(){if(document.readyState==='complete'){document.detachEvent('onreadystatechange',a);if(document.body){}}});return;}else{b=document.getElementsByTagName('head')[0];if(b){b.addEventListener('DOMNodeInserted',TP.$eventHandleStyleInsertion,true);document.addEventListener('DOMContentLoaded',a=function(){var b;document.removeEventListener('DOMContentLoaded',a,false);if(document.body){}b=document.getElementsByTagName('head')[0];if(b){b.removeEventListener('DOMNodeInserted',TP.$eventHandleStyleInsertion,true);}},false);}}};TP.boot.$$stopAndPreventEvent=function(a){a.stopPropagation();a.preventDefault();return;};TP.boot.$$documentSetup=function(a){TP.boot.$$addUIHandler(a,'click',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'dblclick',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mousemove',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mouseover',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mouseout',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mouseenter',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mouseleave',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mousedown',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mouseup',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'contextmenu',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'mousewheel',TP.core.Mouse.$$handleMouseEvent);TP.boot.$$addUIHandler(a,'keyup',TP.core.Keyboard.$$handleKeyEvent);if(TP.boot.$$isIE()){TP.boot.$$addUIHandler(a.body,'cut',TP.$$handleCut);TP.boot.$$addUIHandler(a.body,'copy',TP.$$handleCopy);TP.boot.$$addUIHandler(a.body,'paste',TP.$$handlePaste);}else{TP.boot.$$addUIHandler(a,'cut',TP.$$handleCut);TP.boot.$$addUIHandler(a,'copy',TP.$$handleCopy);TP.boot.$$addUIHandler(a,'paste',TP.$$handlePaste);}TP.boot.$$addUIHandler(a,'blur',TP.$$handleBlur);TP.boot.$$addUIHandler(a,'focus',TP.$$handleFocus);TP.boot.$$addUIHandler(a,'keydown',TP.core.Keyboard.$$handleKeyEvent);TP.boot.$$addUIHandler(a,'keypress',TP.core.Keyboard.$$handleKeyEvent);TP.boot.$$addUIHandler(a,'change',TP.$$handleChange);TP.boot.$$addMutationSource(a);return;};TP.boot.$$documentTeardown=function(a){TP.boot.$$removeUIHandler(a,'click');TP.boot.$$removeUIHandler(a,'dblclick');TP.boot.$$removeUIHandler(a,'mousemove');TP.boot.$$removeUIHandler(a,'mouseover');TP.boot.$$removeUIHandler(a,'mouseout');TP.boot.$$removeUIHandler(a,'mouseenter');TP.boot.$$removeUIHandler(a,'mouseleave');TP.boot.$$removeUIHandler(a,'mousedown');TP.boot.$$removeUIHandler(a,'mouseup');TP.boot.$$removeUIHandler(a,'contextmenu');TP.boot.$$removeUIHandler(a,'mousewheel');TP.boot.$$removeUIHandler(a,'keyup');TP.boot.$$removeUIHandler(a,'cut');TP.boot.$$removeUIHandler(a,'copy');TP.boot.$$removeUIHandler(a,'paste');TP.boot.$$removeUIHandler(a,'blur');TP.boot.$$removeUIHandler(a,'focus');TP.boot.$$removeUIHandler(a,'keydown');TP.boot.$$removeUIHandler(a,'keypress');TP.boot.$$removeUIHandler(a,'change');TP.boot.$$removeMutationSource(a);return;};$$init=function(){var a;try{if(typeof self.init==='function'){init();}}catch(b){if(typeof self.init==='function'){a=$$findTIBET();a.console.log('ERROR in init(): '+b.message);}}TP.windowInstallOnBeforeUnloadHook(window);return;};TP.boot.autoBoot=function(){var a,b,d,c,e;if(window!==top||window.$$autoboot===false||typeof TP.boot.launch==='function'){return;}a=decodeURI(TP.boot.getWindowLocation());b=a.indexOf('/TIBET-INF');if(b===-1){b=a.indexOf(TP.$$tibetinf);if(b===-1){return;}else{d=TP.$$tibetinf;}}else{d='/TIBET-INF';}c=a.slice(0,b);a='~'+a.replace(c,'');e=c+'/'+TP.$$bootpage;window.location.replace(e);return;};TP.boot.bootFromBookmark=function(){var a,b,c;if(window!==top||window.$$autoboot===false){return;}a=decodeURI(TP.boot.getWindowLocation());b=a.split('#');c=b[0];window.location.replace(c);return;};TP.boot.initializeCanvas=function(a){var b;if($$findTIBET()===a){return;}if(self.$$tibet==null){if($$findTIBET()==null){return;}}if(!TP.core.Window||!TP.core.Window.installLoadUnloadHooks){TP.boot.initCanvas=function(){if(!TP.core.Window||!TP.core.Window.installLoadUnloadHooks){setTimeout(TP.boot.initCanvas,250);return;}TP.boot.initializeCanvas();};TP.boot.initCanvas();return;}if(TP.sys.hasLoaded()===false){return;}if(TP.boot.$isElement(a.document.body)){if(a.document.body.hasAttribute('tibet_canvasinitialized')){return;}}TP.boot.installPatches(a);TP.core.Window.installLoadUnloadHooks(a);TP.core.Window.instrument(a);if(TP.boot.$$isIE()){a.attachEvent('onload',b=function(){$$init();});a.attachEvent('onunload',b=function(){TP.boot.$$documentTeardown(this.document);});}else{if(TP.boot.$$isMoz()){a.document.addEventListener('DOMContentLoaded',b=function(){$$init();},false);}else{a.document.addEventListener('DOMContentLoaded',b=function(){$$init();},false);}a.addEventListener('unload',b=function(){TP.boot.$$documentTeardown(this.document);},false);}if(parent===top){top.document.title=a.document.title;}TP.boot.$$documentSetup(a.document);if(TP.boot.$isElement(a.document.body)){a.document.body.setAttribute('tibet_canvasinitialized','true');}return;};if(window.onerror.failedlaunch===true){void 0;}else if($$findTIBET()==null){TP.boot.autoBoot();}else if(window.$$tibet==null){TP.boot.autoBoot();}else{if(window.$$tibet&&window.$$tibet.TP!==window.TP){Object.defineProperty(self,'TP',{value:window.$$tibet.TP,writable:false});}else{Object.defineProperty(self,'TP',{value:window.TP,writable:false});}if(TP.boot.getURLBookmark()){TP.boot.bootFromBookmark();}else if(TP.sys.hasLoaded()===false&&TP.sys.cfg('boot.twophase')===true){if(window.$$phasetwo===true){if(TP.sys.cfg('boot.phasetwo')===true){TP.boot.initializeCanvas(window);}else{TP.boot.bootPhaseTwo=function(){TP.boot.initializeCanvas(window);TP.boot.$$importPhaseTwo();return;};if(TP.boot.$$stage==='import_paused'){TP.boot.bootPhaseTwo();}}}else{TP.boot.initializeCanvas(window);}}else{TP.boot.initializeCanvas(window);}}}}(this));
