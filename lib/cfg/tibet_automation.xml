<?xml version="1.0"?>
<!--    =============================================================   -->
<!--    TIBET Automation module file                                     -->
<!--    =============================================================   -->

<!--
-->
<package xmlns="http://www.technicalpursuit.com/1999/tibet"
    name="tibet_automation" default="base" basedir="~tibet_src/">

<config id="base" depends="">
    <config ref="gui"/>
</config>

<config id="full" depends="base">
    <config ref="gui"/>
    <config ref="tsh"/>
</config>

<config id="gui" depends="">
    <script>
    if (TP.sys.cfg('boot.context') !== 'phantomjs') {
    (function() {
    </script>
    <config ref="syn"/>
    <script>
    }());
    }
    </script>
    <script src="automation/TPGUIDriver.js" />
</config>

<config id="syn" depends="" unless="boot.context=phantomjs">

    <script>
        <![CDATA[
        //  Because our automation system uses Promises in conjunction with Syn,
        //  we have to define an alternate version of Syn's 'schedule' call that
        //  knows that synchronization of all behavior is handled by our internal
        //  Promise code. Therefore, here we just invoke the function.
        //  Note that we *must* do this *before* Syn loads, which is why we do
        //  this here - it's just how Syn works.
        Syn = {
            'schedule' :
                function (fn, ms) {
                return fn();
                }
            };
        ]]>
    </script>

    <script src="~lib_deps/syn-tpi.min.js"
        unless="boot.unminified linting" no-minify="true"/>
    <script src="~lib_deps/syn-tpi.js"
        if="boot.unminified" unless="linting"/>

    <script>
        <![CDATA[
        TP.extern.syn = Syn;
        ]]>
    </script>
</config>

<config id="tsh" depends="">
    <script src="automation/TPShellDriver.js" />
    <script src="automation/tsh_testCmd.js" />
</config>

</package>

